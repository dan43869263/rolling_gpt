['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
train 337
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
val 43
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
test 93
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (2): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (3): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (4): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (5): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
1it [00:01,  1.13s/it]
1it [00:00, 10.96it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 1 cost time: 1.4873120784759521
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([76])
missing_idx_len: 43
pred tensor([0.2210, 0.1970, 0.2183, 0.2074, 0.2453, 0.2508, 0.1247, 0.3003, 0.2028,
        0.3270, 0.3154, 0.1627, 0.3013, 0.2054, 0.2116, 0.1964, 0.0867, 0.2143,
        0.2043, 0.1862, 0.2834, 0.1975, 0.2025, 0.2668, 0.1866, 0.2771, 0.1952,
        0.3460, 0.2710, 0.2100, 0.2370, 0.2155, 0.0615, 0.3127, 0.2797, 0.2161,
        0.2420, 0.2175, 0.2601, 0.2214, 0.2126, 0.2453, 0.2017, 0.1070, 0.1919,
        0.2356, 0.2216, 0.2432, 0.1920, 0.1551, 0.2488, 0.2658, 0.2311, 0.2850,
        0.2248, 0.2295, 0.2485, 0.2455, 0.2162, 0.2179, 0.2196, 0.2246, 0.2201,
        0.2164, 0.2057, 0.2461, 0.2401, 0.2243, 0.2198, 0.2179, 0.2341, 0.2145,
        0.2301, 0.2690, 0.1922, 0.2511])
true tensor([0.2700, 1.2100, 1.8600, 0.9400, 1.2100, 1.8600, 0.6800, 0.9400, 1.2100,
        1.8600, 0.8700, 0.6800, 0.9400, 1.2100, 0.2700, 0.5000, 0.6200, 0.2700,
        0.5000, 0.8700, 0.6800, 0.9400, 1.2100, 0.2700, 0.5000, 0.6200, 1.8600,
        0.2700, 0.2700, 0.9400, 1.2100, 1.8600, 0.2700, 0.5000, 0.6200, 0.5000,
        0.6200, 0.9300, 0.2700, 0.5000, 0.2700, 1.2100, 1.8600, 0.2700, 0.5000,
        0.8700, 0.6800, 0.9400, 1.2100, 0.2700, 1.8600, 0.6800, 0.9400, 1.2100,
        1.8600, 0.5000, 0.6200, 0.9300, 0.2700, 0.5000, 0.6200, 0.9300, 0.4200,
        0.5000, 0.6200, 0.9300, 0.9400, 1.2100, 1.8600, 1.2100, 1.8600, 0.6800,
        0.9400, 1.2100, 1.8600, 1.8600])
Epoch: 1, Steps: 1 | Train Loss: 0.1397217 Vali Loss: 0.7155960
lr = 0.0000975531
Validation loss decreased (inf --> 0.715596).  Saving model ...
1it [00:00,  5.47it/s]
1it [00:00, 11.04it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 2 cost time: 0.6222083568572998
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([76])
missing_idx_len: 43
pred tensor([0.2228, 0.2571, 0.1344, 0.2932, 0.2297, 0.2325, 0.2199, 0.1990, 0.2451,
        0.2114, 0.2610, 0.2122, 0.3084, 0.0599, 0.2448, 0.2227, 0.1973, 0.2249,
        0.2033, 0.2275, 0.2169, 0.2654, 0.2220, 0.2117, 0.2007, 0.2185, 0.2345,
        0.2259, 0.2318, 0.2323, 0.2002, 0.1673, 0.2721, 0.1695, 0.4077, 0.2619,
        0.2352, 0.1724, 0.2160, 0.2103, 0.2333, 0.2319, 0.1928, 0.2000, 0.2049,
        0.2698, 0.2934, 0.4996, 0.1827, 0.2894, 0.2142, 0.3225, 0.2830, 0.2191,
        0.2305, 0.2157, 0.1029, 0.2978, 0.1948, 0.1762, 0.2447, 0.2241, 0.2825,
        0.2055, 0.2364, 0.2320, 0.2245, 0.1857, 0.2511, 0.2502, 0.2300, 0.2121,
        0.2482, 0.2364, 0.2630, 0.2089])
true tensor([0.2700, 0.6800, 0.9400, 1.2100, 1.8600, 0.9400, 1.2100, 1.8600, 0.5000,
        0.6200, 0.9300, 0.2700, 0.2700, 0.5000, 1.8600, 0.8700, 0.6800, 0.9400,
        1.2100, 0.5000, 0.6200, 0.9300, 1.2100, 1.8600, 1.2100, 1.8600, 0.9400,
        1.2100, 1.8600, 0.2700, 0.5000, 0.6800, 0.9400, 1.2100, 1.8600, 0.2700,
        0.5000, 0.6200, 0.5000, 0.6200, 0.9300, 0.4200, 0.8700, 0.6800, 0.9400,
        1.2100, 0.2700, 0.5000, 0.6200, 0.2700, 0.5000, 0.6200, 0.2700, 0.5000,
        0.6200, 0.9300, 0.2700, 0.5000, 0.2700, 0.2700, 0.6800, 0.9400, 1.2100,
        1.8600, 0.2700, 1.8600, 1.2100, 1.8600, 0.8700, 0.6800, 0.9400, 1.2100,
        0.9400, 1.2100, 1.8600, 1.8600])
Epoch: 2, Steps: 1 | Train Loss: 0.1425568 Vali Loss: 0.7139587
lr = 0.0000904518
Validation loss decreased (0.715596 --> 0.713959).  Saving model ...
1it [00:00,  5.74it/s]
1it [00:00,  9.31it/s]
1it [00:00,  9.88it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 3 cost time: 0.619635820388794
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([76])
missing_idx_len: 43
pred tensor([0.2238, 0.2039, 0.2580, 0.2680, 0.2089, 0.2637, 0.2421, 0.0952, 0.2042,
        0.2531, 0.2032, 0.2797, 0.2309, 0.2162, 0.2062, 0.2208, 0.2121, 0.2615,
        0.2020, 0.2078, 0.2095, 0.1799, 0.0382, 0.2358, 0.2579, 0.2164, 0.2872,
        0.2146, 0.2226, 0.2188, 0.2454, 0.2566, 0.2508, 0.1984, 0.2436, 0.4585,
        0.1563, 0.2020, 0.3048, 0.2229, 0.1982, 0.2383, 0.2293, 0.2636, 0.3221,
        0.1896, 0.5076, 0.2191, 0.2276, 0.2121, 0.2252, 0.2341, 0.2225, 0.2446,
        0.2544, 0.2096, 0.2408, 0.2050, 0.2293, 0.2111, 0.1759, 0.1867, 0.2282,
        0.1972, 0.1721, 0.3319, 0.1342, 0.3583, 0.2268, 0.2371, 0.2550, 0.2258,
        0.2494, 0.2249, 0.2698, 0.1733])
true tensor([0.2700, 0.5000, 0.2700, 0.2700, 0.9400, 1.2100, 1.8600, 0.2700, 1.8600,
        0.6800, 0.9400, 1.2100, 1.8600, 0.2700, 0.8700, 0.6800, 0.9400, 1.2100,
        1.2100, 1.8600, 1.8600, 0.2700, 0.5000, 0.6200, 0.9400, 1.2100, 1.8600,
        0.5000, 0.6200, 0.9300, 0.4200, 0.5000, 0.6200, 0.9300, 0.2700, 0.5000,
        0.6200, 0.2700, 0.2700, 0.5000, 0.9400, 1.2100, 1.8600, 1.8600, 0.2700,
        0.5000, 0.2700, 0.5000, 0.6200, 0.9300, 0.5000, 0.6200, 0.9300, 0.6800,
        0.9400, 1.2100, 1.8600, 1.2100, 1.8600, 0.2700, 0.5000, 0.6200, 1.2100,
        1.8600, 0.6800, 0.9400, 1.2100, 1.8600, 0.8700, 0.6800, 0.9400, 1.2100,
        0.8700, 0.6800, 0.9400, 1.2100])
Epoch: 3, Steps: 1 | Train Loss: 0.1406043 Vali Loss: 0.7147512
lr = 0.0000793913
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
1it [00:00,  5.93it/s]
1it [00:00, 11.41it/s]
1it [00:00,  5.85it/s]
1it [00:00, 10.73it/s]
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([76])
missing_idx_len: 43
pred tensor([0.2208, 0.1938, 0.2208, 0.2108, 0.2402, 0.2374, 0.1982, 0.2215, 0.2139,
        0.2223, 0.1989, 0.2169, 0.2126, 0.1685, 0.0035, 0.2025, 0.2123, 0.2379,
        0.1986, 0.2404, 0.1811, 0.2248, 0.2486, 0.2377, 0.2643, 0.1905, 0.2743,
        0.1931, 0.2436, 0.2298, 0.2222, 0.2390, 0.2614, 0.1982, 0.2288, 0.2233,
        0.2232, 0.2553, 0.2691, 0.1567, 0.2161, 0.2600, 0.2232, 0.2297, 0.2355,
        0.2189, 0.2360, 0.2603, 0.2182, 0.2405, 0.2489, 0.2077, 0.2541, 0.2301,
        0.2343, 0.2223, 0.3516, 0.0887, 0.2544, 0.3976, 0.3408, 0.0442, 0.1997,
        0.2778, 0.1297, 0.3485, 0.1579, 0.2548, 0.0951, 0.2147, 0.2236, 0.2489,
        0.2717, 0.2177, 0.3585, 0.1951])
true tensor([0.5000, 0.6200, 0.9300, 0.5000, 0.6200, 0.9300, 0.4200, 1.2100, 1.8600,
        0.8700, 0.6800, 0.9400, 1.2100, 0.2700, 0.2700, 0.6800, 0.9400, 1.2100,
        1.8600, 1.8600, 0.2700, 0.5000, 0.8700, 0.6800, 0.9400, 1.2100, 0.2700,
        0.5000, 0.6200, 0.9300, 0.2700, 0.2700, 1.2100, 1.8600, 0.8700, 0.6800,
        0.9400, 1.2100, 0.2700, 0.5000, 0.9400, 1.2100, 1.8600, 0.9400, 1.2100,
        1.8600, 0.6800, 0.9400, 1.2100, 1.8600, 0.9400, 1.2100, 1.8600, 1.8600,
        1.2100, 1.8600, 0.2700, 0.5000, 0.6200, 0.2700, 0.5000, 0.6200, 0.6800,
        0.9400, 1.2100, 1.8600, 0.2700, 0.2700, 0.5000, 0.6200, 0.5000, 0.6200,
        0.9300, 1.8600, 0.2700, 0.5000])
Epoch: 4, Steps: 1 | Train Loss: 0.1330696 Vali Loss: 0.7199603
lr = 0.0000654543
EarlyStopping counter: 2 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 5 cost time: 0.6165924072265625
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([76])
missing_idx_len: 43
pred tensor([0.2157, 0.2063, 0.2651, 0.2219, 0.2148, 0.2404, 0.2036, 0.2212, 0.2196,
        0.2302, 0.2428, 0.2214, 0.2178, 0.2660, 0.4965, 0.3051, 0.2586, 0.1089,
        0.3082, 0.2122, 0.1776, 0.2299, 0.2475, 0.2114, 0.2539, 0.2706, 0.1596,
        0.2530, 0.2066, 0.2646, 0.2484, 0.2185, 0.1798, 0.2245, 0.1855, 0.2045,
        0.2176, 0.2341, 0.2527, 0.2280, 0.1058, 0.2438, 0.2291, 0.1989, 0.2165,
        0.2115, 0.2217, 0.2186, 0.2142, 0.2138, 0.0159, 0.4123, 0.1990, 0.2218,
        0.2343, 0.2194, 0.2394, 0.1963, 0.3601, 0.1312, 0.4474, 0.1671, 0.3334,
        0.1612, 0.3169, 0.2349, 0.2562, 0.2328, 0.2294, 0.2418, 0.1945, 0.0501,
        0.2528, 0.2423, 0.2448, 0.1835])
true tensor([0.5000, 0.6200, 0.9300, 1.2100, 1.8600, 0.2700, 0.5000, 0.6200, 0.9300,
        0.4200, 0.9400, 1.2100, 1.8600, 0.2700, 0.5000, 0.6200, 0.2700, 0.5000,
        0.6200, 0.8700, 0.6800, 0.9400, 1.2100, 0.2700, 0.6800, 0.9400, 1.2100,
        1.8600, 0.9400, 1.2100, 1.8600, 0.2700, 0.5000, 1.8600, 0.2700, 1.2100,
        1.8600, 1.2100, 1.8600, 0.2700, 0.2700, 0.5000, 0.8700, 0.6800, 0.9400,
        1.2100, 0.5000, 0.6200, 0.9300, 1.8600, 0.5000, 0.6200, 0.9300, 0.2700,
        0.6800, 0.9400, 1.2100, 1.8600, 0.2700, 0.5000, 0.6200, 0.6800, 0.9400,
        1.2100, 1.8600, 0.2700, 1.8600, 0.9400, 1.2100, 1.8600, 0.2700, 0.5000,
        0.8700, 0.6800, 0.9400, 1.2100])
Epoch: 5, Steps: 1 | Train Loss: 0.1331910 Vali Loss: 0.7156364
lr = 0.0000500050
EarlyStopping counter: 3 out of 3
Early stopping
------------------------------------
1it [00:00,  9.34it/s]
outputs torch.Size([93, 12, 18])
B 93
L 18
M 18
test shape: (1, 372) (1, 372)
test shape: (1, 1, 372) (1, 1, 372)
mae:1.2905, mse:2.6450, rmse:1.6263, r2:-1.6862
mse_mean = 2.6450, mse_std = 0.0000
r2_mean = -1.6862, mae_std = 0.0000