['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
train 337
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
val 43
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
test 93
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (2): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (3): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (4): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (5): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 1 cost time: 1.3836455345153809
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([67])
missing_idx_len: 43
pred tensor([0.2593, 0.2523, 0.3732, 0.1923, 0.2382, 0.2129, 0.2080, 0.2237, 0.1871,
        0.1486, 0.4480, 0.2191, 0.1930, 0.2335, 0.1694, 0.0888, 0.0741, 0.3181,
        0.0971, 0.1497, 0.2414, 0.2329, 0.2562, 0.1911, 0.2196, 0.1707, 0.2029,
        0.2127, 0.2201, 0.2319, 0.2148, 0.2189, 0.2114, 0.2686, 0.3862, 0.1935,
        0.1728, 0.1949, 0.2164, 0.2117, 0.2378, 0.2347, 0.2610, 0.0551, 0.2239,
        0.2224, 0.1631, 0.2294, 0.2652, 0.3127, 0.1689, 0.2702, 0.1315, 0.2039,
        0.1504, 0.1244, 0.2525, 0.2003, 0.2518, 0.2306, 0.2234, 0.1962, 0.2187,
        0.2370, 0.2236, 0.2555, 0.2487])
true tensor([-0.0100,  0.0800,  0.1000,  0.0800,  0.1000,  0.1400,  0.0900, -0.0100,
         0.0800,  0.1000,  0.1400,  0.1000,  0.1400,  0.0900,  0.0800, -0.0100,
         0.0800,  0.1000,  0.1400, -0.0100,  0.0800,  0.1000,  0.1400,  0.0900,
         0.0800, -0.0100,  0.1400,  0.0900,  0.0800,  0.1500,  0.0800,  0.1000,
         0.1400,  0.0900, -0.0100,  0.0800,  0.1000,  0.0800,  0.1000,  0.1400,
         0.0900,  0.0600, -0.0100,  0.0800,  0.1000,  0.1000,  0.1400,  0.0900,
         0.0800, -0.0100, -0.0100,  0.0800,  0.1000,  0.1400, -0.0100, -0.0100,
         0.0800,  0.1400,  0.0900,  0.0800,  0.1500,  0.1400,  0.0900,  0.0800,
         0.1500, -0.0100,  0.0800])
1it [00:01,  1.12s/it]
0it [00:00, ?it/s]
Epoch: 1, Steps: 1 | Train Loss: 0.0989377 Vali Loss: 0.0243467
lr = 0.0000975531
Validation loss decreased (inf --> 0.024347).  Saving model ...
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 2 cost time: 0.49102067947387695
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([67])
missing_idx_len: 43
pred tensor([0.3652, 0.1728, 0.3231, 0.3912, 0.0997, 0.0273, 0.0881, 0.2107, 0.1635,
        0.2256, 0.2400, 0.1507, 0.1153, 0.3734, 0.2309, 0.2143, 0.2172, 0.2452,
        0.2490, 0.1656, 0.2159, 0.2713, 0.2468, 0.3197, 0.2101, 0.2482, 0.0646,
        0.2020, 0.1661, 0.2519, 0.1682, 0.2013, 0.2377, 0.2472, 0.2333, 0.2003,
        0.2347, 0.2304, 0.2097, 0.2147, 0.2541, 0.1832, 0.2104, 0.2075, 0.1519,
        0.2363, 0.2056, 0.2279, 0.2240, 0.2200, 0.2421, 0.2569, 0.2245, 0.0987,
        0.3186, 0.2018, 0.1716, 0.2586, 0.1524, 0.3472, 0.1121, 0.0404, 0.1495,
        0.0363, 0.1625, 0.2954, 0.2016])
true tensor([-0.0100,  0.0800, -0.0100,  0.0800,  0.1000,  0.1400, -0.0100,  0.1000,
         0.1400,  0.0900,  0.0800, -0.0100,  0.0800,  0.1000,  0.0800,  0.1000,
         0.1400,  0.0900, -0.0100,  0.1400,  0.0900,  0.0800,  0.1500, -0.0100,
         0.0800,  0.1000,  0.1400,  0.1000,  0.1400,  0.0900,  0.0800,  0.1400,
         0.0900,  0.0800,  0.1500,  0.1000,  0.1400,  0.0900,  0.0800,  0.0800,
         0.1000,  0.1400,  0.0900, -0.0100,  0.0800,  0.1400,  0.0900,  0.0800,
         0.1500,  0.0800,  0.1000,  0.1400,  0.0900, -0.0100,  0.0800, -0.0100,
         0.0800,  0.1000,  0.1400, -0.0100,  0.0800,  0.1000, -0.0100,  0.0800,
         0.1000,  0.0600, -0.0100])
Epoch: 2, Steps: 1 | Train Loss: 0.0978586 Vali Loss: 0.0252398
lr = 0.0000904518
1it [00:00, 12.88it/s]
1it [00:00,  5.69it/s]
1it [00:00, 11.54it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 3 cost time: 0.49796366691589355
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([67])
missing_idx_len: 43
pred tensor([0.1949, 0.2297, 0.1436, 0.3107, 0.1056, 0.0671, 0.2207, 0.3066, 0.1223,
        0.3777, 0.1433, 0.2162, 0.1727, 0.1918, 0.1511, 0.1472, 0.2234, 0.2127,
        0.2603, 0.1759, 0.2074, 0.2270, 0.2274, 0.2265, 0.2438, 0.1651, 0.2157,
        0.2477, 0.2087, 0.2532, 0.1995, 0.2029, 0.3039, 0.1460, 0.1711, 0.0842,
        0.2043, 0.2301, 0.2030, 0.2175, 0.2092, 0.2266, 0.2291, 0.2429, 0.1388,
        0.3029, 0.2117, 0.1190, 0.1915, 0.2434, 0.2494, 0.2311, 0.4491, 0.3785,
        0.2435, 0.2234, 0.2449, 0.2230, 0.2328, 0.2246, 0.1994, 0.2326, 0.2275,
        0.3037, 0.4248, 0.1836, 0.1722])
true tensor([-0.0100,  0.0800,  0.1000,  0.1400, -0.0100,  0.0800,  0.1000, -0.0100,
         0.0800, -0.0100,  0.0800,  0.1000, -0.0100,  0.0800,  0.1000, -0.0100,
         0.1000,  0.1400,  0.0900,  0.0800,  0.1400,  0.0900,  0.0800,  0.1500,
         0.1000,  0.1400,  0.0900,  0.0800,  0.0800,  0.1000,  0.1400,  0.0900,
        -0.0100,  0.0800,  0.1000,  0.1400,  0.0800,  0.1000,  0.1400,  0.0900,
         0.0800,  0.1000,  0.1400,  0.0900, -0.0100,  0.0800,  0.1000,  0.1400,
         0.1400,  0.0900,  0.0800,  0.1500, -0.0100,  0.0800,  0.1400,  0.0900,
         0.0800,  0.1500, -0.0100,  0.1000,  0.1400,  0.0900,  0.0800, -0.0100,
        -0.0100,  0.0800,  0.0600])
Epoch: 3, Steps: 1 | Train Loss: 0.0964174 Vali Loss: 0.0278118
lr = 0.0000793913
EarlyStopping counter: 2 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 4 cost time: 0.47901153564453125
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([67])
missing_idx_len: 43
pred tensor([0.2070, 0.2362, 0.2051, 0.2512, 0.3356, 0.2941, 0.1893, 0.2073, 0.2153,
        0.2336, 0.2166, 0.3074, 0.2510, 0.2399, 0.1871, 0.2503, 0.0434, 0.3457,
        0.0116, 0.2080, 0.2589, 0.2171, 0.2433, 0.2283, 0.2847, 0.1706, 0.2773,
        0.3441, 0.3033, 0.2392, 0.2229, 0.2369, 0.2382, 0.0653, 0.2087, 0.2461,
        0.1459, 0.3299, 0.0206, 0.2350, 0.3033, 0.2337, 0.3420, 0.2448, 0.2349,
        0.2166, 0.2483, 0.1823, 0.2291, 0.2445, 0.2483, 0.2154, 0.1549, 0.3814,
        0.2611, 0.2060, 0.2393, 0.2142, 0.2190, 0.2495, 0.1527, 0.2125, 0.2152,
        0.2041, 0.2513, 0.2194, 0.2737])
true tensor([ 0.1400,  0.0900,  0.0800,  0.1500, -0.0100,  0.0800, -0.0100,  0.1400,
         0.0900,  0.0800,  0.1500, -0.0100,  0.0800,  0.1000, -0.0100,  0.0800,
         0.1000,  0.1400, -0.0100,  0.0800,  0.1000,  0.1400,  0.0900,  0.0600,
        -0.0100,  0.0800, -0.0100, -0.0100,  0.0800,  0.1400,  0.0900,  0.0800,
         0.1500, -0.0100,  0.0800,  0.1000, -0.0100,  0.0800,  0.1000,  0.1400,
        -0.0100,  0.0800,  0.1000,  0.1400,  0.1000,  0.1400,  0.0900,  0.0800,
         0.1000,  0.1400,  0.0900,  0.0800, -0.0100,  0.0800,  0.1000,  0.0800,
         0.1000,  0.1400,  0.0900,  0.1000,  0.1400,  0.0900,  0.0800,  0.0800,
         0.1000,  0.1400,  0.0900])
Epoch: 4, Steps: 1 | Train Loss: 0.0965044 Vali Loss: 0.0281142
lr = 0.0000654543
EarlyStopping counter: 3 out of 3
Early stopping
------------------------------------
outputs torch.Size([93, 12, 18])
B 93
L 18
M 18
1it [00:00,  6.16it/s]
1it [00:00, 12.26it/s]
1it [00:00,  6.55it/s]
1it [00:00, 11.58it/s]
1it [00:00,  9.31it/s]
test shape: (1, 1) (1, 1)
test shape: (1, 1, 1) (1, 1, 1)
mae:0.1403, mse:0.0197, rmse:0.1403, r2:-inf
mse_mean = 0.0197, mse_std = 0.0000
r2_mean = -inf, mae_std = nan