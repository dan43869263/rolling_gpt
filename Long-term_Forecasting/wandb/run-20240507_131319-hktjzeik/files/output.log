['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
train 337
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
val 43
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
test 93
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (2): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (3): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (4): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (5): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
1it [00:01,  1.15s/it]
0it [00:00, ?it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 1 cost time: 1.4223418235778809
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2604,  0.2143,  0.1638,  0.1671,  0.1670,  0.1413,  0.1826,  0.2021,
         0.1086,  0.2001,  0.3723,  0.1958,  0.0949,  0.2528,  0.4002,  0.0909,
         0.1399,  0.1846,  0.2882,  0.3121,  0.1963,  0.2581,  0.1118,  0.1950,
         0.1370,  0.2665,  0.2319,  0.2510,  0.1944,  0.1442,  0.1550,  0.2555,
         0.2784,  0.3940, -0.0983,  0.1686,  0.2890,  0.2853,  0.1004,  0.3651,
         0.2716,  0.2464,  0.3331,  0.1720,  0.3751,  0.0809,  0.2079,  0.3109,
         0.2923,  0.0281,  0.2354,  0.0684,  0.2899,  0.2803,  0.1718,  0.3647,
         0.2630,  0.1852,  0.2218,  0.3272,  0.2165,  0.3130,  0.3134,  0.1455,
         0.3839,  0.0451,  0.4481,  0.1631,  0.1744,  0.2291,  0.1379,  0.2069,
         0.0868,  0.0445,  0.3229,  0.1324,  0.2730,  0.2317,  0.0517,  0.3415,
         0.2978,  0.2373,  0.3733,  0.2607,  0.2116,  0.3204,  0.2974,  0.1475,
         0.2698,  0.2580,  0.1343,  0.1980,  0.1437,  0.2463,  0.2970,  0.1105,
         0.1526,  0.3432,  0.2286,  0.1804,  0.2684,  0.3374,  0.1678,  0.2797,
         0.2071,  0.0972,  0.1340,  0.1704,  0.0961,  0.2742,  0.2319,  0.2855,
         0.3360,  0.1368,  0.0655,  0.2407,  0.3302,  0.3762,  0.2135,  0.2601,
         0.3872,  0.3558,  0.1887,  0.3728,  0.3094,  0.1012,  0.0321,  0.3739,
         0.1371,  0.1099,  0.2021,  0.3155,  0.0754,  0.1315,  0.1902,  0.3225,
         0.2184,  0.2688,  0.2518,  0.1085,  0.3827,  0.2282,  0.2715,  0.3327,
         0.2354,  0.2385,  0.3552,  0.1364,  0.1367,  0.1716,  0.2307,  0.3024,
         0.2226,  0.3603,  0.1728,  0.2735,  0.2280, -0.0222,  0.2212,  0.0959,
         0.2087,  0.2845,  0.1691,  0.2692,  0.2252,  0.4006, -0.0182,  0.2634,
         0.1423,  0.1665,  0.2171,  0.2806])
true tensor([ 0.6100,  0.4600,  0.4400, -0.3700,  0.4900,  0.2700,  0.3700,  0.9700,
         1.3800,  0.4900,  0.2700,  0.3700,  1.2700,  1.3800,  0.4900,  0.2700,
         0.5200,  1.2700,  1.3800,  0.4900,  0.0500,  0.4500,  0.1100,  0.6100,
         0.4400, -0.3700,  0.3300,  0.4100,  0.4600,  0.4400, -0.3700,  0.3300,
         0.5200,  1.2700,  1.3800,  0.4900,  0.3700,  0.9700,  0.0500,  0.4500,
         0.9700,  0.0500,  0.4500,  0.1100,  0.4400, -0.3700,  0.3300,  0.4100,
         0.2700,  0.3700,  0.9700,  0.0500,  0.6100,  0.4600,  0.4400, -0.3700,
         0.1100,  0.6100,  0.4600,  0.4400,  1.3800,  0.4900,  0.2700,  0.3700,
         0.4400, -0.3700,  0.3300,  0.4100,  0.4500,  0.1100,  0.6100,  0.4600,
         0.3700,  0.9700,  0.0500,  0.4500, -0.3700,  0.3300,  0.4100,  0.6900,
         0.3700,  0.9700,  0.0500,  0.4500,  0.4600,  0.4400, -0.3700,  0.3300,
         0.1100,  0.6100,  0.4600,  0.4400,  0.4900,  0.2700,  0.3700,  0.9700,
         0.4600,  0.4400, -0.3700,  0.3300,  0.5200,  1.2700,  1.3800,  0.4900,
         0.9700,  0.0500,  0.4500,  0.1100,  0.1100,  0.6100,  0.4600,  0.4400,
         0.2700,  0.3700,  0.9700,  0.0500,  1.2700,  1.3800,  0.4900,  0.2700,
        -0.3700,  0.3300,  0.4100,  0.6900,  0.9700,  0.0500,  0.4500,  0.1100,
         0.0500,  0.4500,  0.1100,  0.6100,  0.6100,  0.4600,  0.4400, -0.3700,
         0.0500,  0.4500,  0.1100,  0.6100,  0.4500,  0.1100,  0.6100,  0.4600,
         0.3300,  0.4100,  0.6900,  2.7200, -0.3700,  0.3300,  0.4100,  0.6900,
         0.4500,  0.1100,  0.6100,  0.4600,  1.3800,  0.4900,  0.2700,  0.3700,
         0.4900,  0.2700,  0.3700,  0.9700,  1.2700,  1.3800,  0.4900,  0.2700,
         0.2700,  0.3700,  0.9700,  0.0500])
Epoch: 1, Steps: 1 | Train Loss: 0.2299380 Vali Loss: 0.2582477
lr = 0.0000975531
1it [00:00, 12.49it/s]
1it [00:00,  6.16it/s]
1it [00:00, 12.05it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 2 cost time: 0.5046133995056152
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([0.1880, 0.2033, 0.2418, 0.3224, 0.1120, 0.2839, 0.2284, 0.3534, 0.4210,
        0.0361, 0.2841, 0.2069, 0.2176, 0.2681, 0.1397, 0.2014, 0.1089, 0.2920,
        0.2197, 0.1954, 0.1702, 0.2726, 0.3954, 0.0580, 0.2971, 0.3447, 0.4416,
        0.2521, 0.3737, 0.0658, 0.3305, 0.1916, 0.2148, 0.2361, 0.0905, 0.2486,
        0.2154, 0.1504, 0.2693, 0.1823, 0.2658, 0.2529, 0.1272, 0.2011, 0.2498,
        0.2593, 0.2314, 0.3019, 0.2921, 0.2092, 0.3162, 0.1161, 0.0994, 0.2367,
        0.2610, 0.1649, 0.1920, 0.1128, 0.2303, 0.1621, 0.1540, 0.2659, 0.2821,
        0.2937, 0.2419, 0.1798, 0.3223, 0.2049, 0.0544, 0.1992, 0.2414, 0.1227,
        0.1705, 0.3329, 0.1180, 0.1492, 0.2856, 0.2424, 0.1706, 0.2160, 0.1624,
        0.3047, 0.1989, 0.1753, 0.2138, 0.1315, 0.2453, 0.1690, 0.2229, 0.2210,
        0.2163, 0.2259, 0.2021, 0.2115, 0.2342, 0.2115, 0.2483, 0.2012, 0.3393,
        0.1326, 0.1597, 0.1182, 0.2248, 0.0336, 0.4479, 0.3955, 0.2826, 0.1300,
        0.1445, 0.1414, 0.2437, 0.1242, 0.1549, 0.0156, 0.3703, 0.0903, 0.3698,
        0.3462, 0.2463, 0.3084, 0.3472, 0.3367, 0.2360, 0.0718, 0.2908, 0.1815,
        0.1198, 0.1704, 0.1299, 0.2852, 0.1227, 0.3235, 0.1255, 0.0870, 0.3047,
        0.1841, 0.2584, 0.2135, 0.4021, 0.1214, 0.2450, 0.1147, 0.2162, 0.3319,
        0.1242, 0.1278, 0.2860, 0.2746, 0.2701, 0.1670, 0.3432, 0.2556, 0.2193,
        0.1757, 0.1304, 0.3791, 0.4889, 0.1345, 0.2346, 0.2868, 0.1848, 0.1540,
        0.2865, 0.0219, 0.2717, 0.1507, 0.1923, 0.3123, 0.3241, 0.0308, 0.3925,
        0.3509])
true tensor([ 0.4500,  0.1100,  0.6100,  0.4600,  0.6100,  0.4600,  0.4400, -0.3700,
         1.2700,  1.3800,  0.4900,  0.2700,  0.0500,  0.4500,  0.1100,  0.6100,
         1.3800,  0.4900,  0.2700,  0.3700, -0.3700,  0.3300,  0.4100,  0.6900,
         0.1100,  0.6100,  0.4600,  0.4400,  0.4600,  0.4400, -0.3700,  0.3300,
         0.4500,  0.1100,  0.6100,  0.4600,  0.2700,  0.3700,  0.9700,  0.0500,
         0.5200,  1.2700,  1.3800,  0.4900, -0.3700,  0.3300,  0.4100,  0.6900,
         0.4900,  0.2700,  0.3700,  0.9700,  0.4900,  0.2700,  0.3700,  0.9700,
         1.3800,  0.4900,  0.2700,  0.3700,  0.3700,  0.9700,  0.0500,  0.4500,
         0.4600,  0.4400, -0.3700,  0.3300,  1.2700,  1.3800,  0.4900,  0.2700,
         0.4400, -0.3700,  0.3300,  0.4100,  0.3300,  0.4100,  0.6900,  2.7200,
         0.5200,  1.2700,  1.3800,  0.4900,  0.4400, -0.3700,  0.3300,  0.4100,
         0.9700,  0.0500,  0.4500,  0.1100,  0.4400, -0.3700,  0.3300,  0.4100,
         0.1100,  0.6100,  0.4600,  0.4400,  0.9700,  0.0500,  0.4500,  0.1100,
        -0.3700,  0.3300,  0.4100,  0.6900,  0.4600,  0.4400, -0.3700,  0.3300,
         0.9700,  0.0500,  0.4500,  0.1100,  0.4500,  0.1100,  0.6100,  0.4600,
         0.3700,  0.9700,  0.0500,  0.4500,  0.6100,  0.4600,  0.4400, -0.3700,
         0.1100,  0.6100,  0.4600,  0.4400,  1.2700,  1.3800,  0.4900,  0.2700,
         0.6100,  0.4600,  0.4400, -0.3700,  0.2700,  0.3700,  0.9700,  0.0500,
         0.4900,  0.2700,  0.3700,  0.9700,  0.0500,  0.4500,  0.1100,  0.6100,
         0.5200,  1.2700,  1.3800,  0.4900,  1.3800,  0.4900,  0.2700,  0.3700,
         0.3700,  0.9700,  0.0500,  0.4500,  0.0500,  0.4500,  0.1100,  0.6100,
         0.2700,  0.3700,  0.9700,  0.0500])
Epoch: 2, Steps: 1 | Train Loss: 0.2368275 Vali Loss: 0.2645233
lr = 0.0000904518
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 3 cost time: 0.48824357986450195
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2487,  0.2007,  0.1831,  0.0474,  0.3089, -0.0757,  0.3275,  0.3028,
         0.2297,  0.2772,  0.2962,  0.1211,  0.2142,  0.2065,  0.2383,  0.1949,
         0.2217,  0.3447,  0.1125,  0.2986,  0.2113,  0.2442,  0.4737, -0.2684,
        -0.0069,  0.1072,  0.1656,  0.3961,  0.2612,  0.0217,  0.2361,  0.3054,
         0.1142,  0.2168,  0.2131,  0.2129,  0.1916,  0.0735,  0.2724,  0.0908,
         0.1041,  0.1855,  0.2863,  0.3322,  0.2596,  0.2565,  0.1776,  0.1196,
         0.2161,  0.2264,  0.2204,  0.0828,  0.2267,  0.1346,  0.2505,  0.0962,
         0.2933,  0.2611,  0.3251,  0.1552,  0.1208,  0.2475,  0.2226,  0.1302,
         0.2814,  0.2647,  0.0361,  0.3665,  0.3018,  0.0667,  0.1309,  0.1719,
         0.2415,  0.0674,  0.2361,  0.1812,  0.0877,  0.1325,  0.1863,  0.3442,
         0.2682,  0.4177,  0.2472,  0.1281,  0.1871,  0.2544,  0.3877,  0.1803,
         0.3769,  0.1904,  0.1957,  0.1846,  0.3375,  0.1830,  0.1736,  0.3838,
         0.1038,  0.3198,  0.4390, -0.0954,  0.2488,  0.1537,  0.1369,  0.2116,
         0.0653,  0.2760,  0.1486,  0.1245,  0.1985,  0.1557,  0.2003,  0.2687,
         0.1894,  0.1380,  0.1535,  0.2672,  0.1591,  0.1259,  0.3860,  0.1583,
         0.3783,  0.1750,  0.2784,  0.0577,  0.1713,  0.2276,  0.3360,  0.3698,
         0.2518,  0.0286,  0.4254,  0.1384,  0.2232,  0.1680,  0.3143,  0.2464,
         0.3624,  0.2467,  0.3780,  0.2872,  0.3393,  0.2354,  0.3466,  0.1967,
         0.1562,  0.2684,  0.1252,  0.2914,  0.1551,  0.2216,  0.1642,  0.2734,
         0.3124,  0.2292,  0.2477,  0.1052,  0.1145,  0.1137,  0.1970,  0.1983,
         0.3281,  0.1158,  0.2457,  0.1677,  0.1159,  0.2812,  0.1486,  0.3292,
         0.1174,  0.1848,  0.2656,  0.0592])
true tensor([ 0.0500,  0.4500,  0.1100,  0.6100,  0.4600,  0.4400, -0.3700,  0.3300,
         0.6100,  0.4600,  0.4400, -0.3700,  0.1100,  0.6100,  0.4600,  0.4400,
         1.3800,  0.4900,  0.2700,  0.3700,  0.1100,  0.6100,  0.4600,  0.4400,
         0.2700,  0.3700,  0.9700,  0.0500,  1.2700,  1.3800,  0.4900,  0.2700,
         0.1100,  0.6100,  0.4600,  0.4400,  0.5200,  1.2700,  1.3800,  0.4900,
         0.4900,  0.2700,  0.3700,  0.9700,  0.3700,  0.9700,  0.0500,  0.4500,
         0.2700,  0.3700,  0.9700,  0.0500,  0.4500,  0.1100,  0.6100,  0.4600,
         0.4400, -0.3700,  0.3300,  0.4100,  1.3800,  0.4900,  0.2700,  0.3700,
         0.3300,  0.4100,  0.6900,  2.7200, -0.3700,  0.3300,  0.4100,  0.6900,
         0.4400, -0.3700,  0.3300,  0.4100,  0.3700,  0.9700,  0.0500,  0.4500,
         0.6100,  0.4600,  0.4400, -0.3700,  0.9700,  0.0500,  0.4500,  0.1100,
         0.4600,  0.4400, -0.3700,  0.3300,  1.3800,  0.4900,  0.2700,  0.3700,
         0.2700,  0.3700,  0.9700,  0.0500,  0.9700,  0.0500,  0.4500,  0.1100,
         0.4600,  0.4400, -0.3700,  0.3300,  0.6100,  0.4600,  0.4400, -0.3700,
         0.9700,  0.0500,  0.4500,  0.1100, -0.3700,  0.3300,  0.4100,  0.6900,
         0.4500,  0.1100,  0.6100,  0.4600, -0.3700,  0.3300,  0.4100,  0.6900,
         0.3700,  0.9700,  0.0500,  0.4500,  1.2700,  1.3800,  0.4900,  0.2700,
         0.4900,  0.2700,  0.3700,  0.9700,  0.0500,  0.4500,  0.1100,  0.6100,
         0.4400, -0.3700,  0.3300,  0.4100,  0.4900,  0.2700,  0.3700,  0.9700,
         1.2700,  1.3800,  0.4900,  0.2700,  0.5200,  1.2700,  1.3800,  0.4900,
         0.0500,  0.4500,  0.1100,  0.6100,  0.4500,  0.1100,  0.6100,  0.4600,
         0.5200,  1.2700,  1.3800,  0.4900])
Epoch: 3, Steps: 1 | Train Loss: 0.2352346 Vali Loss: 0.2602499
lr = 0.0000793913
EarlyStopping counter: 2 out of 3
1it [00:00,  6.21it/s]
1it [00:00, 10.88it/s]
1it [00:00,  6.37it/s]
1it [00:00, 11.99it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 4 cost time: 0.4777662754058838
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2282,  0.2289,  0.2683,  0.1932,  0.1559,  0.3229,  0.2516,  0.3275,
         0.2641,  0.2522,  0.2832,  0.1656,  0.1481,  0.3017,  0.1907,  0.1884,
         0.0996,  0.3146,  0.2412,  0.2706,  0.1518,  0.2416,  0.2913,  0.2820,
         0.1970,  0.4961,  0.1748,  0.2523,  0.2072,  0.1154,  0.2563,  0.2322,
         0.3886,  0.3272,  0.4222,  0.1648,  0.2832, -0.0719,  0.2911,  0.2122,
         0.2124,  0.2463,  0.2232,  0.1794,  0.3182,  0.0986, -0.0534,  0.4334,
         0.2520,  0.2609,  0.2160,  0.1869,  0.1947,  0.2493,  0.3130,  0.2191,
         0.1762,  0.1251,  0.1511,  0.3090,  0.1747,  0.2829,  0.1729,  0.2951,
         0.2689,  0.2210,  0.2152,  0.3701,  0.2724,  0.2357,  0.3241,  0.2577,
         0.2307,  0.2794,  0.1561,  0.3640,  0.1516,  0.4366,  0.2278,  0.1246,
         0.1389,  0.1713,  0.1621,  0.2701,  0.2599,  0.0970,  0.1801,  0.2294,
         0.4535, -0.1875,  0.4546,  0.0829,  0.2028,  0.3173,  0.1610,  0.3075,
         0.2382,  0.3152,  0.1608,  0.2580,  0.2807,  0.1982,  0.2248,  0.4052,
         0.1861,  0.3191,  0.2885,  0.0895,  0.2111,  0.2523,  0.2605,  0.1218,
         0.3444,  0.3905,  0.2718,  0.1787,  0.2282,  0.2651,  0.2510,  0.2677,
         0.3804,  0.2204,  0.1368,  0.1199,  0.1466,  0.3037,  0.1393,  0.2844,
         0.1952,  0.2553,  0.3449,  0.2833,  0.2492,  0.0178,  0.3292,  0.2357,
         0.2077,  0.2408,  0.2725,  0.1444,  0.2556,  0.2871,  0.2611,  0.2144,
         0.0887,  0.4262,  0.0682,  0.4239,  0.1657,  0.2024,  0.1576,  0.3379,
         0.1067,  0.3417,  0.1633,  0.1249,  0.3233,  0.1669,  0.2291,  0.1502,
         0.1096,  0.2337,  0.2413,  0.2256,  0.2054,  0.2103,  0.3874,  0.2649,
         0.2365,  0.2133,  0.3602,  0.2620])
true tensor([-0.3700,  0.3300,  0.4100,  0.6900,  0.4500,  0.1100,  0.6100,  0.4600,
         0.0500,  0.4500,  0.1100,  0.6100,  0.3700,  0.9700,  0.0500,  0.4500,
         0.3300,  0.4100,  0.6900,  2.7200,  0.4900,  0.2700,  0.3700,  0.9700,
         0.3700,  0.9700,  0.0500,  0.4500,  0.5200,  1.2700,  1.3800,  0.4900,
         0.1100,  0.6100,  0.4600,  0.4400,  0.6100,  0.4600,  0.4400, -0.3700,
         1.2700,  1.3800,  0.4900,  0.2700,  0.4500,  0.1100,  0.6100,  0.4600,
         0.2700,  0.3700,  0.9700,  0.0500,  0.9700,  0.0500,  0.4500,  0.1100,
         0.4600,  0.4400, -0.3700,  0.3300,  0.9700,  0.0500,  0.4500,  0.1100,
         0.9700,  0.0500,  0.4500,  0.1100,  0.5200,  1.2700,  1.3800,  0.4900,
         0.4500,  0.1100,  0.6100,  0.4600,  0.3700,  0.9700,  0.0500,  0.4500,
         0.0500,  0.4500,  0.1100,  0.6100,  0.1100,  0.6100,  0.4600,  0.4400,
        -0.3700,  0.3300,  0.4100,  0.6900,  0.6100,  0.4600,  0.4400, -0.3700,
         0.6100,  0.4600,  0.4400, -0.3700,  0.4900,  0.2700,  0.3700,  0.9700,
         0.5200,  1.2700,  1.3800,  0.4900,  0.4600,  0.4400, -0.3700,  0.3300,
         1.3800,  0.4900,  0.2700,  0.3700,  0.0500,  0.4500,  0.1100,  0.6100,
         1.3800,  0.4900,  0.2700,  0.3700,  1.2700,  1.3800,  0.4900,  0.2700,
         1.3800,  0.4900,  0.2700,  0.3700,  0.2700,  0.3700,  0.9700,  0.0500,
         0.4900,  0.2700,  0.3700,  0.9700,  0.4400, -0.3700,  0.3300,  0.4100,
         0.4400, -0.3700,  0.3300,  0.4100,  1.2700,  1.3800,  0.4900,  0.2700,
         0.1100,  0.6100,  0.4600,  0.4400,  0.4400, -0.3700,  0.3300,  0.4100,
        -0.3700,  0.3300,  0.4100,  0.6900,  0.2700,  0.3700,  0.9700,  0.0500,
         0.4600,  0.4400, -0.3700,  0.3300])
Epoch: 4, Steps: 1 | Train Loss: 0.2370894 Vali Loss: 0.2472734
lr = 0.0000654543
Validation loss decreased (0.258248 --> 0.247273).  Saving model ...
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
1it [00:00,  6.46it/s]
1it [00:00, 10.49it/s]
1it [00:00,  6.29it/s]
Epoch: 5 cost time: 0.4837193489074707
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([0.2500, 0.2870, 0.2547, 0.1363, 0.1585, 0.3309, 0.2857, 0.0592, 0.1824,
        0.2795, 0.2027, 0.2465, 0.2319, 0.2404, 0.1691, 0.1657, 0.1305, 0.2425,
        0.2525, 0.0925, 0.2995, 0.1993, 0.1623, 0.3221, 0.1718, 0.2790, 0.0352,
        0.2441, 0.2721, 0.0404, 0.1204, 0.3432, 0.3753, 0.1662, 0.2969, 0.1202,
        0.1674, 0.2151, 0.3164, 0.0676, 0.2570, 0.1639, 0.2735, 0.2014, 0.2937,
        0.3161, 0.0883, 0.3030, 0.3533, 0.1466, 0.1718, 0.2736, 0.2521, 0.1390,
        0.1050, 0.0301, 0.3839, 0.2270, 0.1594, 0.2320, 0.3323, 0.1461, 0.2543,
        0.0751, 0.3193, 0.2276, 0.3406, 0.1541, 0.2305, 0.3374, 0.2561, 0.1367,
        0.2510, 0.2738, 0.3108, 0.3518, 0.2757, 0.3400, 0.1303, 0.2033, 0.3117,
        0.1896, 0.2961, 0.2375, 0.0486, 0.4084, 0.0532, 0.2665, 0.2130, 0.1751,
        0.2713, 0.0900, 0.0401, 0.1374, 0.4491, 0.1258, 0.2281, 0.2203, 0.3878,
        0.3170, 0.2350, 0.3640, 0.3620, 0.2266, 0.2105, 0.2002, 0.0792, 0.3178,
        0.3797, 0.1319, 0.1793, 0.0877, 0.3557, 0.0844, 0.1874, 0.0667, 0.3434,
        0.1637, 0.3069, 0.1239, 0.1389, 0.3366, 0.1607, 0.2975, 0.2488, 0.1206,
        0.2536, 0.1830, 0.2457, 0.1503, 0.4709, 0.3323, 0.1271, 0.1901, 0.2157,
        0.3389, 0.1907, 0.2165, 0.2277, 0.1990, 0.0743, 0.1876, 0.1101, 0.3324,
        0.1802, 0.2108, 0.2453, 0.1620, 0.2399, 0.2913, 0.2643, 0.1652, 0.1314,
        0.2895, 0.1969, 0.3122, 0.2292, 0.1042, 0.1655, 0.2890, 0.2721, 0.2348,
        0.1944, 0.1399, 0.1719, 0.2983, 0.1627, 0.3590, 0.1835, 0.2084, 0.2934,
        0.0953])
true tensor([ 0.9700,  0.0500,  0.4500,  0.1100, -0.3700,  0.3300,  0.4100,  0.6900,
         0.4900,  0.2700,  0.3700,  0.9700,  0.6100,  0.4600,  0.4400, -0.3700,
         0.3300,  0.4100,  0.6900,  2.7200,  1.3800,  0.4900,  0.2700,  0.3700,
         0.4400, -0.3700,  0.3300,  0.4100,  0.9700,  0.0500,  0.4500,  0.1100,
         0.4400, -0.3700,  0.3300,  0.4100,  0.5200,  1.2700,  1.3800,  0.4900,
         0.6100,  0.4600,  0.4400, -0.3700,  1.2700,  1.3800,  0.4900,  0.2700,
         1.3800,  0.4900,  0.2700,  0.3700,  0.9700,  0.0500,  0.4500,  0.1100,
         0.4600,  0.4400, -0.3700,  0.3300,  0.3700,  0.9700,  0.0500,  0.4500,
         0.2700,  0.3700,  0.9700,  0.0500,  0.1100,  0.6100,  0.4600,  0.4400,
         0.0500,  0.4500,  0.1100,  0.6100,  0.3700,  0.9700,  0.0500,  0.4500,
         0.3700,  0.9700,  0.0500,  0.4500,  0.4900,  0.2700,  0.3700,  0.9700,
         0.4900,  0.2700,  0.3700,  0.9700,  0.6100,  0.4600,  0.4400, -0.3700,
         0.4500,  0.1100,  0.6100,  0.4600,  0.4600,  0.4400, -0.3700,  0.3300,
         0.4500,  0.1100,  0.6100,  0.4600,  0.5200,  1.2700,  1.3800,  0.4900,
        -0.3700,  0.3300,  0.4100,  0.6900,  0.0500,  0.4500,  0.1100,  0.6100,
         0.2700,  0.3700,  0.9700,  0.0500, -0.3700,  0.3300,  0.4100,  0.6900,
         0.1100,  0.6100,  0.4600,  0.4400,  1.2700,  1.3800,  0.4900,  0.2700,
         0.4400, -0.3700,  0.3300,  0.4100,  1.2700,  1.3800,  0.4900,  0.2700,
         0.1100,  0.6100,  0.4600,  0.4400,  0.2700,  0.3700,  0.9700,  0.0500,
         1.3800,  0.4900,  0.2700,  0.3700,  0.4500,  0.1100,  0.6100,  0.4600,
         0.4600,  0.4400, -0.3700,  0.3300,  0.0500,  0.4500,  0.1100,  0.6100,
         0.5200,  1.2700,  1.3800,  0.4900])
Epoch: 5, Steps: 1 | Train Loss: 0.2378980 Vali Loss: 0.2592073
lr = 0.0000500050
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 6 cost time: 0.4888420104980469
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2967,  0.1025,  0.3385,  0.2212,  0.2708,  0.4195,  0.2234,  0.1700,
         0.2544,  0.3517,  0.0824,  0.2731,  0.2814,  0.1614,  0.3641,  0.1906,
         0.2319,  0.3392,  0.1429,  0.3980,  0.3301,  0.1766,  0.3113,  0.1537,
         0.1041,  0.2109,  0.2577,  0.2966,  0.2504,  0.2340,  0.0682,  0.3241,
         0.2955,  0.1749,  0.0997,  0.2662,  0.2052,  0.3143,  0.2831,  0.1440,
         0.1942,  0.2585,  0.2674,  0.3229,  0.1406,  0.2010,  0.2791,  0.2404,
         0.1339,  0.2819,  0.3219,  0.1637,  0.1594,  0.2315,  0.1306,  0.2313,
         0.4681,  0.2717,  0.3087,  0.2208,  0.2961,  0.1916,  0.3323,  0.2955,
         0.2331,  0.2566,  0.2414,  0.2566,  0.2144,  0.1410,  0.2348,  0.1578,
         0.1735,  0.2129,  0.2581,  0.3932,  0.2000,  0.2176,  0.1278,  0.2176,
         0.3221,  0.0982,  0.3860,  0.1300,  0.2188,  0.2612,  0.1045,  0.3648,
         0.2872,  0.2322,  0.3032,  0.1488,  0.2399,  0.2115,  0.1371,  0.3572,
         0.3640,  0.2197,  0.2217,  0.2703,  0.2107,  0.2082,  0.2609,  0.1281,
         0.3012,  0.0811,  0.1030,  0.4081,  0.1861,  0.4027, -0.0682,  0.0765,
         0.2020,  0.0865,  0.2266,  0.2136,  0.0983,  0.0722,  0.2179,  0.3897,
         0.1798,  0.3077,  0.3720,  0.0839,  0.1906,  0.1069,  0.3130,  0.2259,
         0.2922,  0.1838,  0.2774, -0.0170,  0.2555,  0.1560,  0.2446,  0.2274,
         0.2872,  0.3154,  0.1321,  0.2481,  0.2452,  0.3466,  0.2744,  0.2334,
         0.2072,  0.2962,  0.2713,  0.2116,  0.2871,  0.2821,  0.1188,  0.1675,
         0.2756,  0.1287,  0.2974,  0.3097,  0.2063,  0.2868,  0.0846,  0.2696,
         0.3399,  0.1621,  0.2941,  0.4470,  0.2708,  0.2245,  0.2300,  0.1031,
         0.1165,  0.2029,  0.3532,  0.1729])
true tensor([ 0.4500,  0.1100,  0.6100,  0.4600,  0.6100,  0.4600,  0.4400, -0.3700,
         0.6100,  0.4600,  0.4400, -0.3700,  1.3800,  0.4900,  0.2700,  0.3700,
         0.9700,  0.0500,  0.4500,  0.1100,  0.0500,  0.4500,  0.1100,  0.6100,
         0.4500,  0.1100,  0.6100,  0.4600,  0.2700,  0.3700,  0.9700,  0.0500,
         0.6100,  0.4600,  0.4400, -0.3700,  0.1100,  0.6100,  0.4600,  0.4400,
         0.4600,  0.4400, -0.3700,  0.3300,  0.0500,  0.4500,  0.1100,  0.6100,
         0.4900,  0.2700,  0.3700,  0.9700,  0.3700,  0.9700,  0.0500,  0.4500,
         1.3800,  0.4900,  0.2700,  0.3700,  0.4400, -0.3700,  0.3300,  0.4100,
         0.3300,  0.4100,  0.6900,  2.7200,  0.3700,  0.9700,  0.0500,  0.4500,
         0.5200,  1.2700,  1.3800,  0.4900,  0.5200,  1.2700,  1.3800,  0.4900,
         0.1100,  0.6100,  0.4600,  0.4400, -0.3700,  0.3300,  0.4100,  0.6900,
        -0.3700,  0.3300,  0.4100,  0.6900,  0.4500,  0.1100,  0.6100,  0.4600,
         1.2700,  1.3800,  0.4900,  0.2700,  0.9700,  0.0500,  0.4500,  0.1100,
         0.4900,  0.2700,  0.3700,  0.9700,  0.0500,  0.4500,  0.1100,  0.6100,
         0.5200,  1.2700,  1.3800,  0.4900,  0.4600,  0.4400, -0.3700,  0.3300,
         0.2700,  0.3700,  0.9700,  0.0500,  0.4900,  0.2700,  0.3700,  0.9700,
         0.2700,  0.3700,  0.9700,  0.0500,  1.3800,  0.4900,  0.2700,  0.3700,
         0.3700,  0.9700,  0.0500,  0.4500,  1.2700,  1.3800,  0.4900,  0.2700,
         1.2700,  1.3800,  0.4900,  0.2700,  0.4400, -0.3700,  0.3300,  0.4100,
         0.4400, -0.3700,  0.3300,  0.4100,  0.9700,  0.0500,  0.4500,  0.1100,
        -0.3700,  0.3300,  0.4100,  0.6900,  0.1100,  0.6100,  0.4600,  0.4400,
         0.4600,  0.4400, -0.3700,  0.3300])
Epoch: 6, Steps: 1 | Train Loss: 0.2329908 Vali Loss: 0.2460947
lr = 0.0000345557
Validation loss decreased (0.247273 --> 0.246095).  Saving model ...
1it [00:00, 11.79it/s]
1it [00:00,  6.37it/s]
1it [00:00, 12.58it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 7 cost time: 0.47891879081726074
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.1720,  0.2245,  0.2171,  0.2447,  0.1639,  0.2795,  0.3712,  0.1735,
         0.3347,  0.2090,  0.2560,  0.2526,  0.1449,  0.1262,  0.2785,  0.1855,
         0.2197,  0.0999,  0.1673,  0.3693,  0.2332,  0.2154,  0.1979,  0.0759,
         0.2256,  0.2072,  0.2144,  0.1804,  0.1109,  0.1903,  0.2675,  0.0898,
         0.1783,  0.1770,  0.0527,  0.0987,  0.2840,  0.2622,  0.2362,  0.3499,
         0.2498,  0.2868,  0.1066,  0.3605,  0.1469,  0.2882,  0.1787,  0.2387,
         0.2068,  0.2537,  0.1077,  0.2558,  0.3264,  0.3365,  0.2889,  0.2688,
         0.3393,  0.1530,  0.2611,  0.1221,  0.2018,  0.3371,  0.3749,  0.0942,
         0.0790,  0.3486,  0.2871,  0.3137,  0.2833,  0.1669,  0.1576,  0.3526,
         0.3626,  0.1535,  0.1566,  0.2593,  0.2563,  0.2044,  0.1336,  0.1095,
         0.3082,  0.3106,  0.2224,  0.2361,  0.5368,  0.4805,  0.3207, -0.1754,
         0.2573,  0.2697,  0.2523,  0.1381,  0.2755,  0.1587,  0.3905,  0.2605,
         0.2394,  0.1550,  0.2315,  0.0836,  0.1539,  0.3005,  0.2163,  0.2332,
         0.1514,  0.2977,  0.3331,  0.2050,  0.2081,  0.2200,  0.2068,  0.2848,
         0.1647,  0.3491,  0.3461,  0.0837,  0.1558,  0.4926,  0.0981,  0.2916,
         0.1894,  0.1196,  0.1305,  0.2700,  0.2709,  0.1856,  0.3612,  0.2625,
         0.2860,  0.2866,  0.2253,  0.2821,  0.0549,  0.2071,  0.3221,  0.3476,
         0.2516,  0.0104,  0.3837,  0.2860,  0.2849,  0.2703,  0.3727,  0.0614,
         0.2465,  0.1779,  0.1868,  0.1273,  0.2160,  0.1958,  0.2742,  0.2007,
         0.3870,  0.2105,  0.2190,  0.2270,  0.2047,  0.2278,  0.2284,  0.0836,
         0.2365,  0.2971,  0.3055,  0.1107,  0.3136,  0.1431,  0.2716,  0.2852,
         0.0389,  0.1739,  0.3465,  0.1723])
true tensor([ 0.3700,  0.9700,  0.0500,  0.4500,  0.2700,  0.3700,  0.9700,  0.0500,
         0.4400, -0.3700,  0.3300,  0.4100,  0.3700,  0.9700,  0.0500,  0.4500,
         0.6100,  0.4600,  0.4400, -0.3700,  0.1100,  0.6100,  0.4600,  0.4400,
         0.5200,  1.2700,  1.3800,  0.4900,  0.4500,  0.1100,  0.6100,  0.4600,
         0.4400, -0.3700,  0.3300,  0.4100,  0.0500,  0.4500,  0.1100,  0.6100,
         0.4900,  0.2700,  0.3700,  0.9700,  0.1100,  0.6100,  0.4600,  0.4400,
         1.2700,  1.3800,  0.4900,  0.2700,  0.4900,  0.2700,  0.3700,  0.9700,
         1.2700,  1.3800,  0.4900,  0.2700, -0.3700,  0.3300,  0.4100,  0.6900,
         1.3800,  0.4900,  0.2700,  0.3700,  0.6100,  0.4600,  0.4400, -0.3700,
         0.4600,  0.4400, -0.3700,  0.3300,  0.9700,  0.0500,  0.4500,  0.1100,
         0.4400, -0.3700,  0.3300,  0.4100,  0.1100,  0.6100,  0.4600,  0.4400,
         0.3300,  0.4100,  0.6900,  2.7200,  0.4900,  0.2700,  0.3700,  0.9700,
         0.2700,  0.3700,  0.9700,  0.0500,  0.4500,  0.1100,  0.6100,  0.4600,
         0.4600,  0.4400, -0.3700,  0.3300,  1.3800,  0.4900,  0.2700,  0.3700,
         0.2700,  0.3700,  0.9700,  0.0500,  0.6100,  0.4600,  0.4400, -0.3700,
         0.3700,  0.9700,  0.0500,  0.4500, -0.3700,  0.3300,  0.4100,  0.6900,
         0.4500,  0.1100,  0.6100,  0.4600,  0.4600,  0.4400, -0.3700,  0.3300,
         0.9700,  0.0500,  0.4500,  0.1100,  0.0500,  0.4500,  0.1100,  0.6100,
         1.2700,  1.3800,  0.4900,  0.2700,  1.3800,  0.4900,  0.2700,  0.3700,
         0.0500,  0.4500,  0.1100,  0.6100,  0.5200,  1.2700,  1.3800,  0.4900,
         0.5200,  1.2700,  1.3800,  0.4900, -0.3700,  0.3300,  0.4100,  0.6900,
         0.9700,  0.0500,  0.4500,  0.1100])
Epoch: 7, Steps: 1 | Train Loss: 0.2292736 Vali Loss: 0.2609534
lr = 0.0000206187
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 8 cost time: 0.5116865634918213
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2218,  0.3238,  0.4506,  0.3536,  0.2103,  0.3352,  0.3118,  0.1823,
         0.3823,  0.1799,  0.1500,  0.2611,  0.3913,  0.1557,  0.1064,  0.2766,
         0.3467,  0.1348,  0.1245,  0.3725,  0.1277,  0.1753,  0.3665,  0.2444,
         0.0261,  0.3308,  0.0784,  0.1587,  0.1200,  0.3169,  0.3383,  0.3754,
         0.1629,  0.2308,  0.2526,  0.3579,  0.2137,  0.3318,  0.1857,  0.3046,
         0.3217,  0.1478,  0.1718,  0.3497,  0.2480,  0.1700,  0.1880,  0.2194,
         0.2925,  0.2050,  0.3723,  0.3265,  0.2188,  0.2160,  0.2611,  0.2091,
         0.2412,  0.0905,  0.2799,  0.1602,  0.2214,  0.2452,  0.0855,  0.3456,
         0.2103,  0.1767,  0.2203,  0.2822,  0.2716,  0.2032,  0.2508,  0.1259,
         0.3801,  0.1983,  0.2575,  0.3071,  0.0943,  0.2676,  0.2890,  0.3900,
         0.2011,  0.4545,  0.2063,  0.1780,  0.2137,  0.2716,  0.2142,  0.2446,
         0.2209,  0.1259,  0.1394,  0.1582,  0.3169, -0.0915,  0.4295,  0.0138,
         0.2310,  0.2096,  0.2821,  0.2819,  0.2153,  0.2107,  0.1098,  0.0623,
         0.2985,  0.2559,  0.2024,  0.2551,  0.2338,  0.3142,  0.2645,  0.2140,
         0.2825,  0.1832,  0.2179,  0.2218,  0.1608,  0.2401,  0.3357,  0.2640,
         0.1842,  0.1169,  0.1565,  0.3388,  0.3271,  0.2175,  0.1748,  0.2844,
         0.0666,  0.1511,  0.2363,  0.2106,  0.2206,  0.2770,  0.3158,  0.3084,
         0.1461,  0.3679,  0.3291,  0.0402,  0.2678,  0.3920,  0.1057,  0.3217,
         0.2625,  0.1629,  0.1942,  0.2395,  0.3585,  0.0679,  0.3486,  0.1503,
         0.1505,  0.2975,  0.3417,  0.2313,  0.3980,  0.2674,  0.0907,  0.4214,
         0.1892,  0.3407,  0.2940,  0.3443,  0.3223,  0.1387,  0.2319,  0.3228,
         0.3595,  0.1966,  0.1750,  0.3482])
true tensor([ 0.3700,  0.9700,  0.0500,  0.4500,  0.3300,  0.4100,  0.6900,  2.7200,
         0.5200,  1.2700,  1.3800,  0.4900,  0.6100,  0.4600,  0.4400, -0.3700,
         0.1100,  0.6100,  0.4600,  0.4400,  0.4900,  0.2700,  0.3700,  0.9700,
         0.3700,  0.9700,  0.0500,  0.4500,  0.1100,  0.6100,  0.4600,  0.4400,
        -0.3700,  0.3300,  0.4100,  0.6900,  0.9700,  0.0500,  0.4500,  0.1100,
         1.3800,  0.4900,  0.2700,  0.3700,  0.4400, -0.3700,  0.3300,  0.4100,
         0.0500,  0.4500,  0.1100,  0.6100,  0.9700,  0.0500,  0.4500,  0.1100,
         0.2700,  0.3700,  0.9700,  0.0500,  0.4500,  0.1100,  0.6100,  0.4600,
         1.3800,  0.4900,  0.2700,  0.3700,  0.4600,  0.4400, -0.3700,  0.3300,
         0.9700,  0.0500,  0.4500,  0.1100,  1.2700,  1.3800,  0.4900,  0.2700,
         0.5200,  1.2700,  1.3800,  0.4900, -0.3700,  0.3300,  0.4100,  0.6900,
         1.2700,  1.3800,  0.4900,  0.2700,  0.0500,  0.4500,  0.1100,  0.6100,
         0.4400, -0.3700,  0.3300,  0.4100,  0.2700,  0.3700,  0.9700,  0.0500,
         1.3800,  0.4900,  0.2700,  0.3700, -0.3700,  0.3300,  0.4100,  0.6900,
         0.2700,  0.3700,  0.9700,  0.0500,  0.4600,  0.4400, -0.3700,  0.3300,
         0.4500,  0.1100,  0.6100,  0.4600,  0.6100,  0.4600,  0.4400, -0.3700,
         0.4900,  0.2700,  0.3700,  0.9700,  0.4400, -0.3700,  0.3300,  0.4100,
         0.5200,  1.2700,  1.3800,  0.4900,  1.2700,  1.3800,  0.4900,  0.2700,
         0.0500,  0.4500,  0.1100,  0.6100,  0.4600,  0.4400, -0.3700,  0.3300,
         0.1100,  0.6100,  0.4600,  0.4400,  0.4900,  0.2700,  0.3700,  0.9700,
         0.4500,  0.1100,  0.6100,  0.4600,  0.6100,  0.4600,  0.4400, -0.3700,
         0.3700,  0.9700,  0.0500,  0.4500])
Epoch: 8, Steps: 1 | Train Loss: 0.2330769 Vali Loss: 0.2477236
lr = 0.0000095582
EarlyStopping counter: 2 out of 3
1it [00:00,  6.07it/s]
1it [00:00, 11.01it/s]
1it [00:00,  6.24it/s]
1it [00:00, 11.52it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 9 cost time: 0.513256311416626
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.1166,  0.2175,  0.2689,  0.0672,  0.2625,  0.2054,  0.0405,  0.2823,
         0.2413,  0.2943,  0.3394,  0.2969,  0.1595,  0.1187,  0.3315,  0.3203,
         0.1850,  0.2761,  0.4003,  0.3437,  0.1964,  0.1312,  0.2638,  0.3279,
         0.3897,  0.1194,  0.1666,  0.2759,  0.2090,  0.2295,  0.2701,  0.2441,
         0.2374,  0.2438,  0.2156,  0.2404,  0.1883,  0.2301,  0.0958,  0.1860,
         0.1411,  0.3206,  0.1211,  0.2737,  0.0721,  0.2288,  0.2518,  0.2692,
         0.2310,  0.0291,  0.3296,  0.1811,  0.2236,  0.2836,  0.1532,  0.2502,
         0.2396,  0.2515,  0.3554,  0.2574,  0.1540,  0.2925,  0.2603,  0.2446,
         0.2754,  0.1120,  0.3987,  0.2407,  0.4271,  0.2329,  0.2221,  0.2183,
         0.1517,  0.2545,  0.2875,  0.3900,  0.1772,  0.1933,  0.1969,  0.0917,
         0.1884,  0.1424,  0.1852,  0.2291,  0.2717,  0.2265,  0.3971,  0.1530,
         0.2469,  0.1685,  0.1868,  0.1936,  0.1612,  0.2092,  0.1231,  0.2506,
         0.3457,  0.1639,  0.2433,  0.2218,  0.2035,  0.1518,  0.2158,  0.1318,
         0.2051,  0.1107,  0.2428,  0.0944,  0.2360,  0.4334,  0.1742,  0.1972,
         0.1161,  0.1290,  0.2183,  0.2452,  0.3004,  0.2620,  0.2731,  0.1959,
         0.0817,  0.4676,  0.2875,  0.2026,  0.2818,  0.1484,  0.3858,  0.2493,
         0.1321,  0.1437,  0.3006,  0.2149,  0.3289,  0.3359,  0.0669,  0.2996,
         0.5317, -0.0536,  0.4392,  0.0660,  0.2131,  0.3388,  0.2934,  0.0848,
         0.2016,  0.1561,  0.1602,  0.1281,  0.2710,  0.4153,  0.3847,  0.2074,
         0.1046,  0.3465,  0.3314,  0.1175,  0.2784,  0.1768,  0.2147,  0.2592,
         0.1831,  0.0981,  0.3565,  0.3749,  0.1553,  0.2965,  0.1360,  0.1647,
         0.4211,  0.1958,  0.2893,  0.1976])
true tensor([ 0.1100,  0.6100,  0.4600,  0.4400,  1.3800,  0.4900,  0.2700,  0.3700,
         1.2700,  1.3800,  0.4900,  0.2700,  0.2700,  0.3700,  0.9700,  0.0500,
        -0.3700,  0.3300,  0.4100,  0.6900,  1.2700,  1.3800,  0.4900,  0.2700,
         1.3800,  0.4900,  0.2700,  0.3700,  0.4600,  0.4400, -0.3700,  0.3300,
         0.6100,  0.4600,  0.4400, -0.3700,  0.4400, -0.3700,  0.3300,  0.4100,
         0.3700,  0.9700,  0.0500,  0.4500,  0.2700,  0.3700,  0.9700,  0.0500,
         0.5200,  1.2700,  1.3800,  0.4900, -0.3700,  0.3300,  0.4100,  0.6900,
         0.4500,  0.1100,  0.6100,  0.4600,  0.5200,  1.2700,  1.3800,  0.4900,
         0.4500,  0.1100,  0.6100,  0.4600,  0.3700,  0.9700,  0.0500,  0.4500,
         0.2700,  0.3700,  0.9700,  0.0500,  0.0500,  0.4500,  0.1100,  0.6100,
         1.2700,  1.3800,  0.4900,  0.2700,  0.4400, -0.3700,  0.3300,  0.4100,
         0.6100,  0.4600,  0.4400, -0.3700,  0.9700,  0.0500,  0.4500,  0.1100,
         1.3800,  0.4900,  0.2700,  0.3700,  0.1100,  0.6100,  0.4600,  0.4400,
         0.4900,  0.2700,  0.3700,  0.9700,  0.1100,  0.6100,  0.4600,  0.4400,
         0.4900,  0.2700,  0.3700,  0.9700,  0.3700,  0.9700,  0.0500,  0.4500,
         0.0500,  0.4500,  0.1100,  0.6100,  0.9700,  0.0500,  0.4500,  0.1100,
         0.4600,  0.4400, -0.3700,  0.3300,  0.4500,  0.1100,  0.6100,  0.4600,
         0.4400, -0.3700,  0.3300,  0.4100,  0.4600,  0.4400, -0.3700,  0.3300,
         0.3300,  0.4100,  0.6900,  2.7200,  0.9700,  0.0500,  0.4500,  0.1100,
         0.0500,  0.4500,  0.1100,  0.6100,  0.4900,  0.2700,  0.3700,  0.9700,
         0.6100,  0.4600,  0.4400, -0.3700,  0.5200,  1.2700,  1.3800,  0.4900,
        -0.3700,  0.3300,  0.4100,  0.6900])
Epoch: 9, Steps: 1 | Train Loss: 0.2344469 Vali Loss: 0.2540843
lr = 0.0000024569
EarlyStopping counter: 3 out of 3
Early stopping
------------------------------------
outputs torch.Size([93, 12, 18])
B 93
L 18
M 18
test shape: (1, 372) (1, 372)
test shape: (1, 1, 372) (1, 1, 372)
mae:0.4520, mse:0.6364, rmse:0.7978, r2:-0.0491
mse_mean = 0.6364, mse_std = 0.0000
r2_mean = -0.0491, mae_std = 0.0000
1it [00:00, 10.50it/s]