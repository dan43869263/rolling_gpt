['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
train 337
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
val 43
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
test 93
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (2): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (3): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (4): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (5): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
1it [00:01,  1.08s/it]
1it [00:00, 10.50it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 1 cost time: 1.3440062999725342
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([167])
missing_idx_len: 43
pred tensor([ 0.1996,  0.2093,  0.2095,  0.2449,  0.1986, -0.0154,  0.5175,  0.2056,
         0.0998,  0.1951,  0.2223,  0.2742,  0.1646,  0.1849,  0.2618,  0.2770,
         0.2029,  0.2436,  0.2694,  0.2412,  0.1773,  0.2859,  0.2160,  0.1075,
         0.2348,  0.1985,  0.2031,  0.2348,  0.2454,  0.2010,  0.1993,  0.2426,
         0.2605,  0.1350,  0.2618,  0.1520,  0.2419,  0.1351,  0.2995,  0.2350,
         0.1727,  0.2076,  0.2966,  0.1943,  0.2295,  0.2626,  0.2445,  0.2503,
         0.1972,  0.0660,  0.2359,  0.1250,  0.2420,  0.2388,  0.2268,  0.1783,
         0.2133,  0.1357,  0.2186,  0.2058,  0.2270,  0.2578,  0.2543,  0.1892,
         0.2291,  0.2085,  0.2470,  0.2173,  0.1958,  0.1320,  0.1818,  0.1907,
         0.1322,  0.1864,  0.3039,  0.2822,  0.2430,  0.1913,  0.2278,  0.2614,
         0.0865,  0.1671,  0.1919,  0.2440,  0.2207,  0.2850,  0.2209,  0.2358,
         0.2292,  0.2012,  0.2272,  0.1646,  0.1372,  0.2663,  0.2776,  0.2146,
         0.2201,  0.2423,  0.1902,  0.1738,  0.2656,  0.2478,  0.1371,  0.1436,
         0.2179,  0.1953,  0.2763,  0.2306,  0.2440,  0.2178,  0.2044,  0.2017,
         0.1976,  0.1936,  0.2081,  0.1516,  0.2669,  0.1931,  0.1685,  0.2281,
         0.2363,  0.2316,  0.1992,  0.1790,  0.2016,  0.2614,  0.1446,  0.2081,
         0.2916,  0.3182,  0.1941,  0.1823,  0.2168,  0.2255,  0.2424,  0.1399,
         0.2357,  0.1412,  0.2488,  0.1802,  0.2902,  0.2836,  0.2193,  0.1832,
         0.2415,  0.1979,  0.2166,  0.2437,  0.2024,  0.2456,  0.1879,  0.2122,
         0.1165,  0.1999,  0.1364,  0.2311,  0.2500,  0.2365,  0.2163,  0.2284,
         0.0881,  0.2986,  0.1761,  0.2094,  0.2194,  0.2095,  0.2617])
true tensor([0.9600, 0.9100, 1.2000, 0.2600, 0.8600, 0.9800, 0.8900, 1.1200, 0.7900,
        0.8600, 0.9800, 0.8900, 0.7500, 0.7900, 0.8600, 0.9800, 0.8700, 0.7500,
        0.7900, 0.8600, 1.0000, 1.4300, 0.9500, 0.9600, 1.2000, 0.2600, 0.3700,
        1.2700, 0.9100, 1.2000, 0.2600, 0.3700, 0.8700, 0.7500, 0.7900, 0.8600,
        0.8900, 1.1200, 1.0000, 1.4300, 1.1200, 1.0000, 1.4300, 0.9500, 1.2000,
        0.2600, 0.3700, 1.2700, 0.9800, 0.8900, 1.1200, 1.0000, 0.9600, 0.9100,
        1.2000, 0.2600, 0.9500, 0.9600, 0.9100, 1.2000, 0.7900, 0.8600, 0.9800,
        0.8900, 1.2000, 0.2600, 0.3700, 1.2700, 1.4300, 0.9500, 0.9600, 0.9100,
        0.8900, 1.1200, 1.0000, 1.4300, 0.2600, 0.3700, 1.2700, 0.8900, 1.1200,
        1.0000, 1.4300, 0.9100, 1.2000, 0.2600, 0.3700, 0.9500, 0.9600, 0.9100,
        1.2000, 0.8600, 0.9800, 0.8900, 1.1200, 0.9100, 1.2000, 0.2600, 0.3700,
        0.8700, 0.7500, 0.7900, 0.8600, 1.1200, 1.0000, 1.4300, 0.9500, 0.9500,
        0.9600, 0.9100, 1.2000, 0.9800, 0.8900, 1.1200, 1.0000, 0.7500, 0.7900,
        0.8600, 0.9800, 0.2600, 0.3700, 1.2700, 1.1200, 1.0000, 1.4300, 0.9500,
        1.0000, 1.4300, 0.9500, 0.9600, 0.9600, 0.9100, 1.2000, 0.2600, 1.0000,
        1.4300, 0.9500, 0.9600, 1.4300, 0.9500, 0.9600, 0.9100, 0.3700, 1.2700,
        0.2600, 0.3700, 1.2700, 1.4300, 0.9500, 0.9600, 0.9100, 0.7900, 0.8600,
        0.9800, 0.8900, 0.8600, 0.9800, 0.8900, 1.1200, 0.7500, 0.7900, 0.8600,
        0.9800, 0.9800, 0.8900, 1.1200, 1.0000])
Epoch: 1, Steps: 1 | Train Loss: 2005.6364746 Vali Loss: 0.5873471
lr = 0.0000975531
Validation loss decreased (inf --> 0.587347).  Saving model ...
1it [00:00,  5.96it/s]
1it [00:00, 12.15it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 2 cost time: 0.5000183582305908
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([167])
missing_idx_len: 43
pred tensor([0.2360, 0.0842, 0.2164, 0.1700, 0.2197, 0.2068, 0.2250, 0.2203, 0.2879,
        0.0066, 0.3058, 0.1731, 0.2784, 0.1456, 0.3694, 0.1222, 0.2383, 0.2030,
        0.2145, 0.2316, 0.2250, 0.2234, 0.2023, 0.1981, 0.2657, 0.2026, 0.2468,
        0.2484, 0.2355, 0.2541, 0.2152, 0.1487, 0.2735, 0.1736, 0.1081, 0.1982,
        0.1055, 0.2689, 0.1687, 0.2716, 0.1568, 0.2376, 0.1336, 0.2598, 0.1973,
        0.2162, 0.2349, 0.1221, 0.2809, 0.1864, 0.1730, 0.3052, 0.2428, 0.2285,
        0.2213, 0.1257, 0.1459, 0.1628, 0.1162, 0.1884, 0.2254, 0.2884, 0.2456,
        0.2246, 0.2230, 0.2104, 0.1174, 0.1211, 0.2703, 0.2137, 0.2061, 0.2411,
        0.2618, 0.2547, 0.2237, 0.2067, 0.1444, 0.2077, 0.2085, 0.2716, 0.2099,
        0.2160, 0.2101, 0.2276, 0.2185, 0.1194, 0.2868, 0.1728, 0.2407, 0.2346,
        0.2177, 0.1957, 0.1476, 0.1570, 0.2546, 0.1972, 0.1819, 0.1999, 0.1186,
        0.3156, 0.2473, 0.2218, 0.2032, 0.1884, 0.3112, 0.1789, 0.2303, 0.2183,
        0.0751, 0.2927, 0.1081, 0.1822, 0.2416, 0.2910, 0.3229, 0.2569, 0.2409,
        0.2558, 0.1798, 0.2138, 0.2618, 0.1642, 0.2044, 0.2582, 0.2259, 0.2284,
        0.1988, 0.1461, 0.1290, 0.2772, 0.1299, 0.2131, 0.2560, 0.2120, 0.2248,
        0.1362, 0.2817, 0.2560, 0.3159, 0.2172, 0.1596, 0.2078, 0.2164, 0.1838,
        0.2647, 0.2214, 0.1284, 0.1491, 0.2188, 0.1233, 0.2494, 0.1937, 0.1979,
        0.2199, 0.2431, 0.1938, 0.1348, 0.2840, 0.1112, 0.1241, 0.2069, 0.2470,
        0.3236, 0.2381, 0.1226, 0.3021, 0.2442])
true tensor([1.4300, 0.9500, 0.9600, 0.9100, 0.9600, 0.9100, 1.2000, 0.2600, 0.7500,
        0.7900, 0.8600, 0.9800, 1.0000, 1.4300, 0.9500, 0.9600, 0.7900, 0.8600,
        0.9800, 0.8900, 0.2600, 0.3700, 1.2700, 0.9500, 0.9600, 0.9100, 1.2000,
        0.9100, 1.2000, 0.2600, 0.3700, 1.4300, 0.9500, 0.9600, 0.9100, 0.9800,
        0.8900, 1.1200, 1.0000, 0.8700, 0.7500, 0.7900, 0.8600, 0.2600, 0.3700,
        1.2700, 0.8600, 0.9800, 0.8900, 1.1200, 0.8600, 0.9800, 0.8900, 1.1200,
        0.7900, 0.8600, 0.9800, 0.8900, 0.8900, 1.1200, 1.0000, 1.4300, 0.9100,
        1.2000, 0.2600, 0.3700, 0.7500, 0.7900, 0.8600, 0.9800, 1.2000, 0.2600,
        0.3700, 1.2700, 0.3700, 1.2700, 0.8700, 0.7500, 0.7900, 0.8600, 1.2000,
        0.2600, 0.3700, 1.2700, 1.1200, 1.0000, 1.4300, 0.9500, 1.2000, 0.2600,
        0.3700, 1.2700, 0.9500, 0.9600, 0.9100, 1.2000, 1.1200, 1.0000, 1.4300,
        0.9500, 0.2600, 0.3700, 1.2700, 0.9100, 1.2000, 0.2600, 0.3700, 1.1200,
        1.0000, 1.4300, 0.9500, 1.4300, 0.9500, 0.9600, 0.9100, 0.8900, 1.1200,
        1.0000, 1.4300, 0.9600, 0.9100, 1.2000, 0.2600, 0.9500, 0.9600, 0.9100,
        1.2000, 0.7500, 0.7900, 0.8600, 0.9800, 0.9600, 0.9100, 1.2000, 0.2600,
        0.9800, 0.8900, 1.1200, 1.0000, 0.8600, 0.9800, 0.8900, 1.1200, 1.0000,
        1.4300, 0.9500, 0.9600, 0.8700, 0.7500, 0.7900, 0.8600, 0.7900, 0.8600,
        0.9800, 0.8900, 0.8900, 1.1200, 1.0000, 1.4300, 1.0000, 1.4300, 0.9500,
        0.9600, 0.9800, 0.8900, 1.1200, 1.0000])
Epoch: 2, Steps: 1 | Train Loss: 2005.3731689 Vali Loss: 0.5920728
lr = 0.0000904518
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 3 cost time: 0.4864797592163086
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([167])
missing_idx_len: 43
pred tensor([ 0.2247,  0.1586,  0.1828,  0.1062,  0.2203,  0.2209,  0.2532,  0.2279,
         0.2183,  0.2508,  0.2296,  0.2164,  0.1807,  0.1628,  0.2175,  0.1724,
         0.2462,  0.1459,  0.2546,  0.2018,  0.2605,  0.2298,  0.2394,  0.2163,
        -0.0457,  0.2263,  0.1408,  0.2846,  0.1936,  0.0808,  0.1937,  0.2287,
         0.2209,  0.2253,  0.2106,  0.2513,  0.0776,  0.1909,  0.2497,  0.1928,
         0.0565,  0.1451,  0.4579,  0.2136,  0.1472,  0.2314,  0.1728,  0.1782,
         0.2111,  0.1007,  0.5374,  0.1452,  0.1508,  0.2109,  0.2066,  0.1187,
         0.2066,  0.2703,  0.2542,  0.2002,  0.2088,  0.2168,  0.3197,  0.0490,
         0.2221,  0.2225,  0.1958,  0.2344,  0.2079,  0.2088,  0.2327,  0.1980,
         0.2324,  0.1775,  0.1438,  0.2262,  0.2693,  0.1927,  0.2484,  0.1918,
         0.2196,  0.2505,  0.3198,  0.2226,  0.0894,  0.2239,  0.2086,  0.2680,
         0.2012,  0.0788,  0.1572,  0.1851,  0.3664,  0.1952,  0.2025,  0.2107,
         0.1110,  0.2122,  0.0267,  0.2867,  0.1727,  0.2336,  0.2174,  0.2634,
         0.2257,  0.2182,  0.2151,  0.2004,  0.2355,  0.1830,  0.2063,  0.1895,
         0.3296,  0.2742,  0.2133,  0.2439,  0.2229,  0.2085,  0.2207,  0.2590,
         0.2381,  0.2189,  0.2436,  0.1923,  0.0924,  0.3426,  0.1837,  0.2631,
         0.0731,  0.3640,  0.1379,  0.2199,  0.1703,  0.2635,  0.1660,  0.3155,
         0.1109,  0.2860,  0.1419,  0.2001,  0.2271,  0.2453,  0.2251,  0.2773,
         0.0929,  0.3167,  0.1816,  0.1655,  0.1433,  0.2671,  0.2557,  0.2044,
         0.1595,  0.1963,  0.2284,  0.0941,  0.1956,  0.2675,  0.2278,  0.2027,
         0.1077,  0.2843,  0.2486,  0.1482,  0.1749,  0.2110,  0.1235])
true tensor([1.0000, 1.4300, 0.9500, 0.9600, 0.9100, 1.2000, 0.2600, 0.3700, 0.9600,
        0.9100, 1.2000, 0.2600, 0.9500, 0.9600, 0.9100, 1.2000, 0.7900, 0.8600,
        0.9800, 0.8900, 0.9500, 0.9600, 0.9100, 1.2000, 0.9800, 0.8900, 1.1200,
        1.0000, 0.7500, 0.7900, 0.8600, 0.9800, 0.9500, 0.9600, 0.9100, 1.2000,
        0.8700, 0.7500, 0.7900, 0.8600, 0.8600, 0.9800, 0.8900, 1.1200, 0.8900,
        1.1200, 1.0000, 1.4300, 0.9800, 0.8900, 1.1200, 1.0000, 1.4300, 0.9500,
        0.9600, 0.9100, 1.2000, 0.2600, 0.3700, 1.2700, 0.7900, 0.8600, 0.9800,
        0.8900, 0.3700, 1.2700, 0.2600, 0.3700, 1.2700, 1.2000, 0.2600, 0.3700,
        1.2700, 0.8900, 1.1200, 1.0000, 1.4300, 0.9600, 0.9100, 1.2000, 0.2600,
        1.1200, 1.0000, 1.4300, 0.9500, 0.9100, 1.2000, 0.2600, 0.3700, 0.7900,
        0.8600, 0.9800, 0.8900, 0.9800, 0.8900, 1.1200, 1.0000, 1.1200, 1.0000,
        1.4300, 0.9500, 0.9100, 1.2000, 0.2600, 0.3700, 0.9600, 0.9100, 1.2000,
        0.2600, 1.1200, 1.0000, 1.4300, 0.9500, 0.2600, 0.3700, 1.2700, 1.4300,
        0.9500, 0.9600, 0.9100, 0.2600, 0.3700, 1.2700, 0.8900, 1.1200, 1.0000,
        1.4300, 0.7500, 0.7900, 0.8600, 0.9800, 0.8600, 0.9800, 0.8900, 1.1200,
        1.0000, 1.4300, 0.9500, 0.9600, 1.2000, 0.2600, 0.3700, 1.2700, 0.8600,
        0.9800, 0.8900, 1.1200, 0.7500, 0.7900, 0.8600, 0.9800, 0.8700, 0.7500,
        0.7900, 0.8600, 1.0000, 1.4300, 0.9500, 0.9600, 1.4300, 0.9500, 0.9600,
        0.9100, 0.8700, 0.7500, 0.7900, 0.8600])
Epoch: 3, Steps: 1 | Train Loss: 2005.5570068 Vali Loss: 0.6003169
lr = 0.0000793913
EarlyStopping counter: 2 out of 3
1it [00:00,  6.37it/s]
1it [00:00, 10.81it/s]
1it [00:00,  5.98it/s]
1it [00:00, 12.68it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 4 cost time: 0.49329376220703125
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([167])
missing_idx_len: 43
pred tensor([ 0.2616,  0.1891,  0.2320,  0.2227,  0.2193,  0.2739,  0.3120,  0.2605,
         0.1018,  0.2632,  0.1447,  0.1774,  0.2178,  0.2641,  0.2934,  0.2269,
         0.2216,  0.2660,  0.1221,  0.2352,  0.1914,  0.2594,  0.1940,  0.2682,
         0.1692,  0.2372,  0.1724,  0.2933,  0.2311,  0.2128,  0.2505,  0.2115,
         0.2191,  0.2283,  0.1958,  0.2064,  0.2022,  0.2234,  0.2230,  0.2543,
         0.1968,  0.1683,  0.1794,  0.1689,  0.2120,  0.2043,  0.1990,  0.2223,
         0.0940,  0.2206,  0.1659,  0.2176,  0.1160,  0.2407,  0.1766,  0.2738,
         0.2013,  0.1530,  0.1843,  0.2239,  0.2400,  0.2464,  0.1239,  0.1745,
         0.1916,  0.1842,  0.2134,  0.1815,  0.2026,  0.2132,  0.1899,  0.1866,
         0.1973,  0.1386,  0.2659,  0.1995,  0.1781,  0.1229,  0.2012,  0.2396,
         0.2375,  0.2031,  0.1910,  0.2224,  0.1910,  0.2552,  0.1823,  0.2557,
         0.2178,  0.2481,  0.2089,  0.2388,  0.1718,  0.1834,  0.2016,  0.2127,
         0.1617,  0.2450, -0.0480,  0.5117,  0.1734,  0.2431,  0.2237,  0.2485,
         0.2284,  0.2242,  0.2275,  0.2105,  0.1842,  0.2323,  0.1989,  0.2072,
         0.1609,  0.1898,  0.4638, -0.0328,  0.2587,  0.2323,  0.1830,  0.1152,
         0.2566,  0.1299,  0.2991,  0.1571,  0.2114,  0.1329,  0.1946,  0.2086,
         0.1619,  0.1997,  0.2616,  0.2330,  0.2791,  0.1399,  0.2664,  0.1326,
         0.2036,  0.2541,  0.2373,  0.2207,  0.1788,  0.2424,  0.2335,  0.2680,
         0.1821,  0.1239,  0.1921,  0.3101,  0.2361,  0.2063,  0.2183,  0.2289,
         0.2281,  0.2204,  0.2039,  0.2347,  0.2026,  0.2277,  0.2455,  0.2815,
         0.2098,  0.2212,  0.2135,  0.2401,  0.2034,  0.2393,  0.2307])
true tensor([0.2600, 0.3700, 1.2700, 1.4300, 0.9500, 0.9600, 0.9100, 1.0000, 1.4300,
        0.9500, 0.9600, 0.8900, 1.1200, 1.0000, 1.4300, 0.3700, 1.2700, 0.8600,
        0.9800, 0.8900, 1.1200, 0.8900, 1.1200, 1.0000, 1.4300, 0.8700, 0.7500,
        0.7900, 0.8600, 0.9500, 0.9600, 0.9100, 1.2000, 0.9600, 0.9100, 1.2000,
        0.2600, 0.7500, 0.7900, 0.8600, 0.9800, 1.4300, 0.9500, 0.9600, 0.9100,
        0.9800, 0.8900, 1.1200, 1.0000, 1.1200, 1.0000, 1.4300, 0.9500, 0.9100,
        1.2000, 0.2600, 0.3700, 1.1200, 1.0000, 1.4300, 0.9500, 1.1200, 1.0000,
        1.4300, 0.9500, 0.8700, 0.7500, 0.7900, 0.8600, 1.4300, 0.9500, 0.9600,
        0.9100, 0.8900, 1.1200, 1.0000, 1.4300, 1.0000, 1.4300, 0.9500, 0.9600,
        0.9500, 0.9600, 0.9100, 1.2000, 0.2600, 0.3700, 1.2700, 0.9600, 0.9100,
        1.2000, 0.2600, 0.9600, 0.9100, 1.2000, 0.2600, 0.8600, 0.9800, 0.8900,
        1.1200, 0.8700, 0.7500, 0.7900, 0.8600, 0.9100, 1.2000, 0.2600, 0.3700,
        0.7900, 0.8600, 0.9800, 0.8900, 1.0000, 1.4300, 0.9500, 0.9600, 0.7900,
        0.8600, 0.9800, 0.8900, 0.7500, 0.7900, 0.8600, 0.9800, 0.7900, 0.8600,
        0.9800, 0.8900, 0.9800, 0.8900, 1.1200, 1.0000, 0.8600, 0.9800, 0.8900,
        1.1200, 1.2000, 0.2600, 0.3700, 1.2700, 1.2000, 0.2600, 0.3700, 1.2700,
        0.7500, 0.7900, 0.8600, 0.9800, 0.9500, 0.9600, 0.9100, 1.2000, 1.2000,
        0.2600, 0.3700, 1.2700, 0.2600, 0.3700, 1.2700, 0.9800, 0.8900, 1.1200,
        1.0000, 0.9100, 1.2000, 0.2600, 0.3700])
Epoch: 4, Steps: 1 | Train Loss: 2005.4516602 Vali Loss: 0.5919586
lr = 0.0000654543
EarlyStopping counter: 3 out of 3
Early stopping
------------------------------------
outputs torch.Size([93, 12, 18])
B 93
L 18
M 18
test shape: (1, 0) (1, 0)
1it [00:00, 11.70it/s]
Traceback (most recent call last):
  File "/home/dan/NeurIPS2023-One-Fits-All/Long-term_Forecasting/main.py", line 229, in <module>
    mse, r2 = test(model, test_data, test_loader, args, device, ii)
  File "/home/dan/NeurIPS2023-One-Fits-All/Long-term_Forecasting/utils/tools.py", line 334, in test
    preds = preds.reshape(-1, preds.shape[-2], preds.shape[-1])
ValueError: cannot reshape array of size 0 into shape (1,0)