['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
train 337
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
val 43
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
test 93
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (2): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (3): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (4): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (5): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
1it [00:01,  1.10s/it]
0it [00:00, ?it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 1 cost time: 1.3809971809387207
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([85])
missing_idx_len: 43
pred tensor([0.2042, 0.1570, 0.2049, 0.1547, 0.1625, 0.2080, 0.3397, 0.4258, 0.0978,
        0.1385, 0.3034, 0.1415, 0.2778, 0.1783, 0.2678, 0.2545, 0.1041, 0.2783,
        0.2825, 0.2964, 0.2108, 0.4402, 0.2054, 0.1468, 0.2472, 0.2913, 0.4051,
        0.2562, 0.2202, 0.1995, 0.3744, 0.3179, 0.2882, 0.2584, 0.1649, 0.3126,
        0.2443, 0.2070, 0.2994, 0.2485, 0.0875, 0.2968, 0.2224, 0.3168, 0.2812,
        0.1566, 0.1110, 0.2860, 0.1915, 0.1606, 0.1155, 0.3492, 0.2173, 0.1709,
        0.2666, 0.2734, 0.3237, 0.1340, 0.3760, 0.1828, 0.2732, 0.3893, 0.3402,
        0.1613, 0.4235, 0.1105, 0.1907, 0.1973, 0.2270, 0.3067, 0.2447, 0.3228,
        0.1494, 0.2188, 0.2046, 0.2077, 0.3228, 0.2234, 0.0442, 0.2085, 0.2227,
        0.2799, 0.0074, 0.2365, 0.1136])
true tensor([ -3.0000,   8.5500,   0.7500,  -5.1000, -15.7500,  -5.1000, -15.7500,
         -5.1000, -15.7500,  -1.0500,  -5.1000,   8.5500,   0.7500,  -2.7000,
         -4.9500,  -3.0000,   8.5500,   0.7500,  -2.7000,  -1.0500,  -5.1000,
          8.5500,   0.7500,  -2.7000,  -4.9500, -15.7500,  -3.0000,   8.5500,
          0.7500,  -3.0000,   8.5500,  -5.1000, -15.7500,   8.5500,   0.7500,
         -2.7000,  -4.9500,  -3.0000,   0.7500,  -2.7000,  -4.9500,  -1.0500,
         -3.0000,   8.5500,   0.7500,  -2.7000,  -3.0000,   8.5500,  -5.1000,
        -15.7500,  -3.0000,   8.5500,   0.7500,  -2.7000,  -1.0500,  -5.1000,
         -3.0000,   8.5500, -15.7500,  -5.1000, -15.7500,   0.7500,  -2.7000,
         -4.9500,  -1.0500,  -3.0000,   8.5500,   0.7500,  -3.0000,  -2.7000,
         -4.9500,  -1.0500,   2.7000,   0.7500,  -2.7000,  -4.9500,  -1.0500,
         -3.0000,  -5.1000, -15.7500,  -5.1000, -15.7500,  -5.1000, -15.7500,
        -15.7500])
Epoch: 1, Steps: 1 | Train Loss: 28.2160912 Vali Loss: 54.7180786
lr = 0.0000975531
1it [00:00, 11.69it/s]
1it [00:00,  6.34it/s]
1it [00:00, 11.71it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 2 cost time: 0.4984464645385742
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([85])
missing_idx_len: 43
pred tensor([0.2774, 0.3813, 0.1534, 0.3409, 0.2922, 0.1900, 0.2995, 0.2126, 0.2375,
        0.2386, 0.3138, 0.1987, 0.3958, 0.2141, 0.1591, 0.1387, 0.2509, 0.0268,
        0.2643, 0.2319, 0.2622, 0.2184, 0.3530, 0.3225, 0.2447, 0.2103, 0.2578,
        0.2224, 0.1025, 0.1928, 0.1204, 0.2294, 0.2837, 0.2133, 0.3489, 0.2147,
        0.2798, 0.1497, 0.1846, 0.3152, 0.0827, 0.1033, 0.2738, 0.2331, 0.1712,
        0.2550, 0.1637, 0.1774, 0.1734, 0.2730, 0.1754, 0.2304, 0.2099, 0.2568,
        0.2007, 0.1708, 0.3143, 0.1895, 0.3200, 0.4357, 0.2502, 0.1537, 0.0821,
        0.3591, 0.2959, 0.0784, 0.2346, 0.1830, 0.1026, 0.2280, 0.1605, 0.1636,
        0.2969, 0.1780, 0.2238, 0.3516, 0.1857, 0.2365, 0.1277, 0.1739, 0.2300,
        0.3978, 0.1567, 0.2218, 0.3024])
true tensor([ -3.0000,  -3.0000,   8.5500,   0.7500,  -5.1000, -15.7500,  -5.1000,
        -15.7500,   0.7500,  -2.7000,  -4.9500,  -1.0500,  -3.0000,   8.5500,
         -3.0000,   8.5500,   0.7500,  -2.7000,  -3.0000, -15.7500,  -1.0500,
         -5.1000,   0.7500,  -2.7000,  -4.9500,  -1.0500,  -5.1000, -15.7500,
         -5.1000, -15.7500,  -5.1000, -15.7500,  -3.0000,   8.5500,   0.7500,
         -2.7000,  -5.1000, -15.7500,   8.5500,   0.7500,  -2.7000,  -4.9500,
         -2.7000,  -4.9500,  -1.0500,   2.7000,  -1.0500,  -5.1000,   8.5500,
          0.7500,  -2.7000,  -4.9500,   8.5500,   0.7500,  -2.7000,  -4.9500,
         -3.0000,   8.5500,   0.7500,  -2.7000,  -4.9500,  -1.0500,  -3.0000,
          8.5500,   0.7500,  -2.7000,  -3.0000,  -3.0000,   8.5500,   0.7500,
         -3.0000,   8.5500,  -5.1000, -15.7500,  -3.0000,   8.5500,   0.7500,
        -15.7500,  -5.1000, -15.7500,  -1.0500,  -5.1000,  -5.1000, -15.7500,
        -15.7500])
Epoch: 2, Steps: 1 | Train Loss: 28.1971378 Vali Loss: 54.7257423
lr = 0.0000904518
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 3 cost time: 0.5065674781799316
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([85])
missing_idx_len: 43
pred tensor([ 0.3161, -0.0707,  0.4065,  0.2560,  0.2453,  0.2172,  0.2861,  0.2938,
         0.2735,  0.3213,  0.1049,  0.3074,  0.0143, -0.2144,  0.2202,  0.3261,
         0.1051,  0.2784,  0.1655,  0.0831,  0.1330,  0.1450,  0.2197,  0.1018,
         0.2478,  0.2713,  0.2361,  0.0178,  0.2533,  0.2194,  0.2315,  0.1877,
         0.0631,  0.4245,  0.2932,  0.0395,  0.2332,  0.1889,  0.2509,  0.2015,
         0.2562,  0.1864,  0.3025,  0.1826,  0.2172,  0.3130,  0.1794,  0.1877,
         0.1571,  0.1919,  0.1633,  0.0822,  0.0695,  0.1559,  0.0871,  0.0660,
         0.2327,  0.1257,  0.2677,  0.2829,  0.1174,  0.4091,  0.1010, -0.0814,
         0.0882,  0.3372,  0.1748,  0.2836,  0.3243,  0.2426,  0.3887,  0.2588,
         0.1315,  0.3627,  0.1604,  0.2637,  0.1761,  0.2091,  0.2678,  0.0986,
         0.1043,  0.2072,  0.3083,  0.1180,  0.0390])
true tensor([ -3.0000,   8.5500,   0.7500,  -2.7000,  -3.0000,   8.5500,   0.7500,
         -3.0000,   8.5500,  -5.1000, -15.7500,  -3.0000,   8.5500, -15.7500,
         -5.1000, -15.7500,  -3.0000,   8.5500,  -1.0500,  -5.1000,  -5.1000,
        -15.7500, -15.7500,  -3.0000,   8.5500,   0.7500,  -2.7000,  -4.9500,
         -5.1000, -15.7500,  -2.7000,  -4.9500,  -1.0500,   2.7000,   0.7500,
         -2.7000,  -4.9500,  -1.0500,   8.5500,   0.7500,  -2.7000,  -4.9500,
         -3.0000,   8.5500,   0.7500,  -3.0000,   8.5500,   0.7500,  -2.7000,
         -5.1000, -15.7500, -15.7500,  -3.0000,   8.5500,   0.7500,  -2.7000,
         -3.0000,   8.5500,   0.7500,   0.7500,  -2.7000,  -4.9500,  -1.0500,
         -3.0000,   0.7500,  -2.7000,  -4.9500,  -1.0500,  -5.1000, -15.7500,
         -5.1000, -15.7500,   8.5500,   0.7500,  -2.7000,  -4.9500,  -5.1000,
        -15.7500,  -5.1000, -15.7500,  -1.0500,  -5.1000,  -3.0000,  -1.0500,
         -5.1000])
Epoch: 3, Steps: 1 | Train Loss: 28.1467724 Vali Loss: 54.4799576
lr = 0.0000793913
Validation loss decreased (54.718079 --> 54.479958).  Saving model ...
1it [00:00,  6.35it/s]
1it [00:00, 10.71it/s]
1it [00:00,  6.00it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 4 cost time: 0.50925612449646
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([85])
missing_idx_len: 43
pred tensor([ 0.3144,  0.2282,  0.3220,  0.1238,  0.2560,  0.1269,  0.2310,  0.1963,
         0.3159,  0.1728,  0.2146,  0.1922,  0.2403,  0.2333,  0.2998,  0.0696,
         0.0478,  0.2174,  0.2407,  0.1772,  0.4494,  0.2416,  0.1307,  0.1922,
         0.1302,  0.1729,  0.2784,  0.2734,  0.4100,  0.2024,  0.2736,  0.3468,
         0.0843,  0.3087,  0.2074,  0.3053,  0.0757,  0.3281,  0.2838,  0.0615,
         0.3421,  0.2551,  0.2038,  0.1728,  0.0993,  0.2920,  0.2490,  0.2248,
         0.1221,  0.3821,  0.2470,  0.2401,  0.1382,  0.1892,  0.2983,  0.2745,
         0.3328,  0.2125,  0.2009,  0.2748,  0.3431,  0.3485,  0.2298,  0.1156,
         0.2207,  0.4214, -0.0183,  0.4200,  0.1754,  0.3374,  0.1324,  0.1431,
         0.2923,  0.2497,  0.2171,  0.1652,  0.1492,  0.1832,  0.2397,  0.2785,
         0.1848,  0.0688,  0.3602,  0.3360,  0.1127])
true tensor([  0.7500,  -2.7000,  -4.9500,  -1.0500,  -3.0000,  -2.7000,  -4.9500,
         -1.0500,   2.7000,  -5.1000, -15.7500,  -1.0500,  -5.1000,  -3.0000,
          8.5500,  -3.0000,   8.5500,   0.7500,  -5.1000, -15.7500,  -3.0000,
        -15.7500,  -3.0000,   8.5500,   0.7500,  -2.7000,  -1.0500,  -5.1000,
         -3.0000,  -3.0000,   8.5500,   0.7500,  -2.7000,  -4.9500,  -1.0500,
         -3.0000,   8.5500,   0.7500,  -3.0000,   8.5500,   0.7500,  -5.1000,
        -15.7500,  -1.0500,  -5.1000,  -3.0000,   8.5500,   0.7500,  -2.7000,
         -5.1000, -15.7500,  -5.1000, -15.7500,  -5.1000, -15.7500,  -5.1000,
        -15.7500, -15.7500,  -5.1000, -15.7500,   8.5500,   0.7500,  -2.7000,
         -4.9500,   8.5500,   0.7500,  -2.7000,  -4.9500,  -5.1000, -15.7500,
         -3.0000,   8.5500,   8.5500,   0.7500,  -2.7000,  -4.9500,   0.7500,
         -2.7000,  -4.9500,  -1.0500, -15.7500,  -3.0000,   8.5500,   0.7500,
         -2.7000])
Epoch: 4, Steps: 1 | Train Loss: 28.2162361 Vali Loss: 54.8097725
lr = 0.0000654543
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
1it [00:00, 11.61it/s]
1it [00:00,  5.46it/s]
1it [00:00, 10.27it/s]
1it [00:00,  5.95it/s]
Epoch: 5 cost time: 0.5307364463806152
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([85])
missing_idx_len: 43
pred tensor([ 0.1547,  0.3123,  0.2590,  0.1655,  0.1886,  0.2333,  0.2080,  0.1482,
         0.2775,  0.1477,  0.2458,  0.2916,  0.1817,  0.2054,  0.1647,  0.1411,
         0.2801,  0.0428,  0.2254,  0.3309,  0.2123,  0.2742, -0.0041,  0.1500,
         0.0379,  0.1578,  0.2849,  0.2032,  0.1063,  0.2876,  0.1431,  0.1446,
         0.3086,  0.1772,  0.1399,  0.2765,  0.2985,  0.2404,  0.0454,  0.0572,
         0.4054,  0.2399,  0.1920,  0.2698,  0.4846,  0.0519,  0.1965,  0.2352,
         0.3224,  0.2736,  0.1316,  0.3808,  0.3644,  0.0999,  0.2463,  0.3305,
         0.1189,  0.1807,  0.1762,  0.3468,  0.0550,  0.1950,  0.2488,  0.3212,
         0.3207,  0.2129,  0.3841,  0.1901,  0.2869,  0.1966,  0.2039,  0.1315,
         0.3401,  0.2578,  0.2281,  0.2457,  0.3604,  0.1105,  0.2839,  0.2266,
         0.2432,  0.1375,  0.0195,  0.1907,  0.0847])
true tensor([  0.7500,  -2.7000,  -4.9500,  -1.0500,  -5.1000, -15.7500,  -3.0000,
          8.5500,   0.7500,  -2.7000,  -4.9500,  -1.0500,   2.7000,  -5.1000,
        -15.7500,   8.5500,   0.7500,  -2.7000,  -4.9500,   8.5500,   0.7500,
         -2.7000,  -4.9500,  -1.0500,  -5.1000,  -3.0000,   8.5500,   0.7500,
         -5.1000, -15.7500,  -5.1000, -15.7500,  -3.0000,   8.5500,   0.7500,
         -2.7000, -15.7500,  -3.0000,   8.5500,  -5.1000, -15.7500,  -5.1000,
        -15.7500,  -3.0000,   8.5500,   0.7500,  -3.0000,  -3.0000,   8.5500,
          0.7500,  -2.7000,  -3.0000,  -1.0500,  -5.1000,   0.7500,  -2.7000,
         -4.9500,  -1.0500, -15.7500,   0.7500,  -2.7000,  -4.9500,  -1.0500,
         -3.0000,   8.5500,  -5.1000, -15.7500,   8.5500,   0.7500,  -2.7000,
         -4.9500,  -5.1000, -15.7500,  -3.0000,   8.5500, -15.7500,  -5.1000,
        -15.7500,  -3.0000,  -3.0000,   8.5500,   0.7500,  -2.7000,  -1.0500,
         -5.1000])
Epoch: 5, Steps: 1 | Train Loss: 28.1373081 Vali Loss: 54.6709213
lr = 0.0000500050
EarlyStopping counter: 2 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 6 cost time: 0.5070681571960449
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([85])
missing_idx_len: 43
pred tensor([0.2309, 0.3576, 0.1954, 0.1363, 0.3111, 0.0984, 0.2131, 0.1392, 0.3609,
        0.2647, 0.2941, 0.1483, 0.1162, 0.4170, 0.3100, 0.0455, 0.1618, 0.1521,
        0.2117, 0.2631, 0.1420, 0.2683, 0.2876, 0.2091, 0.3091, 0.2277, 0.1874,
        0.2007, 0.1869, 0.2885, 0.2979, 0.2885, 0.1777, 0.3857, 0.1961, 0.2321,
        0.3615, 0.1839, 0.2206, 0.2463, 0.0632, 0.3987, 0.2868, 0.1807, 0.2790,
        0.1622, 0.3724, 0.1584, 0.3696, 0.3075, 0.0825, 0.2294, 0.2437, 0.2343,
        0.0469, 0.1738, 0.2462, 0.2038, 0.2050, 0.0629, 0.2632, 0.1373, 0.2228,
        0.2758, 0.2321, 0.3046, 0.1954, 0.3197, 0.3674, 0.0530, 0.0650, 0.2442,
        0.1569, 0.2582, 0.3381, 0.3781, 0.0999, 0.3203, 0.2917, 0.1610, 0.1512,
        0.1860, 0.1428, 0.3019, 0.2000])
true tensor([ -3.0000,  -3.0000,   8.5500,   0.7500,  -3.0000,   8.5500,   0.7500,
         -5.1000, -15.7500,  -3.0000, -15.7500,  -3.0000,   8.5500,   0.7500,
         -3.0000,   8.5500,  -3.0000,   8.5500,   0.7500,  -2.7000,  -5.1000,
        -15.7500,  -5.1000, -15.7500,   8.5500,   0.7500,  -2.7000,  -4.9500,
         -2.7000,  -4.9500,  -1.0500,   2.7000,  -1.0500,  -5.1000,  -1.0500,
         -5.1000,  -3.0000,   8.5500,   0.7500,  -2.7000,  -4.9500,  -1.0500,
          0.7500,  -2.7000,  -4.9500,  -1.0500,  -3.0000,  -5.1000, -15.7500,
         -5.1000, -15.7500,  -1.0500,  -5.1000,  -3.0000,   8.5500,   0.7500,
         -2.7000, -15.7500,  -5.1000, -15.7500, -15.7500,  -5.1000, -15.7500,
         -5.1000, -15.7500,  -5.1000, -15.7500,   8.5500,   0.7500,  -2.7000,
         -4.9500,   8.5500,   0.7500,  -2.7000,  -4.9500,   0.7500,  -2.7000,
         -4.9500,  -1.0500,  -3.0000,   8.5500,  -3.0000,   8.5500,   0.7500,
         -2.7000])
Epoch: 6, Steps: 1 | Train Loss: 28.0883961 Vali Loss: 54.9263458
lr = 0.0000345557
EarlyStopping counter: 3 out of 3
Early stopping
------------------------------------
outputs torch.Size([93, 12, 18])
B 93
L 18
M 18
1it [00:00, 11.80it/s]
1it [00:00, 10.14it/s]
test shape: (1, 258) (1, 258)
test shape: (1, 1, 258) (1, 1, 258)
mae:4.9868, mse:44.4188, rmse:6.6647, r2:-0.9226
mse_mean = 44.4188, mse_std = 0.0000
r2_mean = -0.9226, mae_std = 0.0000