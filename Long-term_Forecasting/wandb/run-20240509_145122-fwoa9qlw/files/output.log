['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
train 337
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
val 43
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
test 93
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (2): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (3): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (4): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (5): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
1it [00:01,  1.11s/it]
0it [00:00, ?it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 1 cost time: 1.3928492069244385
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2780,  0.1857,  0.1749,  0.1575,  0.1493,  0.1644,  0.1354,  0.2054,
         0.1126,  0.2181,  0.3525,  0.1858,  0.1179,  0.2391,  0.4160,  0.0801,
         0.1629,  0.2240,  0.3195,  0.3136,  0.1761,  0.2600,  0.0905,  0.1940,
         0.1385,  0.2800,  0.2270,  0.2442,  0.1758,  0.1344,  0.1564,  0.2459,
         0.2318,  0.3721, -0.0919,  0.2179,  0.2850,  0.3044,  0.0525,  0.3838,
         0.2253,  0.2056,  0.4116,  0.1799,  0.3695,  0.0909,  0.2343,  0.3070,
         0.2989,  0.0620,  0.2396,  0.0919,  0.1524,  0.2994,  0.3013,  0.3025,
         0.3004,  0.1848,  0.2578,  0.2847,  0.1991,  0.3125,  0.2863,  0.1589,
         0.3490,  0.0672,  0.3537,  0.1606,  0.1487,  0.2822,  0.1318,  0.1846,
         0.1533,  0.0396,  0.3551,  0.0462,  0.2565,  0.2601,  0.0353,  0.3514,
         0.3105,  0.2133,  0.3580,  0.2765,  0.2131,  0.3458,  0.2615,  0.1200,
         0.2623,  0.2433,  0.1265,  0.1730,  0.1411,  0.2520,  0.2697,  0.0859,
         0.1561,  0.3618,  0.1868,  0.1947,  0.2654,  0.3312,  0.1677,  0.3025,
         0.2121,  0.0964,  0.1649,  0.1545,  0.1280,  0.2561,  0.2612,  0.3201,
         0.3678,  0.1553,  0.0648,  0.2193,  0.3210,  0.3432,  0.1962,  0.2587,
         0.3965,  0.3367,  0.1715,  0.3842,  0.3109,  0.0964,  0.0067,  0.4028,
         0.1267,  0.1448,  0.1683,  0.2900,  0.1269,  0.1184,  0.1862,  0.3689,
         0.2285,  0.2347,  0.2837,  0.1100,  0.3396,  0.1827,  0.2360,  0.3557,
         0.2308,  0.2527,  0.3303,  0.1103,  0.2011,  0.1922,  0.1933,  0.3109,
         0.2542,  0.1384,  0.2111,  0.2013,  0.2320,  0.0466,  0.2156,  0.1330,
         0.1912,  0.3014,  0.1705,  0.2374,  0.2131,  0.4196, -0.0186,  0.2636,
         0.1433,  0.1889,  0.1733,  0.2963])
true tensor([ 0.7200,  0.5500,  0.6900,  0.8300, -0.2000,  0.1700,  0.4200,  0.5600,
         0.7200, -0.2000,  0.1700,  0.4200,  0.7400,  0.7200, -0.2000,  0.1700,
         0.7400,  0.7400,  0.7200, -0.2000, -0.0100,  0.4200, -0.0600,  0.7200,
         0.6900,  0.8300,  0.5600,  0.1800,  0.5500,  0.6900,  0.8300,  0.5600,
         0.7400,  0.7400,  0.7200, -0.2000,  0.4200,  0.5600, -0.0100,  0.4200,
         0.5600, -0.0100,  0.4200, -0.0600,  0.6900,  0.8300,  0.5600,  0.1800,
         0.1700,  0.4200,  0.5600, -0.0100,  0.7200,  0.5500,  0.6900,  0.8300,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.7200, -0.2000,  0.1700,  0.4200,
         0.6900,  0.8300,  0.5600,  0.1800,  0.4200, -0.0600,  0.7200,  0.5500,
         0.4200,  0.5600, -0.0100,  0.4200,  0.8300,  0.5600,  0.1800,  0.7100,
         0.4200,  0.5600, -0.0100,  0.4200,  0.5500,  0.6900,  0.8300,  0.5600,
        -0.0600,  0.7200,  0.5500,  0.6900, -0.2000,  0.1700,  0.4200,  0.5600,
         0.5500,  0.6900,  0.8300,  0.5600,  0.7400,  0.7400,  0.7200, -0.2000,
         0.5600, -0.0100,  0.4200, -0.0600, -0.0600,  0.7200,  0.5500,  0.6900,
         0.1700,  0.4200,  0.5600, -0.0100,  0.7400,  0.7200, -0.2000,  0.1700,
         0.8300,  0.5600,  0.1800,  0.7100,  0.5600, -0.0100,  0.4200, -0.0600,
        -0.0100,  0.4200, -0.0600,  0.7200,  0.7200,  0.5500,  0.6900,  0.8300,
        -0.0100,  0.4200, -0.0600,  0.7200,  0.4200, -0.0600,  0.7200,  0.5500,
         0.5600,  0.1800,  0.7100,  1.0200,  0.8300,  0.5600,  0.1800,  0.7100,
         0.4200, -0.0600,  0.7200,  0.5500,  0.7200, -0.2000,  0.1700,  0.4200,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.7400,  0.7200, -0.2000,  0.1700,
         0.1700,  0.4200,  0.5600, -0.0100])
Epoch: 1, Steps: 1 | Train Loss: 0.1322019 Vali Loss: 0.1489873
lr = 0.0000975531
1it [00:00, 11.22it/s]
1it [00:00,  6.11it/s]
1it [00:00, 13.04it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 2 cost time: 0.5069723129272461
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([0.1932, 0.1998, 0.2329, 0.2826, 0.1192, 0.3400, 0.1761, 0.3567, 0.4021,
        0.0611, 0.2782, 0.2297, 0.2612, 0.2749, 0.1515, 0.1872, 0.0973, 0.2814,
        0.2173, 0.2019, 0.1504, 0.2755, 0.3670, 0.0826, 0.3455, 0.3247, 0.4287,
        0.2624, 0.3620, 0.0787, 0.2904, 0.1670, 0.1843, 0.2519, 0.0995, 0.2515,
        0.2332, 0.1397, 0.2863, 0.1973, 0.2438, 0.2802, 0.1095, 0.2083, 0.2764,
        0.3013, 0.2245, 0.3049, 0.2424, 0.2401, 0.3060, 0.0939, 0.0990, 0.2328,
        0.2475, 0.1243, 0.1729, 0.1142, 0.2157, 0.1690, 0.1921, 0.1760, 0.2679,
        0.2501, 0.2251, 0.1865, 0.3278, 0.1884, 0.1783, 0.1743, 0.2938, 0.0683,
        0.1783, 0.3237, 0.1487, 0.1527, 0.2591, 0.2334, 0.1657, 0.2424, 0.1898,
        0.3169, 0.2541, 0.1809, 0.1993, 0.1696, 0.2034, 0.1858, 0.2189, 0.2116,
        0.2228, 0.2200, 0.2188, 0.2132, 0.2478, 0.2082, 0.2733, 0.2044, 0.3310,
        0.1273, 0.1495, 0.0977, 0.2807, 0.0357, 0.4528, 0.4214, 0.2539, 0.1321,
        0.1197, 0.1882, 0.1920, 0.1303, 0.1452, 0.0057, 0.3501, 0.0964, 0.3480,
        0.3160, 0.2271, 0.3134, 0.3320, 0.3569, 0.2085, 0.0713, 0.3302, 0.1989,
        0.0569, 0.1947, 0.1657, 0.2832, 0.1080, 0.3666, 0.1310, 0.0860, 0.2838,
        0.2132, 0.2618, 0.2031, 0.4142, 0.1083, 0.2241, 0.1536, 0.2307, 0.3160,
        0.0880, 0.1695, 0.2893, 0.2396, 0.3096, 0.1639, 0.3206, 0.2252, 0.2164,
        0.1621, 0.1163, 0.3967, 0.4710, 0.1261, 0.2179, 0.2764, 0.1981, 0.1406,
        0.2750, 0.0520, 0.2637, 0.1486, 0.1749, 0.3009, 0.3181, 0.0962, 0.3774,
        0.3205])
true tensor([ 0.4200, -0.0600,  0.7200,  0.5500,  0.7200,  0.5500,  0.6900,  0.8300,
         0.7400,  0.7200, -0.2000,  0.1700, -0.0100,  0.4200, -0.0600,  0.7200,
         0.7200, -0.2000,  0.1700,  0.4200,  0.8300,  0.5600,  0.1800,  0.7100,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.5500,  0.6900,  0.8300,  0.5600,
         0.4200, -0.0600,  0.7200,  0.5500,  0.1700,  0.4200,  0.5600, -0.0100,
         0.7400,  0.7400,  0.7200, -0.2000,  0.8300,  0.5600,  0.1800,  0.7100,
        -0.2000,  0.1700,  0.4200,  0.5600, -0.2000,  0.1700,  0.4200,  0.5600,
         0.7200, -0.2000,  0.1700,  0.4200,  0.4200,  0.5600, -0.0100,  0.4200,
         0.5500,  0.6900,  0.8300,  0.5600,  0.7400,  0.7200, -0.2000,  0.1700,
         0.6900,  0.8300,  0.5600,  0.1800,  0.5600,  0.1800,  0.7100,  1.0200,
         0.7400,  0.7400,  0.7200, -0.2000,  0.6900,  0.8300,  0.5600,  0.1800,
         0.5600, -0.0100,  0.4200, -0.0600,  0.6900,  0.8300,  0.5600,  0.1800,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.5600, -0.0100,  0.4200, -0.0600,
         0.8300,  0.5600,  0.1800,  0.7100,  0.5500,  0.6900,  0.8300,  0.5600,
         0.5600, -0.0100,  0.4200, -0.0600,  0.4200, -0.0600,  0.7200,  0.5500,
         0.4200,  0.5600, -0.0100,  0.4200,  0.7200,  0.5500,  0.6900,  0.8300,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.7400,  0.7200, -0.2000,  0.1700,
         0.7200,  0.5500,  0.6900,  0.8300,  0.1700,  0.4200,  0.5600, -0.0100,
        -0.2000,  0.1700,  0.4200,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,
         0.7400,  0.7400,  0.7200, -0.2000,  0.7200, -0.2000,  0.1700,  0.4200,
         0.4200,  0.5600, -0.0100,  0.4200, -0.0100,  0.4200, -0.0600,  0.7200,
         0.1700,  0.4200,  0.5600, -0.0100])
Epoch: 2, Steps: 1 | Train Loss: 0.1349806 Vali Loss: 0.1506223
lr = 0.0000904518
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 3 cost time: 0.48775649070739746
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2313,  0.2122,  0.2043,  0.0076,  0.2800, -0.0585,  0.3244,  0.2787,
         0.2604,  0.2565,  0.2862,  0.1311,  0.2533,  0.2027,  0.2513,  0.1766,
         0.2304,  0.3157,  0.1350,  0.2926,  0.2059,  0.3239,  0.2943,  0.1473,
        -0.0258,  0.1374,  0.1593,  0.3978,  0.2523,  0.0041,  0.2103,  0.3308,
         0.1165,  0.2125,  0.2051,  0.2092,  0.2263,  0.0657,  0.2742,  0.0875,
         0.1027,  0.1937,  0.2792,  0.3136,  0.2755,  0.2547,  0.1634,  0.1165,
         0.1996,  0.2695,  0.1803,  0.1087,  0.2153,  0.1521,  0.2593,  0.0756,
         0.2836,  0.2804,  0.3401,  0.1460,  0.1434,  0.2896,  0.2272,  0.1879,
         0.2429,  0.3027,  0.0380,  0.3962,  0.2683,  0.0802,  0.1060,  0.1835,
         0.2335,  0.0749,  0.2338,  0.1749,  0.1136,  0.1467,  0.2156,  0.3630,
         0.2954,  0.4228,  0.2312,  0.1417,  0.1431,  0.2265,  0.3730,  0.2033,
         0.3765,  0.2126,  0.1423,  0.1896,  0.3303,  0.1939,  0.1695,  0.3803,
         0.1227,  0.3512,  0.4318, -0.0679,  0.2244,  0.1442,  0.1309,  0.2001,
         0.0548,  0.3055,  0.1119,  0.1276,  0.2088,  0.1514,  0.1782,  0.2841,
         0.2081,  0.1339,  0.1669,  0.2720,  0.1685,  0.1467,  0.3618,  0.1670,
         0.3097,  0.1256,  0.2425,  0.0635,  0.1500,  0.2585,  0.2455,  0.3165,
         0.2505,  0.0217,  0.4619,  0.1380,  0.1784,  0.1666,  0.2736,  0.2506,
         0.3465,  0.2531,  0.3696,  0.2586,  0.3236,  0.2118,  0.3538,  0.1944,
         0.1751,  0.2766,  0.0951,  0.2637,  0.1793,  0.1803,  0.1853,  0.2494,
         0.3154,  0.2503,  0.2566,  0.0994,  0.0845,  0.1489,  0.2017,  0.2560,
         0.2945,  0.1153,  0.2345,  0.0966,  0.1626,  0.2423,  0.1607,  0.2995,
         0.1244,  0.1770,  0.2784,  0.0466])
true tensor([-0.0100,  0.4200, -0.0600,  0.7200,  0.5500,  0.6900,  0.8300,  0.5600,
         0.7200,  0.5500,  0.6900,  0.8300, -0.0600,  0.7200,  0.5500,  0.6900,
         0.7200, -0.2000,  0.1700,  0.4200, -0.0600,  0.7200,  0.5500,  0.6900,
         0.1700,  0.4200,  0.5600, -0.0100,  0.7400,  0.7200, -0.2000,  0.1700,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.7400,  0.7400,  0.7200, -0.2000,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.4200,  0.5600, -0.0100,  0.4200,
         0.1700,  0.4200,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,  0.5500,
         0.6900,  0.8300,  0.5600,  0.1800,  0.7200, -0.2000,  0.1700,  0.4200,
         0.5600,  0.1800,  0.7100,  1.0200,  0.8300,  0.5600,  0.1800,  0.7100,
         0.6900,  0.8300,  0.5600,  0.1800,  0.4200,  0.5600, -0.0100,  0.4200,
         0.7200,  0.5500,  0.6900,  0.8300,  0.5600, -0.0100,  0.4200, -0.0600,
         0.5500,  0.6900,  0.8300,  0.5600,  0.7200, -0.2000,  0.1700,  0.4200,
         0.1700,  0.4200,  0.5600, -0.0100,  0.5600, -0.0100,  0.4200, -0.0600,
         0.5500,  0.6900,  0.8300,  0.5600,  0.7200,  0.5500,  0.6900,  0.8300,
         0.5600, -0.0100,  0.4200, -0.0600,  0.8300,  0.5600,  0.1800,  0.7100,
         0.4200, -0.0600,  0.7200,  0.5500,  0.8300,  0.5600,  0.1800,  0.7100,
         0.4200,  0.5600, -0.0100,  0.4200,  0.7400,  0.7200, -0.2000,  0.1700,
        -0.2000,  0.1700,  0.4200,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,
         0.6900,  0.8300,  0.5600,  0.1800, -0.2000,  0.1700,  0.4200,  0.5600,
         0.7400,  0.7200, -0.2000,  0.1700,  0.7400,  0.7400,  0.7200, -0.2000,
        -0.0100,  0.4200, -0.0600,  0.7200,  0.4200, -0.0600,  0.7200,  0.5500,
         0.7400,  0.7400,  0.7200, -0.2000])
Epoch: 3, Steps: 1 | Train Loss: 0.1341274 Vali Loss: 0.1599455
lr = 0.0000793913
EarlyStopping counter: 2 out of 3
1it [00:00,  6.20it/s]
1it [00:00, 11.82it/s]
1it [00:00,  6.34it/s]
1it [00:00, 12.71it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 4 cost time: 0.4873199462890625
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2369,  0.2459,  0.2613,  0.1886,  0.1316,  0.2922,  0.2542,  0.3485,
         0.2638,  0.2347,  0.2652,  0.1431,  0.1687,  0.3064,  0.2332,  0.2269,
         0.0728,  0.3154,  0.2468,  0.2974,  0.1846,  0.2119,  0.3100,  0.2715,
         0.1959,  0.5009,  0.1629,  0.2449,  0.1935,  0.1132,  0.2556,  0.2526,
         0.2692,  0.2006,  0.2467,  0.3591,  0.2464, -0.0151,  0.3291,  0.2930,
         0.1997,  0.2570,  0.2221,  0.1888,  0.3061,  0.1192, -0.0333,  0.4114,
         0.2868,  0.2666,  0.2336,  0.1851,  0.1602,  0.2333,  0.2940,  0.2331,
         0.1669,  0.1459,  0.1202,  0.3111,  0.1711,  0.2764,  0.2071,  0.2815,
         0.2778,  0.1751,  0.2311,  0.3260,  0.2661,  0.2213,  0.3204,  0.2719,
         0.2826,  0.2631,  0.1666,  0.3519,  0.1722,  0.3925,  0.2461,  0.1598,
         0.1577,  0.1998,  0.1286,  0.2613,  0.2797,  0.0938,  0.1977,  0.2108,
         0.3657,  0.0449,  0.2626,  0.2301,  0.2081,  0.3421,  0.1271,  0.2997,
         0.2767,  0.3314,  0.1349,  0.2649,  0.2896,  0.1848,  0.2080,  0.3639,
         0.1897,  0.3331,  0.3180,  0.0917,  0.2054,  0.2711,  0.2500,  0.0966,
         0.3521,  0.3642,  0.2838,  0.1679,  0.2273,  0.2514,  0.2511,  0.2802,
         0.3715,  0.2229,  0.1252,  0.1257,  0.1542,  0.3099,  0.1084,  0.2847,
         0.1947,  0.2454,  0.3366,  0.2781,  0.2691,  0.0465,  0.2876,  0.2525,
         0.1833,  0.2436,  0.3082,  0.1031,  0.2521,  0.2699,  0.2610,  0.2251,
         0.0872,  0.4385,  0.0065,  0.4215,  0.1955,  0.2112,  0.1770,  0.3269,
         0.0975,  0.3458,  0.1629,  0.1314,  0.3333,  0.1813,  0.2306,  0.1389,
         0.0950,  0.2394,  0.2578,  0.2025,  0.1790,  0.2293,  0.3584,  0.2834,
         0.2513,  0.2263,  0.3436,  0.2525])
true tensor([ 0.8300,  0.5600,  0.1800,  0.7100,  0.4200, -0.0600,  0.7200,  0.5500,
        -0.0100,  0.4200, -0.0600,  0.7200,  0.4200,  0.5600, -0.0100,  0.4200,
         0.5600,  0.1800,  0.7100,  1.0200, -0.2000,  0.1700,  0.4200,  0.5600,
         0.4200,  0.5600, -0.0100,  0.4200,  0.7400,  0.7400,  0.7200, -0.2000,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.7200,  0.5500,  0.6900,  0.8300,
         0.7400,  0.7200, -0.2000,  0.1700,  0.4200, -0.0600,  0.7200,  0.5500,
         0.1700,  0.4200,  0.5600, -0.0100,  0.5600, -0.0100,  0.4200, -0.0600,
         0.5500,  0.6900,  0.8300,  0.5600,  0.5600, -0.0100,  0.4200, -0.0600,
         0.5600, -0.0100,  0.4200, -0.0600,  0.7400,  0.7400,  0.7200, -0.2000,
         0.4200, -0.0600,  0.7200,  0.5500,  0.4200,  0.5600, -0.0100,  0.4200,
        -0.0100,  0.4200, -0.0600,  0.7200, -0.0600,  0.7200,  0.5500,  0.6900,
         0.8300,  0.5600,  0.1800,  0.7100,  0.7200,  0.5500,  0.6900,  0.8300,
         0.7200,  0.5500,  0.6900,  0.8300, -0.2000,  0.1700,  0.4200,  0.5600,
         0.7400,  0.7400,  0.7200, -0.2000,  0.5500,  0.6900,  0.8300,  0.5600,
         0.7200, -0.2000,  0.1700,  0.4200, -0.0100,  0.4200, -0.0600,  0.7200,
         0.7200, -0.2000,  0.1700,  0.4200,  0.7400,  0.7200, -0.2000,  0.1700,
         0.7200, -0.2000,  0.1700,  0.4200,  0.1700,  0.4200,  0.5600, -0.0100,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.6900,  0.8300,  0.5600,  0.1800,
         0.6900,  0.8300,  0.5600,  0.1800,  0.7400,  0.7200, -0.2000,  0.1700,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.6900,  0.8300,  0.5600,  0.1800,
         0.8300,  0.5600,  0.1800,  0.7100,  0.1700,  0.4200,  0.5600, -0.0100,
         0.5500,  0.6900,  0.8300,  0.5600])
Epoch: 4, Steps: 1 | Train Loss: 0.1278108 Vali Loss: 0.1448466
lr = 0.0000654543
Validation loss decreased (0.148987 --> 0.144847).  Saving model ...
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
1it [00:00,  6.13it/s]
1it [00:00, 11.12it/s]
Epoch: 5 cost time: 0.5050125122070312
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([0.2607, 0.2737, 0.2476, 0.1135, 0.1573, 0.3444, 0.2844, 0.0607, 0.2194,
        0.2370, 0.2253, 0.2103, 0.2289, 0.2494, 0.1776, 0.1610, 0.1313, 0.2672,
        0.2732, 0.1311, 0.2848, 0.2379, 0.1503, 0.3288, 0.1860, 0.2538, 0.0375,
        0.2310, 0.2558, 0.0458, 0.1087, 0.3481, 0.3651, 0.1714, 0.2913, 0.1290,
        0.1706, 0.2399, 0.3136, 0.0507, 0.2724, 0.1747, 0.2670, 0.2311, 0.2786,
        0.3254, 0.0817, 0.3273, 0.3474, 0.1032, 0.1072, 0.3039, 0.2426, 0.1543,
        0.1206, 0.0457, 0.3681, 0.2466, 0.1638, 0.2328, 0.2327, 0.2423, 0.1377,
        0.1218, 0.3553, 0.2678, 0.3376, 0.1725, 0.2597, 0.3420, 0.2699, 0.1469,
        0.2382, 0.2931, 0.2817, 0.3162, 0.2655, 0.3301, 0.1195, 0.2152, 0.3286,
        0.2275, 0.3030, 0.2274, 0.0374, 0.3974, 0.0364, 0.2470, 0.1921, 0.2271,
        0.2744, 0.0643, 0.1585, 0.2025, 0.4137, 0.0773, 0.1882, 0.1857, 0.3555,
        0.3409, 0.2140, 0.3300, 0.3125, 0.1903, 0.2109, 0.1930, 0.0787, 0.2929,
        0.3729, 0.1334, 0.1738, 0.1158, 0.2393, 0.3553, 0.0778, 0.2105, 0.3139,
        0.1585, 0.3108, 0.1338, 0.1357, 0.3620, 0.1465, 0.2966, 0.2458, 0.1060,
        0.2610, 0.2947, 0.2419, 0.1777, 0.4480, 0.3382, 0.1131, 0.1889, 0.2022,
        0.3404, 0.1983, 0.2313, 0.2237, 0.2110, 0.0953, 0.1996, 0.1199, 0.3137,
        0.2286, 0.1260, 0.2649, 0.1912, 0.2607, 0.3040, 0.2740, 0.1455, 0.0787,
        0.3776, 0.1793, 0.3341, 0.2119, 0.1216, 0.1590, 0.2403, 0.2706, 0.2608,
        0.1992, 0.1285, 0.1659, 0.2917, 0.1140, 0.3573, 0.1847, 0.2169, 0.2677,
        0.1014])
true tensor([ 0.5600, -0.0100,  0.4200, -0.0600,  0.8300,  0.5600,  0.1800,  0.7100,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.7200,  0.5500,  0.6900,  0.8300,
         0.5600,  0.1800,  0.7100,  1.0200,  0.7200, -0.2000,  0.1700,  0.4200,
         0.6900,  0.8300,  0.5600,  0.1800,  0.5600, -0.0100,  0.4200, -0.0600,
         0.6900,  0.8300,  0.5600,  0.1800,  0.7400,  0.7400,  0.7200, -0.2000,
         0.7200,  0.5500,  0.6900,  0.8300,  0.7400,  0.7200, -0.2000,  0.1700,
         0.7200, -0.2000,  0.1700,  0.4200,  0.5600, -0.0100,  0.4200, -0.0600,
         0.5500,  0.6900,  0.8300,  0.5600,  0.4200,  0.5600, -0.0100,  0.4200,
         0.1700,  0.4200,  0.5600, -0.0100, -0.0600,  0.7200,  0.5500,  0.6900,
        -0.0100,  0.4200, -0.0600,  0.7200,  0.4200,  0.5600, -0.0100,  0.4200,
         0.4200,  0.5600, -0.0100,  0.4200, -0.2000,  0.1700,  0.4200,  0.5600,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.7200,  0.5500,  0.6900,  0.8300,
         0.4200, -0.0600,  0.7200,  0.5500,  0.5500,  0.6900,  0.8300,  0.5600,
         0.4200, -0.0600,  0.7200,  0.5500,  0.7400,  0.7400,  0.7200, -0.2000,
         0.8300,  0.5600,  0.1800,  0.7100, -0.0100,  0.4200, -0.0600,  0.7200,
         0.1700,  0.4200,  0.5600, -0.0100,  0.8300,  0.5600,  0.1800,  0.7100,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.7400,  0.7200, -0.2000,  0.1700,
         0.6900,  0.8300,  0.5600,  0.1800,  0.7400,  0.7200, -0.2000,  0.1700,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.1700,  0.4200,  0.5600, -0.0100,
         0.7200, -0.2000,  0.1700,  0.4200,  0.4200, -0.0600,  0.7200,  0.5500,
         0.5500,  0.6900,  0.8300,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,
         0.7400,  0.7400,  0.7200, -0.2000])
Epoch: 5, Steps: 1 | Train Loss: 0.1313660 Vali Loss: 0.1433736
lr = 0.0000500050
Validation loss decreased (0.144847 --> 0.143374).  Saving model ...
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 6 cost time: 0.5006859302520752
1it [00:00,  6.45it/s]
1it [00:00, 11.79it/s]
1it [00:00,  6.04it/s]
1it [00:00, 11.41it/s]
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.3194,  0.1189,  0.3375,  0.2422,  0.2942,  0.4224,  0.2140,  0.1396,
         0.2203,  0.2938,  0.1088,  0.2334,  0.2643,  0.1077,  0.3927,  0.1960,
         0.2356,  0.3590,  0.1705,  0.3704,  0.3263,  0.1864,  0.3426,  0.1565,
         0.0813,  0.2022,  0.2468,  0.3485,  0.2389,  0.2690,  0.0669,  0.3360,
         0.2440,  0.2376,  0.0133,  0.3114,  0.2223,  0.2939,  0.2971,  0.1721,
         0.1818,  0.2458,  0.2664,  0.3237,  0.1348,  0.2284,  0.2557,  0.2073,
         0.1279,  0.2700,  0.2905,  0.1106,  0.1665,  0.2274,  0.1286,  0.2064,
         0.4603,  0.3303,  0.4039,  0.2568,  0.2801,  0.1935,  0.3112,  0.3046,
         0.2275,  0.2303,  0.2706,  0.2890,  0.2536,  0.1357,  0.2434,  0.1371,
         0.2217,  0.1971,  0.3609,  0.3281,  0.1841,  0.2310,  0.1333,  0.2258,
         0.3344,  0.1167,  0.4209,  0.1449,  0.2104,  0.2223,  0.0602,  0.3827,
         0.2990,  0.2461,  0.2965,  0.1914,  0.2313,  0.2215,  0.1312,  0.3719,
         0.3762,  0.2488,  0.2557,  0.2292,  0.2032,  0.1864,  0.1997,  0.1546,
         0.2812,  0.1212,  0.1035,  0.3818,  0.1853,  0.3765, -0.0627,  0.0757,
         0.2217,  0.0727,  0.2231,  0.1940,  0.1127,  0.0853,  0.2036,  0.3838,
         0.1902,  0.2884,  0.3430,  0.1216,  0.1780,  0.0966,  0.2878,  0.2119,
         0.3098,  0.1722,  0.2664, -0.0178,  0.2148,  0.2130,  0.2076,  0.2147,
         0.2867,  0.3246,  0.1426,  0.2417,  0.2717,  0.3532,  0.2840,  0.2079,
         0.2039,  0.3174,  0.2564,  0.2221,  0.2929,  0.3110,  0.1036,  0.1576,
         0.2766,  0.1496,  0.2852,  0.2976,  0.1753,  0.2916,  0.0655,  0.2619,
         0.3239,  0.2395,  0.2248,  0.4437,  0.2979,  0.2288,  0.2345,  0.1298,
         0.1112,  0.2221,  0.3378,  0.1515])
true tensor([ 0.4200, -0.0600,  0.7200,  0.5500,  0.7200,  0.5500,  0.6900,  0.8300,
         0.7200,  0.5500,  0.6900,  0.8300,  0.7200, -0.2000,  0.1700,  0.4200,
         0.5600, -0.0100,  0.4200, -0.0600, -0.0100,  0.4200, -0.0600,  0.7200,
         0.4200, -0.0600,  0.7200,  0.5500,  0.1700,  0.4200,  0.5600, -0.0100,
         0.7200,  0.5500,  0.6900,  0.8300, -0.0600,  0.7200,  0.5500,  0.6900,
         0.5500,  0.6900,  0.8300,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.4200,  0.5600, -0.0100,  0.4200,
         0.7200, -0.2000,  0.1700,  0.4200,  0.6900,  0.8300,  0.5600,  0.1800,
         0.5600,  0.1800,  0.7100,  1.0200,  0.4200,  0.5600, -0.0100,  0.4200,
         0.7400,  0.7400,  0.7200, -0.2000,  0.7400,  0.7400,  0.7200, -0.2000,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.8300,  0.5600,  0.1800,  0.7100,
         0.8300,  0.5600,  0.1800,  0.7100,  0.4200, -0.0600,  0.7200,  0.5500,
         0.7400,  0.7200, -0.2000,  0.1700,  0.5600, -0.0100,  0.4200, -0.0600,
        -0.2000,  0.1700,  0.4200,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,
         0.7400,  0.7400,  0.7200, -0.2000,  0.5500,  0.6900,  0.8300,  0.5600,
         0.1700,  0.4200,  0.5600, -0.0100, -0.2000,  0.1700,  0.4200,  0.5600,
         0.1700,  0.4200,  0.5600, -0.0100,  0.7200, -0.2000,  0.1700,  0.4200,
         0.4200,  0.5600, -0.0100,  0.4200,  0.7400,  0.7200, -0.2000,  0.1700,
         0.7400,  0.7200, -0.2000,  0.1700,  0.6900,  0.8300,  0.5600,  0.1800,
         0.6900,  0.8300,  0.5600,  0.1800,  0.5600, -0.0100,  0.4200, -0.0600,
         0.8300,  0.5600,  0.1800,  0.7100, -0.0600,  0.7200,  0.5500,  0.6900,
         0.5500,  0.6900,  0.8300,  0.5600])
Epoch: 6, Steps: 1 | Train Loss: 0.1281573 Vali Loss: 0.1444973
lr = 0.0000345557
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 7 cost time: 0.5006065368652344
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.1519,  0.2374,  0.2388,  0.2584,  0.2146,  0.2695,  0.2700,  0.0955,
         0.3363,  0.2277,  0.2651,  0.2271,  0.1467,  0.1214,  0.2593,  0.2056,
         0.2326,  0.0653,  0.1509,  0.3775,  0.2626,  0.2132,  0.2261,  0.0643,
         0.2612,  0.1946,  0.2497,  0.1918,  0.1673,  0.2088,  0.2704,  0.1364,
         0.1787,  0.2072,  0.0689,  0.1183,  0.2418,  0.2596,  0.1922,  0.3694,
         0.2537,  0.2838,  0.1131,  0.3560,  0.1363,  0.3053,  0.1462,  0.2505,
         0.2405,  0.2569,  0.0980,  0.2381,  0.3182,  0.3655,  0.3472,  0.2585,
         0.3347,  0.1603,  0.2591,  0.1229,  0.1464,  0.3199,  0.2340,  0.2217,
         0.0093,  0.3297,  0.2511,  0.3373,  0.3150,  0.1765,  0.1406,  0.3638,
         0.3447,  0.1575,  0.1231,  0.2411,  0.2664,  0.1795,  0.0997,  0.1067,
         0.2949,  0.3126,  0.2022,  0.2111,  0.4672,  0.2906,  0.4068, -0.0945,
         0.2394,  0.3017,  0.2846,  0.1838,  0.2698,  0.1571,  0.3989,  0.2609,
         0.2634,  0.1765,  0.1893,  0.1011,  0.0981,  0.2907,  0.1937,  0.2359,
         0.1173,  0.3248,  0.2664,  0.2169,  0.1963,  0.2283,  0.1937,  0.2789,
         0.1764,  0.3545,  0.3536,  0.0849,  0.1574,  0.5244,  0.0656,  0.3130,
         0.2123,  0.1516,  0.1400,  0.2887,  0.2777,  0.1877,  0.3501,  0.2743,
         0.3013,  0.2670,  0.2190,  0.2508,  0.0816,  0.2431,  0.3076,  0.3658,
         0.3084,  0.0962,  0.3291,  0.2461,  0.2641,  0.2809,  0.3176,  0.0790,
         0.1984,  0.2261,  0.1608,  0.1300,  0.2464,  0.1895,  0.2770,  0.2117,
         0.3798,  0.2302,  0.2130,  0.1833,  0.1867,  0.2258,  0.2386,  0.1088,
         0.2483,  0.2995,  0.2857,  0.1413,  0.3571,  0.1734,  0.2627,  0.3091,
         0.0703,  0.1595,  0.3780,  0.1658])
true tensor([ 0.4200,  0.5600, -0.0100,  0.4200,  0.1700,  0.4200,  0.5600, -0.0100,
         0.6900,  0.8300,  0.5600,  0.1800,  0.4200,  0.5600, -0.0100,  0.4200,
         0.7200,  0.5500,  0.6900,  0.8300, -0.0600,  0.7200,  0.5500,  0.6900,
         0.7400,  0.7400,  0.7200, -0.2000,  0.4200, -0.0600,  0.7200,  0.5500,
         0.6900,  0.8300,  0.5600,  0.1800, -0.0100,  0.4200, -0.0600,  0.7200,
        -0.2000,  0.1700,  0.4200,  0.5600, -0.0600,  0.7200,  0.5500,  0.6900,
         0.7400,  0.7200, -0.2000,  0.1700, -0.2000,  0.1700,  0.4200,  0.5600,
         0.7400,  0.7200, -0.2000,  0.1700,  0.8300,  0.5600,  0.1800,  0.7100,
         0.7200, -0.2000,  0.1700,  0.4200,  0.7200,  0.5500,  0.6900,  0.8300,
         0.5500,  0.6900,  0.8300,  0.5600,  0.5600, -0.0100,  0.4200, -0.0600,
         0.6900,  0.8300,  0.5600,  0.1800, -0.0600,  0.7200,  0.5500,  0.6900,
         0.5600,  0.1800,  0.7100,  1.0200, -0.2000,  0.1700,  0.4200,  0.5600,
         0.1700,  0.4200,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,  0.5500,
         0.5500,  0.6900,  0.8300,  0.5600,  0.7200, -0.2000,  0.1700,  0.4200,
         0.1700,  0.4200,  0.5600, -0.0100,  0.7200,  0.5500,  0.6900,  0.8300,
         0.4200,  0.5600, -0.0100,  0.4200,  0.8300,  0.5600,  0.1800,  0.7100,
         0.4200, -0.0600,  0.7200,  0.5500,  0.5500,  0.6900,  0.8300,  0.5600,
         0.5600, -0.0100,  0.4200, -0.0600, -0.0100,  0.4200, -0.0600,  0.7200,
         0.7400,  0.7200, -0.2000,  0.1700,  0.7200, -0.2000,  0.1700,  0.4200,
        -0.0100,  0.4200, -0.0600,  0.7200,  0.7400,  0.7400,  0.7200, -0.2000,
         0.7400,  0.7400,  0.7200, -0.2000,  0.8300,  0.5600,  0.1800,  0.7100,
         0.5600, -0.0100,  0.4200, -0.0600])
Epoch: 7, Steps: 1 | Train Loss: 0.1288938 Vali Loss: 0.1454387
lr = 0.0000206187
EarlyStopping counter: 2 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 8 cost time: 0.5126347541809082
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2416,  0.3228,  0.4498,  0.3741,  0.2095,  0.3329,  0.3525,  0.1929,
         0.3836,  0.1419,  0.1272,  0.2677,  0.4133,  0.1233,  0.1208,  0.2739,
         0.3916,  0.1811,  0.1713,  0.3757,  0.1402,  0.1827,  0.3834,  0.2463,
         0.0588,  0.3086,  0.0982,  0.1853,  0.1052,  0.3066,  0.3357,  0.3557,
         0.1799,  0.2142,  0.2691,  0.3511,  0.1963,  0.3284,  0.1809,  0.2962,
         0.2963,  0.1474,  0.1700,  0.3181,  0.2603,  0.1532,  0.2011,  0.2450,
         0.2840,  0.2186,  0.4007,  0.2853,  0.2091,  0.1931,  0.2221,  0.2117,
         0.2357,  0.1195,  0.2376,  0.1608,  0.1994,  0.2417,  0.0604,  0.3555,
         0.2098,  0.1639,  0.2009,  0.2699,  0.3049,  0.1933,  0.2148,  0.1588,
         0.3646,  0.2136,  0.2810,  0.2703,  0.1485,  0.2885,  0.3136,  0.4324,
         0.1993,  0.4455,  0.2272,  0.1922,  0.2103,  0.3236,  0.1834,  0.2324,
         0.2182,  0.1227,  0.1424,  0.1588,  0.3107, -0.0828,  0.4491,  0.0562,
         0.2271,  0.2798,  0.2198,  0.2728,  0.2253,  0.2162,  0.0882,  0.0613,
         0.2724,  0.2397,  0.1882,  0.2561,  0.2491,  0.3710,  0.2609,  0.2050,
         0.2601,  0.2175,  0.1774,  0.2215,  0.1545,  0.2575,  0.3313,  0.2572,
         0.1864,  0.1185,  0.1584,  0.3059,  0.2616,  0.2460,  0.0602,  0.3362,
         0.0569,  0.1637,  0.2508,  0.1785,  0.2332,  0.2649,  0.2902,  0.3034,
         0.1586,  0.3839,  0.3392,  0.0405,  0.2376,  0.3974,  0.0697,  0.3493,
         0.2363,  0.1756,  0.1962,  0.2396,  0.3579,  0.0779,  0.3698,  0.1755,
         0.1647,  0.2624,  0.3432,  0.2429,  0.3764,  0.2827,  0.0618,  0.4048,
         0.1813,  0.3462,  0.2794,  0.3296,  0.3211,  0.1329,  0.2300,  0.3105,
         0.3444,  0.1710,  0.1440,  0.3687])
true tensor([ 0.4200,  0.5600, -0.0100,  0.4200,  0.5600,  0.1800,  0.7100,  1.0200,
         0.7400,  0.7400,  0.7200, -0.2000,  0.7200,  0.5500,  0.6900,  0.8300,
        -0.0600,  0.7200,  0.5500,  0.6900, -0.2000,  0.1700,  0.4200,  0.5600,
         0.4200,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,  0.5500,  0.6900,
         0.8300,  0.5600,  0.1800,  0.7100,  0.5600, -0.0100,  0.4200, -0.0600,
         0.7200, -0.2000,  0.1700,  0.4200,  0.6900,  0.8300,  0.5600,  0.1800,
        -0.0100,  0.4200, -0.0600,  0.7200,  0.5600, -0.0100,  0.4200, -0.0600,
         0.1700,  0.4200,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,  0.5500,
         0.7200, -0.2000,  0.1700,  0.4200,  0.5500,  0.6900,  0.8300,  0.5600,
         0.5600, -0.0100,  0.4200, -0.0600,  0.7400,  0.7200, -0.2000,  0.1700,
         0.7400,  0.7400,  0.7200, -0.2000,  0.8300,  0.5600,  0.1800,  0.7100,
         0.7400,  0.7200, -0.2000,  0.1700, -0.0100,  0.4200, -0.0600,  0.7200,
         0.6900,  0.8300,  0.5600,  0.1800,  0.1700,  0.4200,  0.5600, -0.0100,
         0.7200, -0.2000,  0.1700,  0.4200,  0.8300,  0.5600,  0.1800,  0.7100,
         0.1700,  0.4200,  0.5600, -0.0100,  0.5500,  0.6900,  0.8300,  0.5600,
         0.4200, -0.0600,  0.7200,  0.5500,  0.7200,  0.5500,  0.6900,  0.8300,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.6900,  0.8300,  0.5600,  0.1800,
         0.7400,  0.7400,  0.7200, -0.2000,  0.7400,  0.7200, -0.2000,  0.1700,
        -0.0100,  0.4200, -0.0600,  0.7200,  0.5500,  0.6900,  0.8300,  0.5600,
        -0.0600,  0.7200,  0.5500,  0.6900, -0.2000,  0.1700,  0.4200,  0.5600,
         0.4200, -0.0600,  0.7200,  0.5500,  0.7200,  0.5500,  0.6900,  0.8300,
         0.4200,  0.5600, -0.0100,  0.4200])
Epoch: 8, Steps: 1 | Train Loss: 0.1270030 Vali Loss: 0.1405255
lr = 0.0000095582
Validation loss decreased (0.143374 --> 0.140525).  Saving model ...
1it [00:00,  5.65it/s]
1it [00:00, 11.52it/s]
0it [00:00, ?it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 9 cost time: 0.5085353851318359
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([0.1352, 0.2367, 0.2697, 0.0758, 0.2597, 0.1961, 0.0383, 0.2789, 0.2376,
        0.2664, 0.3371, 0.3026, 0.1757, 0.1361, 0.2836, 0.3555, 0.1657, 0.2718,
        0.4309, 0.2943, 0.1881, 0.1399, 0.2500, 0.3497, 0.3883, 0.1203, 0.1644,
        0.2751, 0.2046, 0.2496, 0.2455, 0.2630, 0.2463, 0.2417, 0.1952, 0.2667,
        0.1937, 0.2510, 0.0654, 0.1621, 0.1328, 0.3079, 0.1274, 0.2775, 0.1136,
        0.2709, 0.2947, 0.1359, 0.2155, 0.0150, 0.3102, 0.1758, 0.1536, 0.3077,
        0.2691, 0.3565, 0.2181, 0.2369, 0.3591, 0.2983, 0.1334, 0.2819, 0.2563,
        0.2539, 0.2888, 0.1023, 0.4137, 0.2388, 0.4156, 0.2277, 0.2184, 0.2220,
        0.1716, 0.2746, 0.2903, 0.3599, 0.1448, 0.1987, 0.1755, 0.0952, 0.2096,
        0.1409, 0.2145, 0.2157, 0.2748, 0.2340, 0.3800, 0.1313, 0.2418, 0.1684,
        0.1654, 0.1772, 0.1862, 0.1800, 0.2058, 0.2235, 0.3431, 0.1675, 0.2557,
        0.2358, 0.2074, 0.1451, 0.2036, 0.1293, 0.2208, 0.1044, 0.2493, 0.1043,
        0.3081, 0.3471, 0.1162, 0.1792, 0.1314, 0.1238, 0.2205, 0.2448, 0.3107,
        0.2611, 0.2745, 0.1664, 0.0661, 0.5025, 0.2685, 0.2178, 0.2681, 0.1438,
        0.3821, 0.2378, 0.1330, 0.1626, 0.2753, 0.2153, 0.3092, 0.3641, 0.0420,
        0.2954, 0.2046, 0.0471, 0.1740, 0.2226, 0.1894, 0.3512, 0.2495, 0.0698,
        0.1886, 0.1355, 0.1756, 0.1626, 0.2940, 0.4444, 0.3419, 0.2198, 0.0835,
        0.3395, 0.3142, 0.0823, 0.2724, 0.1842, 0.2285, 0.2540, 0.2308, 0.2238,
        0.2861, 0.2985, 0.1744, 0.3372, 0.1610, 0.1532, 0.4176, 0.2528, 0.3003,
        0.2308])
true tensor([-0.0600,  0.7200,  0.5500,  0.6900,  0.7200, -0.2000,  0.1700,  0.4200,
         0.7400,  0.7200, -0.2000,  0.1700,  0.1700,  0.4200,  0.5600, -0.0100,
         0.8300,  0.5600,  0.1800,  0.7100,  0.7400,  0.7200, -0.2000,  0.1700,
         0.7200, -0.2000,  0.1700,  0.4200,  0.5500,  0.6900,  0.8300,  0.5600,
         0.7200,  0.5500,  0.6900,  0.8300,  0.6900,  0.8300,  0.5600,  0.1800,
         0.4200,  0.5600, -0.0100,  0.4200,  0.1700,  0.4200,  0.5600, -0.0100,
         0.7400,  0.7400,  0.7200, -0.2000,  0.8300,  0.5600,  0.1800,  0.7100,
         0.4200, -0.0600,  0.7200,  0.5500,  0.7400,  0.7400,  0.7200, -0.2000,
         0.4200, -0.0600,  0.7200,  0.5500,  0.4200,  0.5600, -0.0100,  0.4200,
         0.1700,  0.4200,  0.5600, -0.0100, -0.0100,  0.4200, -0.0600,  0.7200,
         0.7400,  0.7200, -0.2000,  0.1700,  0.6900,  0.8300,  0.5600,  0.1800,
         0.7200,  0.5500,  0.6900,  0.8300,  0.5600, -0.0100,  0.4200, -0.0600,
         0.7200, -0.2000,  0.1700,  0.4200, -0.0600,  0.7200,  0.5500,  0.6900,
        -0.2000,  0.1700,  0.4200,  0.5600, -0.0600,  0.7200,  0.5500,  0.6900,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.4200,  0.5600, -0.0100,  0.4200,
        -0.0100,  0.4200, -0.0600,  0.7200,  0.5600, -0.0100,  0.4200, -0.0600,
         0.5500,  0.6900,  0.8300,  0.5600,  0.4200, -0.0600,  0.7200,  0.5500,
         0.6900,  0.8300,  0.5600,  0.1800,  0.5500,  0.6900,  0.8300,  0.5600,
         0.5600,  0.1800,  0.7100,  1.0200,  0.5600, -0.0100,  0.4200, -0.0600,
        -0.0100,  0.4200, -0.0600,  0.7200, -0.2000,  0.1700,  0.4200,  0.5600,
         0.7200,  0.5500,  0.6900,  0.8300,  0.7400,  0.7400,  0.7200, -0.2000,
         0.8300,  0.5600,  0.1800,  0.7100])
Epoch: 9, Steps: 1 | Train Loss: 0.1296176 Vali Loss: 0.1468202
lr = 0.0000024569
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
1it [00:00,  6.04it/s]
1it [00:00, 11.54it/s]
1it [00:00,  6.16it/s]
1it [00:00, 11.70it/s]
1it [00:00,  6.20it/s]
Epoch: 10 cost time: 0.5016162395477295
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.0911,  0.2536,  0.2881,  0.0854,  0.2567,  0.2617,  0.2528,  0.3828,
         0.2318,  0.3624,  0.1588,  0.2103,  0.1775,  0.2524,  0.1602,  0.3179,
         0.2696,  0.3420,  0.2259,  0.2478,  0.2281,  0.1424,  0.1368,  0.2102,
         0.1786,  0.1996,  0.2582,  0.1595,  0.2035,  0.1817,  0.2137,  0.3066,
         0.2865,  0.3508,  0.2039,  0.1088,  0.1434,  0.2747,  0.2522,  0.3456,
         0.4269,  0.1648,  0.2648,  0.2146,  0.1730,  0.2533,  0.2435,  0.1155,
         0.1180,  0.1305,  0.3001,  0.0591,  0.2288,  0.1654,  0.0959,  0.1405,
         0.0139,  0.3221,  0.4397,  0.0283,  0.2530,  0.2551,  0.2154,  0.2282,
         0.1317,  0.2438,  0.2835,  0.1369,  0.1215,  0.3655,  0.0236,  0.2594,
         0.0156,  0.1919,  0.1837,  0.2026,  0.1820,  0.3772,  0.2739,  0.2313,
         0.2150,  0.3603,  0.0226,  0.3299,  0.2601,  0.1874,  0.3417,  0.3208,
         0.0722,  0.2643, -0.0229,  0.2334,  0.1103,  0.1577,  0.2030,  0.2185,
         0.3315,  0.1877,  0.2878,  0.3255,  0.2195,  0.2401,  0.0833,  0.2962,
         0.2848,  0.2672,  0.3040,  0.3616,  0.2333,  0.3936,  0.1098,  0.3432,
         0.0486,  0.3574,  0.2090,  0.2237,  0.1630,  0.1578,  0.4059,  0.2703,
         0.3521,  0.2093,  0.2061,  0.2446,  0.0621,  0.1669,  0.2055,  0.2535,
         0.1325,  0.4376,  0.1518,  0.1593,  0.2615,  0.1706,  0.1686,  0.2101,
         0.2429,  0.1402,  0.2945,  0.4422,  0.0697,  0.2424,  0.4333, -0.0538,
         0.1700,  0.2196,  0.1444,  0.0826,  0.2245,  0.2779,  0.2046,  0.1419,
         0.3824,  0.1592,  0.1385,  0.2319,  0.0905,  0.3573,  0.2450,  0.0155,
         0.1914,  0.2130,  0.2787,  0.3178,  0.2236,  0.1120,  0.1300,  0.2770,
         0.4438,  0.2109,  0.1067,  0.2892])
true tensor([ 0.4200, -0.0600,  0.7200,  0.5500,  0.7400,  0.7400,  0.7200, -0.2000,
         0.7200, -0.2000,  0.1700,  0.4200,  0.8300,  0.5600,  0.1800,  0.7100,
         0.7200,  0.5500,  0.6900,  0.8300, -0.2000,  0.1700,  0.4200,  0.5600,
         0.6900,  0.8300,  0.5600,  0.1800, -0.0100,  0.4200, -0.0600,  0.7200,
         0.7200, -0.2000,  0.1700,  0.4200,  0.7200,  0.5500,  0.6900,  0.8300,
         0.4200,  0.5600, -0.0100,  0.4200,  0.4200,  0.5600, -0.0100,  0.4200,
         0.7400,  0.7200, -0.2000,  0.1700,  0.5600, -0.0100,  0.4200, -0.0600,
         0.5600, -0.0100,  0.4200, -0.0600,  0.7400,  0.7200, -0.2000,  0.1700,
         0.4200, -0.0600,  0.7200,  0.5500, -0.0600,  0.7200,  0.5500,  0.6900,
         0.1700,  0.4200,  0.5600, -0.0100,  0.7200, -0.2000,  0.1700,  0.4200,
         0.5500,  0.6900,  0.8300,  0.5600,  0.4200,  0.5600, -0.0100,  0.4200,
         0.1700,  0.4200,  0.5600, -0.0100, -0.2000,  0.1700,  0.4200,  0.5600,
         0.6900,  0.8300,  0.5600,  0.1800, -0.0100,  0.4200, -0.0600,  0.7200,
        -0.0600,  0.7200,  0.5500,  0.6900, -0.0600,  0.7200,  0.5500,  0.6900,
         0.7200,  0.5500,  0.6900,  0.8300,  0.5500,  0.6900,  0.8300,  0.5600,
         0.8300,  0.5600,  0.1800,  0.7100, -0.0100,  0.4200, -0.0600,  0.7200,
         0.4200, -0.0600,  0.7200,  0.5500,  0.6900,  0.8300,  0.5600,  0.1800,
         0.5600,  0.1800,  0.7100,  1.0200,  0.1700,  0.4200,  0.5600, -0.0100,
         0.7400,  0.7400,  0.7200, -0.2000,  0.7400,  0.7400,  0.7200, -0.2000,
         0.7400,  0.7200, -0.2000,  0.1700,  0.5500,  0.6900,  0.8300,  0.5600,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.8300,  0.5600,  0.1800,  0.7100,
         0.5600, -0.0100,  0.4200, -0.0600])
Epoch: 10, Steps: 1 | Train Loss: 0.1294838 Vali Loss: 0.1457798
lr = 0.0000000100
EarlyStopping counter: 2 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 11 cost time: 0.5011730194091797
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.3052,  0.0763,  0.2587,  0.2940,  0.2077,  0.3250,  0.2567,  0.2763,
         0.2517,  0.1624,  0.1846,  0.2403,  0.0956,  0.1840,  0.2781,  0.1693,
         0.1662,  0.1174,  0.1610,  0.2119,  0.1642,  0.2070,  0.2200,  0.2740,
         0.2461,  0.2153,  0.1028,  0.1838,  0.2944,  0.1831,  0.3976,  0.2732,
         0.2577,  0.2180,  0.3091,  0.1614,  0.2184,  0.1151,  0.3579,  0.1445,
         0.0276,  0.3801,  0.1390,  0.2428,  0.1748,  0.2125,  0.0807,  0.3212,
         0.0957,  0.3133,  0.2381,  0.2097,  0.1062,  0.1887,  0.2722,  0.3973,
         0.3078, -0.0220,  0.1889,  0.1824,  0.3635,  0.2005,  0.0196,  0.2715,
         0.1808,  0.2209,  0.3708,  0.3247,  0.3391,  0.2060,  0.2080,  0.1879,
         0.1039,  0.2553,  0.1292,  0.5020,  0.2023,  0.3345,  0.3186,  0.2534,
         0.1185,  0.3334,  0.0509,  0.2891,  0.2652,  0.0933,  0.3585,  0.3728,
         0.2255,  0.2288,  0.4538,  0.2213,  0.3953,  0.3626,  0.1607,  0.3668,
         0.1980,  0.3095,  0.2787,  0.1460,  0.1763,  0.2448,  0.2879,  0.2093,
         0.1351,  0.1784,  0.2073,  0.2832,  0.1756,  0.3349,  0.1309,  0.1708,
         0.2562,  0.2491,  0.2976,  0.3663,  0.2560,  0.2724,  0.3822,  0.2280,
         0.1109,  0.2026,  0.2413,  0.1669,  0.3509,  0.1918,  0.2654,  0.3271,
         0.1553,  0.2321,  0.2717,  0.2211,  0.2153,  0.4175,  0.2865,  0.2857,
         0.1853,  0.3309,  0.1646,  0.1605,  0.1303,  0.3810,  0.2994,  0.2061,
         0.2133,  0.2656,  0.1675,  0.2792,  0.0791,  0.3663,  0.0509,  0.2483,
         0.3023,  0.0458,  0.3137,  0.1553,  0.0681,  0.3747,  0.1278,  0.1996,
         0.2433,  0.1987,  0.2456,  0.3136,  0.1100,  0.2375,  0.2564,  0.1530,
         0.2140,  0.2787,  0.2509,  0.2715])
true tensor([ 0.7400,  0.7400,  0.7200, -0.2000,  0.5500,  0.6900,  0.8300,  0.5600,
         0.5500,  0.6900,  0.8300,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.1700,  0.4200,  0.5600, -0.0100,
         0.5600, -0.0100,  0.4200, -0.0600, -0.0100,  0.4200, -0.0600,  0.7200,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.4200,  0.5600, -0.0100,  0.4200,
         0.7400,  0.7200, -0.2000,  0.1700,  0.4200,  0.5600, -0.0100,  0.4200,
         0.5600, -0.0100,  0.4200, -0.0600, -0.0600,  0.7200,  0.5500,  0.6900,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.4200, -0.0600,  0.7200,  0.5500,
         0.6900,  0.8300,  0.5600,  0.1800,  0.7200, -0.2000,  0.1700,  0.4200,
         0.1700,  0.4200,  0.5600, -0.0100,  0.6900,  0.8300,  0.5600,  0.1800,
         0.8300,  0.5600,  0.1800,  0.7100,  0.7200,  0.5500,  0.6900,  0.8300,
         0.5500,  0.6900,  0.8300,  0.5600,  0.7400,  0.7200, -0.2000,  0.1700,
         0.4200,  0.5600, -0.0100,  0.4200, -0.0100,  0.4200, -0.0600,  0.7200,
        -0.2000,  0.1700,  0.4200,  0.5600,  0.4200, -0.0600,  0.7200,  0.5500,
         0.7200,  0.5500,  0.6900,  0.8300,  0.8300,  0.5600,  0.1800,  0.7100,
         0.7200,  0.5500,  0.6900,  0.8300,  0.7200, -0.2000,  0.1700,  0.4200,
         0.1700,  0.4200,  0.5600, -0.0100,  0.4200, -0.0600,  0.7200,  0.5500,
        -0.0600,  0.7200,  0.5500,  0.6900,  0.5600,  0.1800,  0.7100,  1.0200,
         0.7400,  0.7400,  0.7200, -0.2000,  0.6900,  0.8300,  0.5600,  0.1800,
         0.7200, -0.2000,  0.1700,  0.4200,  0.8300,  0.5600,  0.1800,  0.7100,
         0.5600, -0.0100,  0.4200, -0.0600,  0.7400,  0.7200, -0.2000,  0.1700,
         0.7400,  0.7400,  0.7200, -0.2000])
Epoch: 11, Steps: 1 | Train Loss: 0.1280603 Vali Loss: 0.1467833
lr = 0.0000024569
EarlyStopping counter: 3 out of 3
Early stopping
------------------------------------
outputs torch.Size([93, 12, 18])
B 93
L 18
M 18
1it [00:00, 12.43it/s]
1it [00:00, 10.58it/s]
test shape: (1, 372) (1, 372)
test shape: (1, 1, 372) (1, 1, 372)
mae:0.9091, mse:1.1683, rmse:1.0809, r2:-0.0392
mse_mean = 1.1683, mse_std = 0.0000
r2_mean = -0.0392, mae_std = 0.0000