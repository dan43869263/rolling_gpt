['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
train 337
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
val 43
['date', 'atq', 'ni', 'dv', 'acc', 'invest', 'mc', 'bm', 'dinvt', 'dar', 'capx', 'gm', 'sga', 'prc', 'ret', 'vol', 'shrout', 'medest', 'meanest', 'value']
test 93
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (2): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (3): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (4): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (5): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
1it [00:01,  1.12s/it]
0it [00:00, ?it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 1 cost time: 1.418985366821289
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2703,  0.1105,  0.1810,  0.1838,  0.1965, -0.0781,  0.1587,  0.2006,
         0.0527,  0.1412,  0.2687,  0.3237, -0.0884,  0.1737,  0.2208,  0.3589,
         0.0925,  0.2716,  0.3714,  0.3906,  0.1084,  0.2287,  0.2832, -0.0063,
         0.2292,  0.1726,  0.3128,  0.0186,  0.1677,  0.0742,  0.2353,  0.0625,
         0.2404,  0.1295,  0.2668,  0.0026,  0.1362,  0.0347,  0.4529,  0.1411,
         0.2432,  0.0929,  0.5402,  0.1258,  0.0353,  0.0114,  0.3510,  0.3299,
         0.3240, -0.1278,  0.3318, -0.0032,  0.2757,  0.0379,  0.3707,  0.1095,
         0.0831,  0.1354,  0.2640,  0.0878,  0.1602,  0.2616,  0.2282,  0.0446,
         0.2969, -0.1772,  0.4225,  0.1088,  0.2173,  0.1277,  0.1503,  0.0174,
         0.0541,  0.1652,  0.3177,  0.4437,  0.2299, -0.0474,  0.4174,  0.1656,
         0.1691,  0.1480,  0.0686,  0.1459, -0.0365,  0.1941,  0.3371,  0.3353,
         0.2516,  0.0210,  0.4233,  0.1197,  0.0019,  0.1940,  0.2589,  0.4654,
         0.2468, -0.0071,  0.5164,  0.0925,  0.0921,  0.3790,  0.3147, -0.0156,
        -0.0058,  0.1576,  0.1771,  0.3577, -0.0750,  0.2250,  0.2176,  0.5912,
         0.1957,  0.1222,  0.1993,  0.0193,  0.0693,  0.3046,  0.1693,  0.0781,
         0.2329,  0.1427,  0.1469,  0.2502,  0.1558,  0.0362,  0.1975,  0.0608,
        -0.0354,  0.1828,  0.3413,  0.4076,  0.0600,  0.0725,  0.1670,  0.5547,
         0.2460, -0.0138,  0.4287,  0.0373,  0.2100,  0.0770,  0.3714,  0.4640,
         0.1274,  0.2017,  0.2581, -0.0287,  0.1120,  0.1394,  0.2042,  0.3588,
         0.2032,  0.0534,  0.2147,  0.1452,  0.1312, -0.0560,  0.2337,  0.1051,
         0.1956,  0.1993,  0.2510,  0.0751,  0.1963, -0.0565,  0.3776,  0.1335,
         0.0601,  0.1437,  0.2014,  0.4127])
true tensor([0.4113, 0.4420, 0.4604, 0.4448, 0.4399, 0.4232, 0.4034, 0.4327, 0.3842,
        0.4399, 0.4232, 0.4034, 0.3898, 0.3842, 0.4399, 0.4232, 0.3553, 0.3898,
        0.3842, 0.4399, 0.4677, 0.4385, 0.4420, 0.4113, 0.4604, 0.4448, 0.4319,
        0.4512, 0.4420, 0.4604, 0.4448, 0.4319, 0.3553, 0.3898, 0.3842, 0.4399,
        0.4034, 0.4327, 0.4677, 0.4385, 0.4327, 0.4677, 0.4385, 0.4420, 0.4604,
        0.4448, 0.4319, 0.4512, 0.4232, 0.4034, 0.4327, 0.4677, 0.4113, 0.4420,
        0.4604, 0.4448, 0.4420, 0.4113, 0.4420, 0.4604, 0.3842, 0.4399, 0.4232,
        0.4034, 0.4604, 0.4448, 0.4319, 0.4512, 0.4385, 0.4420, 0.4113, 0.4420,
        0.4034, 0.4327, 0.4677, 0.4385, 0.4448, 0.4319, 0.4512, 0.4641, 0.4034,
        0.4327, 0.4677, 0.4385, 0.4420, 0.4604, 0.4448, 0.4319, 0.4420, 0.4113,
        0.4420, 0.4604, 0.4399, 0.4232, 0.4034, 0.4327, 0.4420, 0.4604, 0.4448,
        0.4319, 0.3553, 0.3898, 0.3842, 0.4399, 0.4327, 0.4677, 0.4385, 0.4420,
        0.4420, 0.4113, 0.4420, 0.4604, 0.4232, 0.4034, 0.4327, 0.4677, 0.3898,
        0.3842, 0.4399, 0.4232, 0.4448, 0.4319, 0.4512, 0.4641, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4677, 0.4385, 0.4420, 0.4113, 0.4113, 0.4420, 0.4604,
        0.4448, 0.4677, 0.4385, 0.4420, 0.4113, 0.4385, 0.4420, 0.4113, 0.4420,
        0.4319, 0.4512, 0.4641, 0.4196, 0.4448, 0.4319, 0.4512, 0.4641, 0.4385,
        0.4420, 0.4113, 0.4420, 0.3842, 0.4399, 0.4232, 0.4034, 0.4399, 0.4232,
        0.4034, 0.4327, 0.3898, 0.3842, 0.4399, 0.4232, 0.4232, 0.4034, 0.4327,
        0.4677])
Epoch: 1, Steps: 1 | Train Loss: 0.0333074 Vali Loss: 0.0832124
lr = 0.0000975531
1it [00:00, 11.91it/s]
1it [00:00,  5.54it/s]
1it [00:00, 11.72it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 2 cost time: 0.5430166721343994
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2524, -0.0441,  0.3970,  0.1447,  0.0634,  0.0843,  0.3168,  0.2042,
         0.3790, -0.1594,  0.3376,  0.1016,  0.2167,  0.0690,  0.4127,  0.1112,
         0.2127,  0.1557,  0.2313,  0.0111,  0.1064,  0.1600,  0.2457, -0.0159,
         0.2572,  0.0381,  0.5013,  0.1914,  0.0330,  0.1832,  0.2111,  0.3502,
         0.1440,  0.1600,  0.2760, -0.0561,  0.1442,  0.1132,  0.3260,  0.0866,
         0.2853,  0.0395,  0.2890,  0.0755,  0.0580,  0.2164,  0.1992,  0.4108,
         0.2856, -0.0029,  0.4834,  0.1688,  0.0354,  0.3525,  0.2660,  0.3322,
         0.1989, -0.0239,  0.2314,  0.1106,  0.0093,  0.2884,  0.1969,  0.4283,
         0.1474,  0.1605,  0.2798,  0.0275, -0.1204,  0.1386,  0.2343,  0.3289,
         0.0689,  0.1817,  0.2180,  0.3769,  0.1914,  0.0617,  0.2257,  0.0861,
         0.1013,  0.1543,  0.2174,  0.3923,  0.3140, -0.0646,  0.5011,  0.0860,
         0.1300, -0.0178,  0.3488,  0.1675,  0.2091,  0.1881,  0.1717,  0.1559,
         0.0350,  0.1722,  0.2362, -0.0485,  0.1156,  0.3764,  0.1728,  0.2684,
         0.3646,  0.0995,  0.1286,  0.0765,  0.1128, -0.0804,  0.3529,  0.1604,
         0.1554, -0.0141,  0.2658,  0.0366,  0.0898,  0.1910,  0.2407,  0.4174,
         0.2791,  0.1350,  0.4448,  0.1173,  0.0641,  0.1437,  0.1842,  0.3572,
         0.0451,  0.1990,  0.1167,  0.5062,  0.1320,  0.0977,  0.2962,  0.0108,
         0.2151,  0.1771,  0.3434, -0.0254,  0.0653,  0.2380,  0.2417,  0.4933,
         0.2145,  0.1404,  0.3657, -0.0045,  0.1030,  0.2822,  0.1908,  0.0601,
         0.0838,  0.1764,  0.1033,  0.0945,  0.1104,  0.1760,  0.2609,  0.3610,
         0.1925,  0.0941,  0.3060, -0.0113,  0.1073,  0.1751,  0.2591,  0.3390,
         0.2733, -0.0249,  0.4991,  0.1994])
true tensor([0.4385, 0.4420, 0.4113, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.3898,
        0.3842, 0.4399, 0.4232, 0.4677, 0.4385, 0.4420, 0.4113, 0.3842, 0.4399,
        0.4232, 0.4034, 0.4448, 0.4319, 0.4512, 0.4641, 0.4420, 0.4113, 0.4420,
        0.4604, 0.4420, 0.4604, 0.4448, 0.4319, 0.4385, 0.4420, 0.4113, 0.4420,
        0.4232, 0.4034, 0.4327, 0.4677, 0.3553, 0.3898, 0.3842, 0.4399, 0.4448,
        0.4319, 0.4512, 0.4641, 0.4399, 0.4232, 0.4034, 0.4327, 0.4399, 0.4232,
        0.4034, 0.4327, 0.3842, 0.4399, 0.4232, 0.4034, 0.4034, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4604, 0.4448, 0.4319, 0.3898, 0.3842, 0.4399, 0.4232,
        0.4604, 0.4448, 0.4319, 0.4512, 0.4319, 0.4512, 0.4641, 0.4196, 0.3553,
        0.3898, 0.3842, 0.4399, 0.4604, 0.4448, 0.4319, 0.4512, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4604, 0.4448, 0.4319, 0.4512, 0.4420, 0.4113, 0.4420,
        0.4604, 0.4327, 0.4677, 0.4385, 0.4420, 0.4448, 0.4319, 0.4512, 0.4641,
        0.4420, 0.4604, 0.4448, 0.4319, 0.4327, 0.4677, 0.4385, 0.4420, 0.4385,
        0.4420, 0.4113, 0.4420, 0.4034, 0.4327, 0.4677, 0.4385, 0.4113, 0.4420,
        0.4604, 0.4448, 0.4420, 0.4113, 0.4420, 0.4604, 0.3898, 0.3842, 0.4399,
        0.4232, 0.4113, 0.4420, 0.4604, 0.4448, 0.4232, 0.4034, 0.4327, 0.4677,
        0.4399, 0.4232, 0.4034, 0.4327, 0.4677, 0.4385, 0.4420, 0.4113, 0.3553,
        0.3898, 0.3842, 0.4399, 0.3842, 0.4399, 0.4232, 0.4034, 0.4034, 0.4327,
        0.4677, 0.4385, 0.4677, 0.4385, 0.4420, 0.4113, 0.4232, 0.4034, 0.4327,
        0.4677])
Epoch: 2, Steps: 1 | Train Loss: 0.0316415 Vali Loss: 0.0802309
lr = 0.0000904518
Validation loss decreased (0.083212 --> 0.080231).  Saving model ...
1it [00:00,  6.04it/s]
1it [00:00, 11.50it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 3 cost time: 0.5291790962219238
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.1945,  0.0981,  0.2298, -0.0798,  0.1962,  0.0498,  0.2469,  0.1677,
         0.1265,  0.2329,  0.2942, -0.0718,  0.1929,  0.0793,  0.1491,  0.0765,
         0.2255,  0.1250,  0.2219,  0.2059,  0.1702,  0.0745,  0.1774,  0.4788,
        -0.0075,  0.0524,  0.1907,  0.4846,  0.1691,  0.1079,  0.1903,  0.1914,
         0.1733, -0.0296,  0.2979,  0.1160,  0.1464,  0.1169,  0.2717,  0.2529,
        -0.0573,  0.3137,  0.3798,  0.2107,  0.2417,  0.2236,  0.0783,  0.0744,
         0.2679,  0.0055,  0.4679,  0.1246,  0.1517,  0.2337,  0.2530, -0.0023,
         0.1229,  0.2335,  0.3905,  0.3121,  0.1029,  0.1502,  0.1994,  0.0521,
         0.1857,  0.3309,  0.0962,  0.1223,  0.2495,  0.1635,  0.0424,  0.0444,
         0.1436,  0.0743,  0.1681,  0.0770,  0.0404,  0.1816,  0.2055,  0.3963,
         0.0182,  0.3303,  0.2258,  0.4145,  0.1702,  0.2730,  0.2232,  0.0336,
         0.1927,  0.0604,  0.2992,  0.1353, -0.0278,  0.2240,  0.2155,  0.5012,
         0.0903,  0.2521,  0.3461, -0.0599,  0.2346, -0.0692,  0.3528,  0.1235,
         0.0114,  0.4550,  0.3315,  0.3776,  0.1161,  0.0153,  0.3498,  0.2588,
         0.2035,  0.1511,  0.1654,  0.4618, -0.0496,  0.2832,  0.2111,  0.3211,
         0.0810,  0.1257,  0.0989,  0.4095,  0.3171, -0.0615,  0.3586,  0.2209,
         0.0948, -0.0243,  0.3893,  0.1371,  0.2242,  0.1163,  0.3898,  0.1859,
         0.1856,  0.2313,  0.2578,  0.1730,  0.3363,  0.0274,  0.4239,  0.1150,
         0.1905,  0.0659,  0.2785,  0.2555,  0.2140,  0.0232,  0.2162,  0.2416,
         0.0749,  0.2208,  0.2074,  0.2347,  0.2902, -0.0085,  0.3276,  0.1842,
         0.0626,  0.1772,  0.2945,  0.3741,  0.1330,  0.0954,  0.3547,  0.2413,
         0.1263,  0.0934,  0.1834,  0.0092])
true tensor([0.4677, 0.4385, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.4319, 0.4113,
        0.4420, 0.4604, 0.4448, 0.4420, 0.4113, 0.4420, 0.4604, 0.3842, 0.4399,
        0.4232, 0.4034, 0.4420, 0.4113, 0.4420, 0.4604, 0.4232, 0.4034, 0.4327,
        0.4677, 0.3898, 0.3842, 0.4399, 0.4232, 0.4420, 0.4113, 0.4420, 0.4604,
        0.3553, 0.3898, 0.3842, 0.4399, 0.4399, 0.4232, 0.4034, 0.4327, 0.4034,
        0.4327, 0.4677, 0.4385, 0.4232, 0.4034, 0.4327, 0.4677, 0.4385, 0.4420,
        0.4113, 0.4420, 0.4604, 0.4448, 0.4319, 0.4512, 0.3842, 0.4399, 0.4232,
        0.4034, 0.4319, 0.4512, 0.4641, 0.4196, 0.4448, 0.4319, 0.4512, 0.4641,
        0.4604, 0.4448, 0.4319, 0.4512, 0.4034, 0.4327, 0.4677, 0.4385, 0.4113,
        0.4420, 0.4604, 0.4448, 0.4327, 0.4677, 0.4385, 0.4420, 0.4420, 0.4604,
        0.4448, 0.4319, 0.3842, 0.4399, 0.4232, 0.4034, 0.4232, 0.4034, 0.4327,
        0.4677, 0.4327, 0.4677, 0.4385, 0.4420, 0.4420, 0.4604, 0.4448, 0.4319,
        0.4113, 0.4420, 0.4604, 0.4448, 0.4327, 0.4677, 0.4385, 0.4420, 0.4448,
        0.4319, 0.4512, 0.4641, 0.4385, 0.4420, 0.4113, 0.4420, 0.4448, 0.4319,
        0.4512, 0.4641, 0.4034, 0.4327, 0.4677, 0.4385, 0.3898, 0.3842, 0.4399,
        0.4232, 0.4399, 0.4232, 0.4034, 0.4327, 0.4677, 0.4385, 0.4420, 0.4113,
        0.4604, 0.4448, 0.4319, 0.4512, 0.4399, 0.4232, 0.4034, 0.4327, 0.3898,
        0.3842, 0.4399, 0.4232, 0.3553, 0.3898, 0.3842, 0.4399, 0.4677, 0.4385,
        0.4420, 0.4113, 0.4385, 0.4420, 0.4113, 0.4420, 0.3553, 0.3898, 0.3842,
        0.4399])
Epoch: 3, Steps: 1 | Train Loss: 0.0315345 Vali Loss: 0.0769059
lr = 0.0000793913
Validation loss decreased (0.080231 --> 0.076906).  Saving model ...
1it [00:00,  6.06it/s]
1it [00:00, 11.67it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 4 cost time: 0.527935266494751
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.0908,  0.1902,  0.2470,  0.3132,  0.0851,  0.2158,  0.2291,  0.3355,
         0.2474,  0.0428,  0.3896,  0.1999,  0.0193,  0.1443,  0.2215,  0.4511,
         0.0774,  0.2248,  0.2179,  0.2331,  0.1925,  0.0803,  0.3861,  0.2671,
         0.1880,  0.0877,  0.2865,  0.2261,  0.1261,  0.1027,  0.3557,  0.0962,
         0.0058,  0.3289,  0.2408,  0.3334,  0.1557, -0.1167,  0.2789,  0.1868,
         0.2347,  0.2797,  0.1553,  0.1665,  0.2506,  0.1125,  0.1726,  0.3122,
         0.2151,  0.1501,  0.1793,  0.1026,  0.1547,  0.1699,  0.2128,  0.0690,
         0.1928, -0.0314,  0.3849,  0.2139,  0.0068,  0.1923,  0.2203,  0.3629,
         0.3047,  0.0992,  0.3320,  0.2399,  0.0959,  0.1739,  0.1151,  0.1231,
         0.1668,  0.0263,  0.2419,  0.2400,  0.2528,  0.1623,  0.1168,  0.2413,
         0.0126,  0.1480,  0.2189,  0.2993,  0.2082,  0.1550,  0.1238,  0.2014,
         0.1862,  0.1161,  0.2076,  0.2444,  0.2413,  0.1798,  0.1647,  0.1836,
        -0.0631,  0.2318,  0.2568,  0.2973,  0.0619,  0.3314,  0.1861,  0.4376,
         0.0329,  0.2270,  0.3310,  0.2629,  0.1640,  0.2250,  0.1888,  0.0061,
         0.1203,  0.1908,  0.2387,  0.3878,  0.2464,  0.1667,  0.2233,  0.2751,
         0.2816,  0.1832,  0.1982,  0.0539,  0.2133,  0.1496,  0.2674,  0.2076,
         0.1271,  0.1637,  0.2549,  0.2299,  0.1044,  0.2089,  0.3444,  0.3854,
         0.3138,  0.1324,  0.2783,  0.0561,  0.0193,  0.2195,  0.3677,  0.3721,
         0.1423,  0.1933,  0.3488,  0.2941, -0.0106,  0.0312,  0.0968,  0.4226,
         0.1191,  0.1680,  0.3111,  0.1872,  0.3236,  0.0410,  0.1867,  0.1084,
         0.1165,  0.1521,  0.2446,  0.0405,  0.2786,  0.1053,  0.3134,  0.1644,
         0.1035,  0.1257,  0.2235,  0.3604])
true tensor([0.4448, 0.4319, 0.4512, 0.4641, 0.4385, 0.4420, 0.4113, 0.4420, 0.4677,
        0.4385, 0.4420, 0.4113, 0.4034, 0.4327, 0.4677, 0.4385, 0.4319, 0.4512,
        0.4641, 0.4196, 0.4399, 0.4232, 0.4034, 0.4327, 0.4034, 0.4327, 0.4677,
        0.4385, 0.3553, 0.3898, 0.3842, 0.4399, 0.4420, 0.4113, 0.4420, 0.4604,
        0.4113, 0.4420, 0.4604, 0.4448, 0.3898, 0.3842, 0.4399, 0.4232, 0.4385,
        0.4420, 0.4113, 0.4420, 0.4232, 0.4034, 0.4327, 0.4677, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4420, 0.4604, 0.4448, 0.4319, 0.4327, 0.4677, 0.4385,
        0.4420, 0.4327, 0.4677, 0.4385, 0.4420, 0.3553, 0.3898, 0.3842, 0.4399,
        0.4385, 0.4420, 0.4113, 0.4420, 0.4034, 0.4327, 0.4677, 0.4385, 0.4677,
        0.4385, 0.4420, 0.4113, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.4319,
        0.4512, 0.4641, 0.4113, 0.4420, 0.4604, 0.4448, 0.4113, 0.4420, 0.4604,
        0.4448, 0.4399, 0.4232, 0.4034, 0.4327, 0.3553, 0.3898, 0.3842, 0.4399,
        0.4420, 0.4604, 0.4448, 0.4319, 0.3842, 0.4399, 0.4232, 0.4034, 0.4677,
        0.4385, 0.4420, 0.4113, 0.3842, 0.4399, 0.4232, 0.4034, 0.3898, 0.3842,
        0.4399, 0.4232, 0.3842, 0.4399, 0.4232, 0.4034, 0.4232, 0.4034, 0.4327,
        0.4677, 0.4399, 0.4232, 0.4034, 0.4327, 0.4604, 0.4448, 0.4319, 0.4512,
        0.4604, 0.4448, 0.4319, 0.4512, 0.3898, 0.3842, 0.4399, 0.4232, 0.4420,
        0.4113, 0.4420, 0.4604, 0.4604, 0.4448, 0.4319, 0.4512, 0.4448, 0.4319,
        0.4512, 0.4641, 0.4232, 0.4034, 0.4327, 0.4677, 0.4420, 0.4604, 0.4448,
        0.4319])
Epoch: 4, Steps: 1 | Train Loss: 0.0268317 Vali Loss: 0.0669212
lr = 0.0000654543
Validation loss decreased (0.076906 --> 0.066921).  Saving model ...
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 5 cost time: 0.5272800922393799
1it [00:00,  6.12it/s]
1it [00:00, 10.97it/s]
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.0492,  0.2933,  0.2189,  0.4253,  0.1691,  0.1622,  0.1859,  0.0679,
        -0.0272,  0.2712,  0.2902,  0.2479,  0.1674,  0.1504,  0.1619, -0.0470,
         0.0881,  0.2580,  0.1291,  0.1546,  0.1162,  0.2619,  0.1727,  0.0762,
         0.1701,  0.2158,  0.2925,  0.1874,  0.2688,  0.1287,  0.1247,  0.2347,
         0.2024,  0.1997,  0.2600,  0.3787,  0.2026,  0.2428,  0.3101,  0.3070,
         0.1544,  0.1658,  0.2329,  0.2366,  0.1779,  0.0503,  0.2209,  0.2358,
         0.0296,  0.2795,  0.2408,  0.4232,  0.2543,  0.1475,  0.2586,  0.1074,
         0.3049,  0.0866,  0.1417,  0.1664,  0.1333,  0.0981,  0.3579,  0.2034,
         0.1579,  0.2419,  0.2720,  0.3708,  0.1144,  0.2908,  0.2347,  0.2990,
         0.0909,  0.1765,  0.2129,  0.3699,  0.2387,  0.2829,  0.1222,  0.1395,
         0.0423,  0.2912,  0.2867,  0.2827,  0.1664,  0.2549,  0.0960,  0.3162,
         0.2596,  0.0870,  0.2843,  0.0890,  0.0130,  0.1519,  0.2664,  0.2084,
         0.0744,  0.2301,  0.3023,  0.4016,  0.2152,  0.0363,  0.4028,  0.2833,
         0.1497,  0.0631,  0.1077,  0.2046,  0.2293,  0.0143,  0.2691,  0.1491,
         0.2807, -0.0149,  0.4448,  0.1343,  0.1574,  0.2718,  0.2999, -0.0114,
         0.0873,  0.1882,  0.3013,  0.2650,  0.1174,  0.1466,  0.3115,  0.2303,
         0.2689,  0.0025,  0.4033,  0.2035,  0.1419,  0.3240,  0.1951,  0.1084,
         0.1997,  0.1581,  0.1804,  0.1423,  0.0055,  0.2742,  0.0972,  0.4246,
         0.1992,  0.1127,  0.2674,  0.0879,  0.1527,  0.2825,  0.0768,  0.0274,
         0.0790,  0.1729,  0.0958,  0.1410,  0.1928,  0.1435,  0.2386,  0.0148,
         0.1045,  0.2220,  0.1664,  0.3425,  0.2100,  0.1375,  0.3182,  0.1823,
         0.1696,  0.2003,  0.1818,  0.1873])
true tensor([0.4327, 0.4677, 0.4385, 0.4420, 0.4448, 0.4319, 0.4512, 0.4641, 0.4399,
        0.4232, 0.4034, 0.4327, 0.4113, 0.4420, 0.4604, 0.4448, 0.4319, 0.4512,
        0.4641, 0.4196, 0.3842, 0.4399, 0.4232, 0.4034, 0.4604, 0.4448, 0.4319,
        0.4512, 0.4327, 0.4677, 0.4385, 0.4420, 0.4604, 0.4448, 0.4319, 0.4512,
        0.3553, 0.3898, 0.3842, 0.4399, 0.4113, 0.4420, 0.4604, 0.4448, 0.3898,
        0.3842, 0.4399, 0.4232, 0.3842, 0.4399, 0.4232, 0.4034, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4420, 0.4604, 0.4448, 0.4319, 0.4034, 0.4327, 0.4677,
        0.4385, 0.4232, 0.4034, 0.4327, 0.4677, 0.4420, 0.4113, 0.4420, 0.4604,
        0.4677, 0.4385, 0.4420, 0.4113, 0.4034, 0.4327, 0.4677, 0.4385, 0.4034,
        0.4327, 0.4677, 0.4385, 0.4399, 0.4232, 0.4034, 0.4327, 0.4399, 0.4232,
        0.4034, 0.4327, 0.4113, 0.4420, 0.4604, 0.4448, 0.4385, 0.4420, 0.4113,
        0.4420, 0.4420, 0.4604, 0.4448, 0.4319, 0.4385, 0.4420, 0.4113, 0.4420,
        0.3553, 0.3898, 0.3842, 0.4399, 0.4448, 0.4319, 0.4512, 0.4641, 0.4677,
        0.4385, 0.4420, 0.4113, 0.4232, 0.4034, 0.4327, 0.4677, 0.4448, 0.4319,
        0.4512, 0.4641, 0.4420, 0.4113, 0.4420, 0.4604, 0.3898, 0.3842, 0.4399,
        0.4232, 0.4604, 0.4448, 0.4319, 0.4512, 0.3898, 0.3842, 0.4399, 0.4232,
        0.4420, 0.4113, 0.4420, 0.4604, 0.4232, 0.4034, 0.4327, 0.4677, 0.3842,
        0.4399, 0.4232, 0.4034, 0.4385, 0.4420, 0.4113, 0.4420, 0.4420, 0.4604,
        0.4448, 0.4319, 0.4677, 0.4385, 0.4420, 0.4113, 0.3553, 0.3898, 0.3842,
        0.4399])
Epoch: 5, Steps: 1 | Train Loss: 0.0283897 Vali Loss: 0.0667546
lr = 0.0000500050
Validation loss decreased (0.066921 --> 0.066755).  Saving model ...
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 6 cost time: 0.5341053009033203
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.1476,  0.2024,  0.2962,  0.3094,  0.0857,  0.2553,  0.2396,  0.2949,
         0.1211,  0.1817,  0.1076,  0.2926,  0.1369,  0.1243,  0.2258,  0.1773,
         0.1517,  0.2568,  0.1543,  0.3447,  0.3046,  0.1701,  0.2830,  0.1015,
         0.0568,  0.2057,  0.1494,  0.3574,  0.1715,  0.0442,  0.1685,  0.2502,
         0.2465,  0.0979,  0.1300,  0.0519,  0.0433,  0.1337,  0.2244,  0.2977,
         0.2056,  0.1182,  0.4458,  0.2310,  0.0433,  0.2853,  0.3234,  0.2591,
         0.0577,  0.3428,  0.3133,  0.2926,  0.1845,  0.1286,  0.2444,  0.2945,
         0.1114,  0.2922,  0.0664,  0.4628,  0.1365,  0.2181,  0.3157,  0.2766,
         0.1615,  0.2076,  0.1437,  0.1596,  0.2616,  0.0146,  0.1706,  0.2042,
         0.1072,  0.2143,  0.3598,  0.4009,  0.1259,  0.0940,  0.3353,  0.1412,
         0.2215,  0.0502,  0.2909,  0.1161,  0.1595,  0.3286,  0.0886,  0.1417,
         0.2126,  0.1384,  0.2613,  0.1710,  0.1364,  0.2196,  0.1799,  0.2673,
         0.1880,  0.1947,  0.1359,  0.2122,  0.2055,  0.1264,  0.2364,  0.0732,
         0.2332,  0.1341,  0.1892,  0.1885,  0.1380,  0.2250,  0.1705,  0.2717,
         0.1772,  0.1015,  0.1538,  0.1754, -0.0573,  0.2717,  0.1235,  0.3995,
         0.1622,  0.1972,  0.3650,  0.0446,  0.1743,  0.0479,  0.2692,  0.2132,
         0.1710,  0.2318,  0.2469,  0.2441,  0.2383,  0.2259,  0.2135,  0.0700,
         0.1519,  0.2180,  0.0989,  0.3113,  0.0546,  0.2663,  0.1919,  0.2544,
         0.1843,  0.1427,  0.3130,  0.1779,  0.1844,  0.1881,  0.2795,  0.1807,
         0.2611,  0.1463,  0.2411,  0.2278,  0.1890,  0.0895,  0.3778,  0.2554,
         0.1424,  0.2226,  0.2245,  0.4661,  0.1664,  0.2186,  0.2441,  0.0088,
         0.1887,  0.1975,  0.2121,  0.1365])
true tensor([0.4385, 0.4420, 0.4113, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.4113,
        0.4420, 0.4604, 0.4448, 0.3842, 0.4399, 0.4232, 0.4034, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4677, 0.4385, 0.4420, 0.4113, 0.4385, 0.4420, 0.4113,
        0.4420, 0.4232, 0.4034, 0.4327, 0.4677, 0.4113, 0.4420, 0.4604, 0.4448,
        0.4420, 0.4113, 0.4420, 0.4604, 0.4420, 0.4604, 0.4448, 0.4319, 0.4677,
        0.4385, 0.4420, 0.4113, 0.4399, 0.4232, 0.4034, 0.4327, 0.4034, 0.4327,
        0.4677, 0.4385, 0.3842, 0.4399, 0.4232, 0.4034, 0.4604, 0.4448, 0.4319,
        0.4512, 0.4319, 0.4512, 0.4641, 0.4196, 0.4034, 0.4327, 0.4677, 0.4385,
        0.3553, 0.3898, 0.3842, 0.4399, 0.3553, 0.3898, 0.3842, 0.4399, 0.4420,
        0.4113, 0.4420, 0.4604, 0.4448, 0.4319, 0.4512, 0.4641, 0.4448, 0.4319,
        0.4512, 0.4641, 0.4385, 0.4420, 0.4113, 0.4420, 0.3898, 0.3842, 0.4399,
        0.4232, 0.4327, 0.4677, 0.4385, 0.4420, 0.4399, 0.4232, 0.4034, 0.4327,
        0.4677, 0.4385, 0.4420, 0.4113, 0.3553, 0.3898, 0.3842, 0.4399, 0.4420,
        0.4604, 0.4448, 0.4319, 0.4232, 0.4034, 0.4327, 0.4677, 0.4399, 0.4232,
        0.4034, 0.4327, 0.4232, 0.4034, 0.4327, 0.4677, 0.3842, 0.4399, 0.4232,
        0.4034, 0.4034, 0.4327, 0.4677, 0.4385, 0.3898, 0.3842, 0.4399, 0.4232,
        0.3898, 0.3842, 0.4399, 0.4232, 0.4604, 0.4448, 0.4319, 0.4512, 0.4604,
        0.4448, 0.4319, 0.4512, 0.4327, 0.4677, 0.4385, 0.4420, 0.4448, 0.4319,
        0.4512, 0.4641, 0.4420, 0.4113, 0.4420, 0.4604, 0.4420, 0.4604, 0.4448,
        0.4319])
1it [00:00,  5.94it/s]
1it [00:00, 11.84it/s]
0it [00:00, ?it/s]
Epoch: 6, Steps: 1 | Train Loss: 0.0262984 Vali Loss: 0.0630967
lr = 0.0000345557
Validation loss decreased (0.066755 --> 0.063097).  Saving model ...
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 7 cost time: 0.5306491851806641
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2041,  0.1682,  0.2350,  0.2057,  0.1580,  0.2592,  0.3123,  0.3203,
         0.2349,  0.2311,  0.1500,  0.1355,  0.1989,  0.1001,  0.1462,  0.1102,
         0.2439,  0.0340,  0.1667,  0.1016,  0.2905,  0.0299,  0.2086,  0.0497,
         0.1570,  0.2306,  0.2495,  0.2507,  0.2037,  0.0925,  0.2460,  0.1454,
         0.0636,  0.1194,  0.2506,  0.1910,  0.2561,  0.2097,  0.1865,  0.1973,
         0.0902,  0.2208,  0.2615,  0.3156,  0.1247,  0.1176,  0.2421,  0.2399,
         0.0020,  0.2784,  0.1060,  0.3601,  0.2878,  0.1697,  0.2090,  0.2066,
         0.2213,  0.2572,  0.1039,  0.1541,  0.0953,  0.2467,  0.1227,  0.1505,
         0.0646,  0.2742,  0.1321,  0.3064,  0.1795,  0.1714,  0.2151,  0.4190,
         0.3043,  0.1602,  0.2153,  0.1991,  0.2030,  0.2510,  0.1319,  0.1077,
         0.1047,  0.2758,  0.1635,  0.3342,  0.1818,  0.2911,  0.3240,  0.1069,
         0.3494,  0.2422,  0.1795,  0.0774,  0.1709,  0.1532,  0.2474,  0.2120,
         0.2017,  0.1428,  0.2326,  0.0799, -0.0219,  0.2928,  0.2067,  0.1952,
         0.2481,  0.1736,  0.2915,  0.2213,  0.1552,  0.0857,  0.2492,  0.1827,
         0.2092,  0.1641,  0.1619,  0.0061,  0.1654,  0.1501,  0.1686,  0.2443,
         0.2166,  0.2374,  0.0798,  0.3603,  0.1807,  0.2115,  0.3441,  0.3477,
         0.2488,  0.0965,  0.2728,  0.2518,  0.0060,  0.2243,  0.2334,  0.3636,
         0.3222, -0.1142,  0.4146,  0.2174,  0.2605,  0.1460,  0.4099,  0.0976,
         0.1393,  0.1520,  0.1573,  0.2041,  0.0477,  0.2513,  0.2984,  0.3297,
         0.1800,  0.1019,  0.2161,  0.3394,  0.1058,  0.1267,  0.1835,  0.1912,
         0.2620,  0.2662,  0.1728,  0.1680,  0.0161,  0.1360,  0.1687,  0.3042,
         0.1221,  0.2169,  0.2049,  0.2151])
true tensor([0.4034, 0.4327, 0.4677, 0.4385, 0.4232, 0.4034, 0.4327, 0.4677, 0.4604,
        0.4448, 0.4319, 0.4512, 0.4034, 0.4327, 0.4677, 0.4385, 0.4113, 0.4420,
        0.4604, 0.4448, 0.4420, 0.4113, 0.4420, 0.4604, 0.3553, 0.3898, 0.3842,
        0.4399, 0.4385, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.4319, 0.4512,
        0.4677, 0.4385, 0.4420, 0.4113, 0.4399, 0.4232, 0.4034, 0.4327, 0.4420,
        0.4113, 0.4420, 0.4604, 0.3898, 0.3842, 0.4399, 0.4232, 0.4399, 0.4232,
        0.4034, 0.4327, 0.3898, 0.3842, 0.4399, 0.4232, 0.4448, 0.4319, 0.4512,
        0.4641, 0.3842, 0.4399, 0.4232, 0.4034, 0.4113, 0.4420, 0.4604, 0.4448,
        0.4420, 0.4604, 0.4448, 0.4319, 0.4327, 0.4677, 0.4385, 0.4420, 0.4604,
        0.4448, 0.4319, 0.4512, 0.4420, 0.4113, 0.4420, 0.4604, 0.4319, 0.4512,
        0.4641, 0.4196, 0.4399, 0.4232, 0.4034, 0.4327, 0.4232, 0.4034, 0.4327,
        0.4677, 0.4385, 0.4420, 0.4113, 0.4420, 0.4420, 0.4604, 0.4448, 0.4319,
        0.3842, 0.4399, 0.4232, 0.4034, 0.4232, 0.4034, 0.4327, 0.4677, 0.4113,
        0.4420, 0.4604, 0.4448, 0.4034, 0.4327, 0.4677, 0.4385, 0.4448, 0.4319,
        0.4512, 0.4641, 0.4385, 0.4420, 0.4113, 0.4420, 0.4420, 0.4604, 0.4448,
        0.4319, 0.4327, 0.4677, 0.4385, 0.4420, 0.4677, 0.4385, 0.4420, 0.4113,
        0.3898, 0.3842, 0.4399, 0.4232, 0.3842, 0.4399, 0.4232, 0.4034, 0.4677,
        0.4385, 0.4420, 0.4113, 0.3553, 0.3898, 0.3842, 0.4399, 0.3553, 0.3898,
        0.3842, 0.4399, 0.4448, 0.4319, 0.4512, 0.4641, 0.4327, 0.4677, 0.4385,
        0.4420])
Epoch: 7, Steps: 1 | Train Loss: 0.0260851 Vali Loss: 0.0644261
lr = 0.0000206187
1it [00:00,  5.72it/s]
1it [00:00, 12.43it/s]
1it [00:00,  6.40it/s]
1it [00:00, 11.46it/s]
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 8 cost time: 0.5134377479553223
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.1067,  0.1359,  0.3982,  0.2521,  0.1358,  0.2889,  0.2790,  0.0617,
         0.2685,  0.1498,  0.2192,  0.2802,  0.2193,  0.2153,  0.2421,  0.0342,
         0.1991,  0.0773,  0.1138,  0.4892,  0.1072,  0.1211,  0.3515,  0.2329,
         0.0434,  0.2400,  0.2151,  0.3001,  0.1700,  0.2411,  0.3761,  0.2531,
         0.1604,  0.2124,  0.1220,  0.3619,  0.1701,  0.1160,  0.2659,  0.1960,
         0.2382,  0.1296,  0.1730,  0.1208,  0.1851,  0.2282,  0.2419,  0.3131,
         0.1330,  0.2254,  0.2917,  0.2489,  0.2793,  0.0753,  0.1832,  0.1606,
         0.1513,  0.0503,  0.2406,  0.1038,  0.0611,  0.3099,  0.1418,  0.2871,
         0.1950,  0.1307,  0.1910,  0.2119,  0.1292,  0.2861,  0.2190,  0.3092,
         0.1705,  0.1915,  0.1786,  0.4302, -0.0042,  0.2971,  0.2132,  0.2551,
         0.2281,  0.0821,  0.3288,  0.1087,  0.1382,  0.2303,  0.2478,  0.2420,
         0.2347,  0.0422,  0.2612,  0.0979,  0.1373,  0.0612,  0.2732,  0.2229,
         0.2497,  0.1351,  0.1322,  0.2421,  0.1859,  0.2035,  0.1010,  0.2979,
         0.0623,  0.3359,  0.3133,  0.3257,  0.0649,  0.2698,  0.2340,  0.2961,
         0.2221,  0.0584,  0.3599,  0.1721,  0.1612,  0.2256,  0.2624,  0.2215,
         0.1633,  0.1007,  0.3295,  0.0948,  0.2020,  0.0899,  0.2541,  0.2612,
         0.1246,  0.1066,  0.1856,  0.1472,  0.2223,  0.2455,  0.1694,  0.2515,
         0.1301,  0.2820,  0.1532,  0.2923,  0.1802,  0.2327,  0.0295,  0.2453,
         0.2441,  0.1243,  0.0772,  0.2236,  0.2884, -0.0013,  0.4096,  0.1952,
         0.1995,  0.2127,  0.2591,  0.0939,  0.0400,  0.3504,  0.2472,  0.2818,
         0.1626,  0.1137,  0.2164,  0.2518,  0.1100,  0.1619,  0.1330,  0.3850,
         0.2394,  0.1665,  0.1877,  0.2597])
true tensor([0.4034, 0.4327, 0.4677, 0.4385, 0.4319, 0.4512, 0.4641, 0.4196, 0.3553,
        0.3898, 0.3842, 0.4399, 0.4113, 0.4420, 0.4604, 0.4448, 0.4420, 0.4113,
        0.4420, 0.4604, 0.4399, 0.4232, 0.4034, 0.4327, 0.4034, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.4319, 0.4512, 0.4641,
        0.4327, 0.4677, 0.4385, 0.4420, 0.3842, 0.4399, 0.4232, 0.4034, 0.4604,
        0.4448, 0.4319, 0.4512, 0.4677, 0.4385, 0.4420, 0.4113, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4232, 0.4034, 0.4327, 0.4677, 0.4385, 0.4420, 0.4113,
        0.4420, 0.3842, 0.4399, 0.4232, 0.4034, 0.4420, 0.4604, 0.4448, 0.4319,
        0.4327, 0.4677, 0.4385, 0.4420, 0.3898, 0.3842, 0.4399, 0.4232, 0.3553,
        0.3898, 0.3842, 0.4399, 0.4448, 0.4319, 0.4512, 0.4641, 0.3898, 0.3842,
        0.4399, 0.4232, 0.4677, 0.4385, 0.4420, 0.4113, 0.4604, 0.4448, 0.4319,
        0.4512, 0.4232, 0.4034, 0.4327, 0.4677, 0.3842, 0.4399, 0.4232, 0.4034,
        0.4448, 0.4319, 0.4512, 0.4641, 0.4232, 0.4034, 0.4327, 0.4677, 0.4420,
        0.4604, 0.4448, 0.4319, 0.4385, 0.4420, 0.4113, 0.4420, 0.4113, 0.4420,
        0.4604, 0.4448, 0.4399, 0.4232, 0.4034, 0.4327, 0.4604, 0.4448, 0.4319,
        0.4512, 0.3553, 0.3898, 0.3842, 0.4399, 0.3898, 0.3842, 0.4399, 0.4232,
        0.4677, 0.4385, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.4319, 0.4420,
        0.4113, 0.4420, 0.4604, 0.4399, 0.4232, 0.4034, 0.4327, 0.4385, 0.4420,
        0.4113, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.4034, 0.4327, 0.4677,
        0.4385])
Epoch: 8, Steps: 1 | Train Loss: 0.0274027 Vali Loss: 0.0614114
lr = 0.0000095582
Validation loss decreased (0.063097 --> 0.061411).  Saving model ...
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 9 cost time: 0.5338966846466064
1it [00:00,  5.66it/s]
1it [00:00, 12.92it/s]
1it [00:00,  6.08it/s]
0it [00:00, ?it/s]
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.0027,  0.2088,  0.2259,  0.3244,  0.3049,  0.2117,  0.0447,  0.2026,
         0.2471,  0.1106,  0.3142,  0.1960,  0.1481,  0.1061,  0.2345,  0.1528,
         0.2288,  0.0359,  0.2302,  0.2691,  0.2094,  0.1647,  0.2430,  0.1249,
         0.1717,  0.1520,  0.1341,  0.3640,  0.1837,  0.0417,  0.2460,  0.2161,
         0.0985,  0.1805,  0.1223,  0.3435,  0.1489,  0.1753,  0.2295,  0.2084,
         0.1087, -0.0034,  0.3511,  0.2565,  0.1029,  0.2021,  0.2517,  0.2280,
         0.1991,  0.1365,  0.1946,  0.1356,  0.0735,  0.2739,  0.2288,  0.2636,
         0.1383,  0.2447,  0.3370,  0.2529,  0.1058,  0.1501,  0.2233,  0.2169,
         0.2894, -0.0100,  0.3744,  0.1425,  0.2499,  0.2517,  0.2116,  0.2512,
         0.2821,  0.1840,  0.2723,  0.2478,  0.1060,  0.1731,  0.1228,  0.1146,
         0.0721,  0.2116,  0.2280,  0.1484,  0.1820,  0.2080,  0.2392,  0.0786,
         0.1706,  0.2729,  0.1545,  0.2066,  0.1274,  0.2979,  0.2410,  0.2414,
         0.1712,  0.1186,  0.2770,  0.1855,  0.2125,  0.0486,  0.3069,  0.1685,
         0.1887,  0.0613,  0.1718,  0.1315,  0.1502,  0.2470,  0.2224,  0.0602,
         0.2344,  0.2778,  0.2121,  0.2869, -0.0110,  0.2063,  0.2025,  0.3656,
         0.2221,  0.2164,  0.1675,  0.1621,  0.1985,  0.1180,  0.4225,  0.1805,
         0.1894,  0.1393,  0.2880,  0.0856,  0.2286,  0.3152,  0.2360,  0.1039,
         0.0511,  0.2351,  0.1147,  0.2775, -0.0164,  0.2493,  0.1571,  0.2486,
         0.1255,  0.1694,  0.1574,  0.0100,  0.2555,  0.2787,  0.3326,  0.1606,
         0.0994,  0.2623,  0.2984,  0.3405,  0.2050,  0.2043,  0.1611,  0.1121,
         0.1853,  0.1672,  0.2219,  0.2360,  0.0684,  0.2558,  0.2498,  0.2939,
         0.2212,  0.1077,  0.3321,  0.1922])
true tensor([0.4420, 0.4113, 0.4420, 0.4604, 0.3842, 0.4399, 0.4232, 0.4034, 0.3898,
        0.3842, 0.4399, 0.4232, 0.4232, 0.4034, 0.4327, 0.4677, 0.4448, 0.4319,
        0.4512, 0.4641, 0.3898, 0.3842, 0.4399, 0.4232, 0.3842, 0.4399, 0.4232,
        0.4034, 0.4420, 0.4604, 0.4448, 0.4319, 0.4113, 0.4420, 0.4604, 0.4448,
        0.4604, 0.4448, 0.4319, 0.4512, 0.4034, 0.4327, 0.4677, 0.4385, 0.4232,
        0.4034, 0.4327, 0.4677, 0.3553, 0.3898, 0.3842, 0.4399, 0.4448, 0.4319,
        0.4512, 0.4641, 0.4385, 0.4420, 0.4113, 0.4420, 0.3553, 0.3898, 0.3842,
        0.4399, 0.4385, 0.4420, 0.4113, 0.4420, 0.4034, 0.4327, 0.4677, 0.4385,
        0.4232, 0.4034, 0.4327, 0.4677, 0.4677, 0.4385, 0.4420, 0.4113, 0.3898,
        0.3842, 0.4399, 0.4232, 0.4604, 0.4448, 0.4319, 0.4512, 0.4113, 0.4420,
        0.4604, 0.4448, 0.4327, 0.4677, 0.4385, 0.4420, 0.3842, 0.4399, 0.4232,
        0.4034, 0.4420, 0.4113, 0.4420, 0.4604, 0.4399, 0.4232, 0.4034, 0.4327,
        0.4420, 0.4113, 0.4420, 0.4604, 0.4399, 0.4232, 0.4034, 0.4327, 0.4034,
        0.4327, 0.4677, 0.4385, 0.4677, 0.4385, 0.4420, 0.4113, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4420, 0.4604, 0.4448, 0.4319, 0.4385, 0.4420, 0.4113,
        0.4420, 0.4604, 0.4448, 0.4319, 0.4512, 0.4420, 0.4604, 0.4448, 0.4319,
        0.4319, 0.4512, 0.4641, 0.4196, 0.4327, 0.4677, 0.4385, 0.4420, 0.4677,
        0.4385, 0.4420, 0.4113, 0.4399, 0.4232, 0.4034, 0.4327, 0.4113, 0.4420,
        0.4604, 0.4448, 0.3553, 0.3898, 0.3842, 0.4399, 0.4448, 0.4319, 0.4512,
        0.4641])
Epoch: 9, Steps: 1 | Train Loss: 0.0253060 Vali Loss: 0.0637897
lr = 0.0000024569
EarlyStopping counter: 1 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
Epoch: 10 cost time: 0.509453296661377
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2415,  0.2223,  0.2955,  0.0821,  0.2010,  0.2874,  0.2260,  0.1991,
         0.2321,  0.3127,  0.1647,  0.0630,  0.1925,  0.0824,  0.2747,  0.1687,
         0.1360,  0.3115,  0.1607,  0.0697,  0.1523,  0.2836,  0.1733,  0.2457,
         0.2341,  0.2365,  0.1669,  0.1921, -0.0117,  0.1641,  0.2590,  0.3294,
         0.0757,  0.2584,  0.2974,  0.2960,  0.1498,  0.2147,  0.1488,  0.3715,
         0.3655,  0.1672,  0.1245,  0.1948,  0.0926,  0.2386,  0.2303,  0.1329,
         0.1492,  0.0469,  0.2626,  0.0631,  0.1422,  0.1093,  0.1802,  0.2303,
         0.0390,  0.3066,  0.3805, -0.0662,  0.1587,  0.2171,  0.1935,  0.2294,
         0.0198,  0.2513,  0.2672,  0.2680,  0.1513,  0.1428,  0.2737,  0.2474,
         0.1740,  0.2526,  0.2151,  0.2957,  0.2193,  0.0687,  0.2840,  0.1345,
         0.2489,  0.2554,  0.1231,  0.2160,  0.1400,  0.1484,  0.3431,  0.2340,
         0.1447,  0.0411,  0.1918,  0.2733,  0.2179,  0.1287,  0.2319,  0.0371,
         0.0738,  0.2085,  0.2420,  0.4000,  0.1305,  0.1347,  0.2395,  0.2274,
         0.0774,  0.1984,  0.1641,  0.3819,  0.1865,  0.2308,  0.1699,  0.1965,
        -0.0186,  0.3151,  0.0742,  0.2652,  0.1004,  0.0046,  0.4219,  0.2232,
         0.2513,  0.1633,  0.2115,  0.3016,  0.2796,  0.2089,  0.1549,  0.1421,
         0.1734,  0.2251,  0.1524,  0.2448,  0.1859,  0.1570,  0.2645,  0.2223,
         0.1744,  0.0806,  0.2421,  0.2531,  0.0823,  0.2047,  0.2221,  0.1115,
         0.2694,  0.1535,  0.1693,  0.1057,  0.1783,  0.1871,  0.1876,  0.1802,
         0.1400,  0.0704,  0.1034,  0.2778,  0.0143,  0.2671,  0.2759,  0.1981,
         0.1738,  0.2406,  0.2094,  0.2760,  0.2236,  0.0748,  0.1580,  0.2841,
         0.2709,  0.1339,  0.0732,  0.3035])
true tensor([0.4385, 0.4420, 0.4113, 0.4420, 0.3553, 0.3898, 0.3842, 0.4399, 0.3842,
        0.4399, 0.4232, 0.4034, 0.4448, 0.4319, 0.4512, 0.4641, 0.4113, 0.4420,
        0.4604, 0.4448, 0.4399, 0.4232, 0.4034, 0.4327, 0.4604, 0.4448, 0.4319,
        0.4512, 0.4677, 0.4385, 0.4420, 0.4113, 0.3842, 0.4399, 0.4232, 0.4034,
        0.4113, 0.4420, 0.4604, 0.4448, 0.4034, 0.4327, 0.4677, 0.4385, 0.4034,
        0.4327, 0.4677, 0.4385, 0.3898, 0.3842, 0.4399, 0.4232, 0.4327, 0.4677,
        0.4385, 0.4420, 0.4327, 0.4677, 0.4385, 0.4420, 0.3898, 0.3842, 0.4399,
        0.4232, 0.4385, 0.4420, 0.4113, 0.4420, 0.4420, 0.4113, 0.4420, 0.4604,
        0.4232, 0.4034, 0.4327, 0.4677, 0.3842, 0.4399, 0.4232, 0.4034, 0.4420,
        0.4604, 0.4448, 0.4319, 0.4034, 0.4327, 0.4677, 0.4385, 0.4232, 0.4034,
        0.4327, 0.4677, 0.4399, 0.4232, 0.4034, 0.4327, 0.4604, 0.4448, 0.4319,
        0.4512, 0.4677, 0.4385, 0.4420, 0.4113, 0.4420, 0.4113, 0.4420, 0.4604,
        0.4420, 0.4113, 0.4420, 0.4604, 0.4113, 0.4420, 0.4604, 0.4448, 0.4420,
        0.4604, 0.4448, 0.4319, 0.4448, 0.4319, 0.4512, 0.4641, 0.4677, 0.4385,
        0.4420, 0.4113, 0.4385, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.4319,
        0.4512, 0.4319, 0.4512, 0.4641, 0.4196, 0.4232, 0.4034, 0.4327, 0.4677,
        0.3553, 0.3898, 0.3842, 0.4399, 0.3553, 0.3898, 0.3842, 0.4399, 0.3898,
        0.3842, 0.4399, 0.4232, 0.4420, 0.4604, 0.4448, 0.4319, 0.4399, 0.4232,
        0.4034, 0.4327, 0.4448, 0.4319, 0.4512, 0.4641, 0.4327, 0.4677, 0.4385,
        0.4420])
Epoch: 10, Steps: 1 | Train Loss: 0.0258236 Vali Loss: 0.0649073
lr = 0.0000000100
EarlyStopping counter: 2 out of 3
outputs torch.Size([337, 12, 18])
B 337
L 18
M 18
1it [00:00, 13.17it/s]
1it [00:00,  6.21it/s]
1it [00:00, 11.46it/s]
1it [00:00, 10.75it/s]
outputs torch.Size([43, 12, 18])
B 43
L 18
M 18
total vali observation: torch.Size([172])
missing_idx_len: 43
pred tensor([ 0.2733,  0.1934,  0.1786,  0.0982,  0.1008,  0.1299,  0.1955,  0.1538,
         0.3329,  0.1162,  0.2618,  0.2420,  0.1330,  0.1755,  0.2564,  0.3165,
         0.1581,  0.1756,  0.2518,  0.3299,  0.1596,  0.1702,  0.0436,  0.3829,
         0.0720,  0.1417,  0.2366,  0.2019,  0.1153,  0.1671,  0.3064,  0.2664,
         0.2554,  0.2182,  0.1550,  0.1981,  0.3083,  0.0685,  0.2052,  0.1585,
         0.0950,  0.1804,  0.2520,  0.1665,  0.1001,  0.2925,  0.1271,  0.3112,
        -0.1056,  0.2309,  0.1566,  0.2292, -0.0083,  0.1628,  0.1626,  0.2965,
         0.3366,  0.1739,  0.1572,  0.0639,  0.2571,  0.3000,  0.2189,  0.3189,
         0.0995,  0.2162,  0.3138,  0.2518,  0.2161,  0.1773,  0.1894,  0.3597,
         0.2036,  0.2188,  0.1824,  0.2778,  0.1989,  0.2351,  0.1501,  0.1477,
         0.1095,  0.1453,  0.2044,  0.2423,  0.2567, -0.0034,  0.3164,  0.2724,
         0.1497,  0.2261,  0.2954,  0.3305,  0.0860,  0.2791,  0.1484,  0.3500,
         0.1617,  0.0969,  0.3824,  0.1904,  0.2300,  0.2277,  0.2039,  0.1682,
         0.1683,  0.0974,  0.2430,  0.2749,  0.1700,  0.0338,  0.2208,  0.1528,
         0.0987,  0.2077,  0.2544,  0.2698,  0.3254,  0.1249,  0.2790,  0.0805,
         0.2514, -0.0421,  0.2069,  0.1450,  0.2871,  0.1334,  0.3229,  0.1201,
         0.1808,  0.0043,  0.3467,  0.1549,  0.1249,  0.2679,  0.2098,  0.2253,
         0.2308,  0.0643,  0.3341,  0.1664,  0.1503,  0.3535,  0.2313,  0.1801,
         0.2778,  0.0797,  0.1871,  0.1495,  0.0983,  0.0878,  0.1338,  0.1458,
         0.1055,  0.0876,  0.2502,  0.1424,  0.0041,  0.3840,  0.2144,  0.2421,
         0.2130,  0.2037,  0.2136,  0.2358,  0.1015,  0.1917,  0.1747,  0.1010,
         0.1121,  0.2365,  0.1987,  0.3203])
true tensor([0.3553, 0.3898, 0.3842, 0.4399, 0.4420, 0.4604, 0.4448, 0.4319, 0.4420,
        0.4604, 0.4448, 0.4319, 0.4677, 0.4385, 0.4420, 0.4113, 0.4399, 0.4232,
        0.4034, 0.4327, 0.4232, 0.4034, 0.4327, 0.4677, 0.4327, 0.4677, 0.4385,
        0.4420, 0.4677, 0.4385, 0.4420, 0.4113, 0.4420, 0.4113, 0.4420, 0.4604,
        0.4034, 0.4327, 0.4677, 0.4385, 0.3898, 0.3842, 0.4399, 0.4232, 0.4034,
        0.4327, 0.4677, 0.4385, 0.4327, 0.4677, 0.4385, 0.4420, 0.4420, 0.4113,
        0.4420, 0.4604, 0.4399, 0.4232, 0.4034, 0.4327, 0.4385, 0.4420, 0.4113,
        0.4420, 0.4604, 0.4448, 0.4319, 0.4512, 0.3842, 0.4399, 0.4232, 0.4034,
        0.4232, 0.4034, 0.4327, 0.4677, 0.4604, 0.4448, 0.4319, 0.4512, 0.4448,
        0.4319, 0.4512, 0.4641, 0.4113, 0.4420, 0.4604, 0.4448, 0.4420, 0.4604,
        0.4448, 0.4319, 0.3898, 0.3842, 0.4399, 0.4232, 0.4034, 0.4327, 0.4677,
        0.4385, 0.4677, 0.4385, 0.4420, 0.4113, 0.4399, 0.4232, 0.4034, 0.4327,
        0.4385, 0.4420, 0.4113, 0.4420, 0.4113, 0.4420, 0.4604, 0.4448, 0.4448,
        0.4319, 0.4512, 0.4641, 0.4113, 0.4420, 0.4604, 0.4448, 0.3842, 0.4399,
        0.4232, 0.4034, 0.4232, 0.4034, 0.4327, 0.4677, 0.4385, 0.4420, 0.4113,
        0.4420, 0.4420, 0.4113, 0.4420, 0.4604, 0.4319, 0.4512, 0.4641, 0.4196,
        0.3553, 0.3898, 0.3842, 0.4399, 0.4604, 0.4448, 0.4319, 0.4512, 0.3842,
        0.4399, 0.4232, 0.4034, 0.4448, 0.4319, 0.4512, 0.4641, 0.4327, 0.4677,
        0.4385, 0.4420, 0.3898, 0.3842, 0.4399, 0.4232, 0.3553, 0.3898, 0.3842,
        0.4399])
Epoch: 11, Steps: 1 | Train Loss: 0.0251562 Vali Loss: 0.0645027
lr = 0.0000024569
EarlyStopping counter: 3 out of 3
Early stopping
------------------------------------
outputs torch.Size([93, 12, 18])
B 93
L 18
M 18
test shape: (1, 372) (1, 372)
test shape: (1, 1, 372) (1, 1, 372)
mae:0.5357, mse:0.3478, rmse:0.5897, r2:-5.3216
mse_mean = 0.3478, mse_std = 0.0000
r2_mean = -5.3216, mae_std = 0.0000