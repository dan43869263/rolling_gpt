['date', 'atq_1', 'atq_2', 'atq_3', 'ni_1', 'ni_2', 'ni_3', 'dv_1', 'dv_2', 'dv_3', 'acc_1', 'acc_2', 'acc_3', 'invest_1', 'invest_2', 'invest_3', 'mc_1', 'mc_2', 'mc_3', 'bm_1', 'bm_2', 'bm_3', 'dinvt_1', 'dinvt_2', 'dinvt_3', 'dar_1', 'dar_2', 'dar_3', 'capx_1', 'capx_2', 'capx_3', 'gm_1', 'gm_2', 'gm_3', 'sga_1', 'sga_2', 'sga_3', 'prc_1', 'prc_2', 'prc_3', 'ret_1', 'ret_2', 'ret_3', 'vol_1', 'vol_2', 'vol_3', 'shrout_1', 'shrout_2', 'shrout_3', 'medest_1', 'medest_2', 'medest_3', 'meanest_1', 'meanest_2', 'meanest_3', 'value']
train 103
['date', 'atq_1', 'atq_2', 'atq_3', 'ni_1', 'ni_2', 'ni_3', 'dv_1', 'dv_2', 'dv_3', 'acc_1', 'acc_2', 'acc_3', 'invest_1', 'invest_2', 'invest_3', 'mc_1', 'mc_2', 'mc_3', 'bm_1', 'bm_2', 'bm_3', 'dinvt_1', 'dinvt_2', 'dinvt_3', 'dar_1', 'dar_2', 'dar_3', 'capx_1', 'capx_2', 'capx_3', 'gm_1', 'gm_2', 'gm_3', 'sga_1', 'sga_2', 'sga_3', 'prc_1', 'prc_2', 'prc_3', 'ret_1', 'ret_2', 'ret_3', 'vol_1', 'vol_2', 'vol_3', 'shrout_1', 'shrout_2', 'shrout_3', 'medest_1', 'medest_2', 'medest_3', 'meanest_1', 'meanest_2', 'meanest_3', 'value']
val 19
['date', 'atq_1', 'atq_2', 'atq_3', 'ni_1', 'ni_2', 'ni_3', 'dv_1', 'dv_2', 'dv_3', 'acc_1', 'acc_2', 'acc_3', 'invest_1', 'invest_2', 'invest_3', 'mc_1', 'mc_2', 'mc_3', 'bm_1', 'bm_2', 'bm_3', 'dinvt_1', 'dinvt_2', 'dinvt_3', 'dar_1', 'dar_2', 'dar_3', 'capx_1', 'capx_2', 'capx_3', 'gm_1', 'gm_2', 'gm_3', 'sga_1', 'sga_2', 'sga_3', 'prc_1', 'prc_2', 'prc_3', 'ret_1', 'ret_2', 'ret_3', 'vol_1', 'vol_2', 'vol_3', 'shrout_1', 'shrout_2', 'shrout_3', 'medest_1', 'medest_2', 'medest_3', 'meanest_1', 'meanest_2', 'meanest_3', 'value']
test 34
gpt2 = GPT2Model(
  (wte): Embedding(50257, 768)
  (wpe): Embedding(1024, 768)
  (drop): Dropout(p=0.1, inplace=False)
  (h): ModuleList(
    (0): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (1): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (2): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (3): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (4): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
    (5): GPT2Block(
      (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): GPT2Attention(
        (c_attn): Conv1D()
        (c_proj): Conv1D()
        (attn_dropout): Dropout(p=0.1, inplace=False)
        (resid_dropout): Dropout(p=0.1, inplace=False)
      )
      (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): GPT2MLP(
        (c_fc): Conv1D()
        (c_proj): Conv1D()
        (act): NewGELUActivation()
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
)
1it [00:03,  3.19s/it]
1it [00:00,  7.71it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 1 cost time: 3.595705270767212
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.2131,  0.0319,  0.1452,  0.0645])
true tensor([0.2800, 0.3000, 0.2900, 0.3100])
Epoch: 1, Steps: 1 | Train Loss: 0.2850672 Vali Loss: 0.0990707
lr = 0.0000975531
Validation loss decreased (inf --> 0.099071).  Saving model ...
1it [00:00,  3.61it/s]
0it [00:00, ?it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 2 cost time: 0.7676215171813965
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([0.0821, 0.0707, 0.0663, 0.2209])
true tensor([0.2800, 0.3000, 0.2900, 0.3100])
Epoch: 2, Steps: 1 | Train Loss: 0.2907208 Vali Loss: 0.0374332
lr = 0.0000904518
1it [00:00,  7.25it/s]
1it [00:00,  3.79it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 3 cost time: 0.7356932163238525
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0895,  0.0811, -0.0324,  0.2856])
true tensor([0.2900, 0.3000, 0.3100, 0.2800])
Epoch: 3, Steps: 1 | Train Loss: 0.2823423 Vali Loss: 0.0773001
lr = 0.0000793913
EarlyStopping counter: 1 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
1it [00:00,  7.25it/s]
1it [00:00,  3.91it/s]
1it [00:00,  7.32it/s]
Epoch: 4 cost time: 0.7682576179504395
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0457,  0.0399,  0.1281, -0.0707])
true tensor([0.3000, 0.2900, 0.3100, 0.2800])
Epoch: 4, Steps: 1 | Train Loss: 0.2889086 Vali Loss: 0.0708130
lr = 0.0000654543
EarlyStopping counter: 2 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 5 cost time: 0.7396090030670166
1it [00:00,  3.90it/s]
1it [00:00,  7.71it/s]
1it [00:00,  3.82it/s]
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0588, -0.0018, -0.2221,  0.0631])
true tensor([0.2800, 0.2900, 0.3100, 0.3000])
Epoch: 5, Steps: 1 | Train Loss: 0.2556830 Vali Loss: 0.1347845
lr = 0.0000500050
EarlyStopping counter: 3 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 6 cost time: 0.8224859237670898
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0359, -0.0163, -0.0012, -0.0483])
true tensor([0.3100, 0.2900, 0.2800, 0.3000])
Epoch: 6, Steps: 1 | Train Loss: 0.2720986 Vali Loss: 0.1034614
lr = 0.0000345557
EarlyStopping counter: 4 out of 30
1it [00:00,  7.74it/s]
1it [00:00,  3.88it/s]
1it [00:00,  7.46it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 7 cost time: 0.7355408668518066
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.2087,  0.1543,  0.1077, -0.0171])
true tensor([0.2900, 0.3000, 0.3100, 0.2800])
Epoch: 7, Steps: 1 | Train Loss: 0.2843131 Vali Loss: 0.0392572
lr = 0.0000206187
EarlyStopping counter: 5 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 8 cost time: 0.7967357635498047
1it [00:00,  3.60it/s]
1it [00:00,  7.05it/s]
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([0.0643, 0.0383, 0.0515, 0.0418])
true tensor([0.2900, 0.3000, 0.3100, 0.2800])
Epoch: 8, Steps: 1 | Train Loss: 0.2679650 Vali Loss: 0.0607506
lr = 0.0000095582
EarlyStopping counter: 6 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 9 cost time: 0.7219791412353516
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.1574,  0.2792,  0.1549, -0.1177])
true tensor([0.2800, 0.3000, 0.2900, 0.3100])
Epoch: 9, Steps: 1 | Train Loss: 0.2833805 Vali Loss: 0.0541617
lr = 0.0000024569
EarlyStopping counter: 7 out of 30
1it [00:00,  3.79it/s]
1it [00:00,  8.53it/s]
1it [00:00,  3.76it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 10 cost time: 0.7338354587554932
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0203,  0.0874,  0.1390,  0.1856])
true tensor([0.2800, 0.3100, 0.2900, 0.3000])
Epoch: 10, Steps: 1 | Train Loss: 0.2786485 Vali Loss: 0.0438939
lr = 0.0000000100
EarlyStopping counter: 8 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 11 cost time: 0.7480900287628174
1it [00:00,  7.61it/s]
1it [00:00,  3.73it/s]
1it [00:00,  8.26it/s]
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0138,  0.0402, -0.1385,  0.1557])
true tensor([0.3000, 0.3100, 0.2800, 0.2900])
Epoch: 11, Steps: 1 | Train Loss: 0.2943734 Vali Loss: 0.0869664
lr = 0.0000024569
EarlyStopping counter: 9 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 12 cost time: 0.7686667442321777
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.1250, -0.2019,  0.2853,  0.1308])
true tensor([0.2800, 0.3100, 0.2900, 0.3000])
Epoch: 12, Steps: 1 | Train Loss: 0.2892445 Vali Loss: 0.0786621
lr = 0.0000095582
EarlyStopping counter: 10 out of 30
1it [00:00,  3.52it/s]
1it [00:00,  6.91it/s]
1it [00:00,  3.68it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 13 cost time: 0.7801718711853027
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0440,  0.0004,  0.0261, -0.0135])
true tensor([0.2800, 0.3000, 0.2900, 0.3100])
Epoch: 13, Steps: 1 | Train Loss: 0.2943504 Vali Loss: 0.0799387
lr = 0.0000206187
EarlyStopping counter: 11 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 14 cost time: 0.8221619129180908
1it [00:00,  7.82it/s]
1it [00:00,  3.88it/s]
1it [00:00,  6.35it/s]
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0567,  0.0398,  0.1201, -0.0536])
true tensor([0.3100, 0.3000, 0.2800, 0.2900])
Epoch: 14, Steps: 1 | Train Loss: 0.2655956 Vali Loss: 0.0688739
lr = 0.0000345557
EarlyStopping counter: 12 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 15 cost time: 0.7587344646453857
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0792,  0.0027, -0.0382, -0.0707])
true tensor([0.2800, 0.3000, 0.2900, 0.3100])
Epoch: 15, Steps: 1 | Train Loss: 0.2815135 Vali Loss: 0.0953420
lr = 0.0000500050
EarlyStopping counter: 13 out of 30
1it [00:00,  3.81it/s]
1it [00:00,  8.42it/s]
1it [00:00,  5.38it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 16 cost time: 0.7537596225738525
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.1560,  0.0269,  0.1833,  0.1373])
true tensor([0.3100, 0.2900, 0.3000, 0.2800])
Epoch: 16, Steps: 1 | Train Loss: 0.2857221 Vali Loss: 0.0800962
lr = 0.0000654543
EarlyStopping counter: 14 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
1it [00:00,  3.85it/s]
1it [00:00,  6.77it/s]
1it [00:00,  3.72it/s]
0it [00:00, ?it/s]
Epoch: 17 cost time: 0.779421329498291
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0139,  0.0129, -0.1449,  0.0406])
true tensor([0.2900, 0.3000, 0.2800, 0.3100])
Epoch: 17, Steps: 1 | Train Loss: 0.2671132 Vali Loss: 0.1029460
lr = 0.0000793913
EarlyStopping counter: 15 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
1it [00:00,  6.91it/s]
1it [00:00,  3.77it/s]
1it [00:00,  7.17it/s]
0it [00:00, ?it/s]
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.1442, -0.0834, -0.1830,  0.0577])
true tensor([0.2900, 0.3000, 0.3100, 0.2800])
Epoch: 18, Steps: 1 | Train Loss: 0.2666160 Vali Loss: 0.1151605
lr = 0.0000904518
EarlyStopping counter: 16 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 19 cost time: 0.7423124313354492
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0220,  0.1619,  0.0526,  0.1330])
true tensor([0.2900, 0.3000, 0.2800, 0.3100])
Epoch: 19, Steps: 1 | Train Loss: 0.2840034 Vali Loss: 0.0498568
lr = 0.0000975531
1it [00:00,  3.91it/s]
1it [00:00,  7.64it/s]
1it [00:00,  3.79it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 20 cost time: 0.794116735458374
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.2508,  0.1863, -0.0313, -0.0068])
true tensor([0.3100, 0.2800, 0.3000, 0.2900])
Epoch: 20, Steps: 1 | Train Loss: 0.2744841 Vali Loss: 0.1302625
lr = 0.0001000000
EarlyStopping counter: 18 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 21 cost time: 0.7389581203460693
1it [00:00,  7.22it/s]
1it [00:00,  3.95it/s]
1it [00:00,  8.21it/s]
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0408,  0.0810,  0.0043, -0.0688])
true tensor([0.3100, 0.3000, 0.2900, 0.2800])
Epoch: 21, Steps: 1 | Train Loss: 0.2758411 Vali Loss: 0.0809352
lr = 0.0000975531
EarlyStopping counter: 19 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 22 cost time: 0.7552299499511719
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0526,  0.0898, -0.0689,  0.0563])
true tensor([0.2800, 0.2900, 0.3100, 0.3000])
Epoch: 22, Steps: 1 | Train Loss: 0.2740411 Vali Loss: 0.0737011
lr = 0.0000904518
EarlyStopping counter: 20 out of 30
1it [00:00,  3.90it/s]
1it [00:00,  7.61it/s]
1it [00:00,  3.58it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 23 cost time: 0.7773854732513428
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0598,  0.0187, -0.1410, -0.1051])
true tensor([0.2800, 0.3000, 0.3100, 0.2900])
Epoch: 23, Steps: 1 | Train Loss: 0.2795618 Vali Loss: 0.1385305
lr = 0.0000793913
EarlyStopping counter: 21 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 24 cost time: 0.7580287456512451
1it [00:00,  5.95it/s]
1it [00:00,  3.58it/s]
1it [00:00,  6.75it/s]
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.1345, -0.2074, -0.0199, -0.2245])
true tensor([0.3000, 0.2800, 0.2900, 0.3100])
Epoch: 24, Steps: 1 | Train Loss: 0.2793778 Vali Loss: 0.1616710
lr = 0.0000654543
EarlyStopping counter: 22 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 25 cost time: 0.7699480056762695
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.1136,  0.0716, -0.0530,  0.0215])
true tensor([0.2800, 0.2900, 0.3100, 0.3000])
Epoch: 25, Steps: 1 | Train Loss: 0.2797452 Vali Loss: 0.1029720
lr = 0.0000500050
EarlyStopping counter: 23 out of 30
1it [00:00,  3.62it/s]
1it [00:00,  8.04it/s]
0it [00:00, ?it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 26 cost time: 0.7906882762908936
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0480,  0.0044,  0.0250, -0.2106])
true tensor([0.2800, 0.3000, 0.3100, 0.2900])
Epoch: 26, Steps: 1 | Train Loss: 0.2711241 Vali Loss: 0.1316861
lr = 0.0000345557
EarlyStopping counter: 24 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
1it [00:00,  3.77it/s]
1it [00:00,  7.36it/s]
1it [00:00,  3.61it/s]
Epoch: 27 cost time: 0.7886450290679932
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0553, -0.0058, -0.0743, -0.0630])
true tensor([0.3100, 0.2800, 0.3000, 0.2900])
Epoch: 27, Steps: 1 | Train Loss: 0.2774809 Vali Loss: 0.1028122
lr = 0.0000206187
EarlyStopping counter: 25 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 28 cost time: 0.7435274124145508
1it [00:00,  7.22it/s]
1it [00:00,  3.88it/s]
1it [00:00,  6.62it/s]
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0121, -0.0430,  0.0679, -0.0181])
true tensor([0.3000, 0.2800, 0.2900, 0.3100])
Epoch: 28, Steps: 1 | Train Loss: 0.2908244 Vali Loss: 0.0896848
lr = 0.0000095582
EarlyStopping counter: 26 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 29 cost time: 0.7614364624023438
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([ 0.0474,  0.0325, -0.1088, -0.0223])
true tensor([0.2900, 0.3000, 0.3100, 0.2800])
Epoch: 29, Steps: 1 | Train Loss: 0.2767704 Vali Loss: 0.0992941
lr = 0.0000024569
EarlyStopping counter: 27 out of 30
1it [00:00,  3.88it/s]
1it [00:00,  7.02it/s]
1it [00:00,  3.81it/s]
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 30 cost time: 0.7725608348846436
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0013,  0.0347, -0.0499, -0.0919])
true tensor([0.2800, 0.3000, 0.3100, 0.2900])
Epoch: 30, Steps: 1 | Train Loss: 0.2620735 Vali Loss: 0.1062200
lr = 0.0000000100
EarlyStopping counter: 28 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 31 cost time: 0.7737853527069092
1it [00:00,  7.95it/s]
1it [00:00,  3.77it/s]
1it [00:00,  7.18it/s]
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.0482,  0.1196, -0.0716, -0.0704])
true tensor([0.2900, 0.3100, 0.2800, 0.3000])
Epoch: 31, Steps: 1 | Train Loss: 0.2783664 Vali Loss: 0.1028659
lr = 0.0000024569
EarlyStopping counter: 29 out of 30
outputs torch.Size([103, 1, 54])
B 103
L 18
M 54
Epoch: 32 cost time: 0.7863390445709229
outputs torch.Size([19, 1, 54])
B 19
L 18
M 54
total vali observation: torch.Size([4])
missing_idx_len: 19
pred tensor([-0.1570, -0.0518, -0.0751,  0.0594])
true tensor([0.3100, 0.3000, 0.2900, 0.2800])
Epoch: 32, Steps: 1 | Train Loss: 0.2735915 Vali Loss: 0.1309544
lr = 0.0000095582
EarlyStopping counter: 30 out of 30
Early stopping
1it [00:00,  3.74it/s]
1it [00:00,  7.55it/s]
------------------------------------
outputs torch.Size([34, 1, 54])
B 34
L 18
M 54
test shape: (1, 0) (1, 0)
1it [00:00,  6.28it/s]
Traceback (most recent call last):
  File "/home/dan/NeurIPS2023-One-Fits-All/Long-term_Forecasting/main.py", line 235, in <module>
    mse, r2 = test(model, test_data, test_loader, args, device, ii)
  File "/home/dan/NeurIPS2023-One-Fits-All/Long-term_Forecasting/utils/tools.py", line 334, in test
    preds = preds.reshape(-1, preds.shape[-2], preds.shape[-1])
ValueError: cannot reshape array of size 0 into shape (1,0)